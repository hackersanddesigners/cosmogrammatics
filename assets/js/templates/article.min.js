(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
const LocalStore = require('./local.store')

// -- comment-review
//    display unpublished comments
//    saved in localStorage,
//    allow to remove unwanted ones,
//    edit them, and then selectively
//    publish them all in one go

function commentReviewList(article_slug) {

  // -- init, view reset
  const comment_data = document.querySelector('.comment-data')

  // remove every node inside comment-data
  Array.from(comment_data.childNodes).map(item => {
    item.remove()
  })
 
  // -- populate comment-data w/ unpublished comments from local-storage
  const comment_store = new LocalStore(`comment-${article_slug}`)
  let comments = comment_store.getAll() 

  // remove published comments from list
  // we display in comment-review only draft comments 
  comments = comments.filter(comment => comment.status === 'draft')

  comments.map((comment, idx) => {
    const el = make_comment_el(comment, idx, article_slug)
    comment_data.append(el)
  })

  // -- setup comment status and username
  if (comments.length ) {
    const comment_status = document.querySelector('.comment-status')
    comment_status.innerHTML = 'Your unpublished comments:'
  }

  // -- save username into a different, own store
  //    so we can more easily fetch it and pre-add it
  //    to any other comment done afterwards
  let user_name = ''
  if (comments.length > 0) {
    user_name = comments[0].content.user
  }

  const username = setUsername(user_name, article_slug)

  // -- set username to comment-list-status area
  const username_edit = document.querySelector('.comment-username-wrapper')
  const username_input = username_edit.querySelector('input')
  username_input.value = username.value

  // set input text width to specific username length
  username_input.style.width = `${username_input.value.length +1}ch`

  const user_store = new LocalStore('user')
  const username_edit_btn = document.querySelector('.comment-username-edit-btn')

  username_edit_btn.addEventListener('click', (e) => {
    const target = e.target
    
    if (target.textContent === 'save') {
      // save input text
      username.value = username_input.value
      user_store.save(username)

      // reset styles
      target.textContent = 'edit'

      username_input.setAttribute('readonly', 'readonly')
      username_input.style.width = `${username_input.value.length +1}ch`
      username_input.style.borderColor = 'transparent'

      document.querySelector('body').focus()

    } else if (target.textContent === 'edit') {
      // toggle styles

      target.textContent = 'save'

      moveCaretToEnd(username_input)
      
      username_input.removeAttribute('readonly')
      username_input.style.width = 'auto'
      username_input.style.borderColor = 'black'

      username_input.focus()
    }

  })

  // -- publish, edit and remove selected comments
  const publish_btn = document.querySelector('.post_comment')
  const edit_btn = document.querySelector('.comment-edit')
  const remove_btn = document.querySelector('.comment-remove')

  if (comments.length > 0) {
    const inputs = Array.from(document.querySelectorAll('.comment-list-input'))

    // -- publish selected comments
    publish_btn.classList.remove('hidden')

    publish_btn.addEventListener('click', (e) => {

      inputs.map(input => {
        
        if (input.checked) {
          const highlight_id = input.parentNode.id
          const comment = comments.find(comment => {
            if (comment.content.selection_text !== undefined) {
              if (comment.content.selection_text.id === highlight_id) {
                return comment
              }
            } else {
              if (comment.content.block_id === highlight_id) {
                return comment
              }
            }
          })

          comment['status'] = 'published'
          input.value = JSON.stringify(comment)

          // remove selected input-checked items from comments store
          comment_store.remove(highlight_id)

        } else {
          input.value = ''

        }

      })

    })

    // -- edit selected comments
    edit_btn.classList.remove('hidden')

    edit_btn.addEventListener('click', (e) => {
      e.preventDefault()

      const target = e.target
      const operation = target.textContent

      const isInputSelected = inputs.find(input => input.checked)
      if (isInputSelected) {
        if (target.textContent === 'save') {
          target.textContent = 'edit'
        } else if (target.textContent === 'edit') {
          target.textContent = 'save'
        }
      }

      inputs.map((input, idx) => {
        
        if (input.checked) {

          const highlight_id = input.parentNode.id
          const comment = comments.find(comment => {
            if (comment.content.selection_text !== undefined) {
              if (comment.content.selection_text.id === highlight_id) {
                return comment
              }
            } else {
              if (comment.content.block_id === highlight_id) {
                return comment
              }
            }
          })

          const comment_input_text = input.parentNode.querySelector('.comment-label-wrapper > input')

          if (operation === 'save') {

            // save input text
            comment.content.text = comment_input_text.value
            comment_store.save(comment)

            comment_input_text.setAttribute('readonly', 'readonly')
            // comment_input_text.style.width = `${comment_input_text.value.length +1}ch`
            comment_input_text.style.borderColor = 'transparent'

            document.querySelector('body').focus()

          } else if (operation === 'edit') {

            moveCaretToEnd(comment_input_text)
            
            comment_input_text.removeAttribute('readonly')
            comment_input_text.style.width = 'auto'
            comment_input_text.style.borderColor = 'black'

          }

        }

      })

    })
 
    // -- remove selected comments
    remove_btn.classList.remove('hidden')

    remove_btn.addEventListener('click', (e) => {
      e.preventDefault()

      inputs.map(input => {
        if (input.checked) {
          const highlight_id = input.parentNode.id
          if (highlight_id !== '') {
            comment_store.remove(highlight_id)
            removeCommentDOM(highlight_id)
          }
        }
      })

      commentReviewList(article_slug)
      updateCommentCounter('decrease', comments.length)
    })

  } else {
    publish_btn.classList.add('hidden')
    edit_btn.classList.add('hidden')
    remove_btn.classList.add('hidden')
  }
  
}

function make_comment_el(comment, idx, article_slug) {
  const comment_store = new LocalStore(`comment-${article_slug}`)

  // -- wrapper node
  const wrapper = document.createElement('div')
  wrapper.classList.add('comment-list-wrapper')
  wrapper.setAttribute('id', comment.id)

  // -- input checkbox
  const comment_input = document.createElement('input')
  comment_input.setAttribute('type', 'checkbox')
  comment_input.setAttribute('id', `comment_data[]`)
  comment_input.setAttribute('name', `comment_data[]`)
  comment_input.classList.add('comment-list-input')

  // -- label
  const comment_label = document.createElement('label')
  comment_label.setAttribute('for', `comment-list-${idx}`)
  comment_label.classList.add('comment-list-label')

  // -- text
  const comment_input_text = document.createElement('input')
  comment_input_text.setAttribute('type', 'text')
  comment_input_text.setAttribute('id', `comment-list-text-${idx}`)
  comment_input_text.setAttribute('text', 'comment-list-text')
  comment_input_text.setAttribute('value', comment.content.text)
  comment_input_text.setAttribute('readonly', 'readonly')

  // -- add link to text-selection span
  const highlight_id = comment.id

  const target = document.querySelector(`[data-highlight-id="${highlight_id}"]`)
  if (target !== null) {
    target.setAttribute('id', highlight_id) 
  }

  const show_text_selection = document.createElement('a')
  show_text_selection.setAttribute('href', `#${highlight_id}`)
  show_text_selection.classList.add('comment-list-show-highlight')

  show_text_selection.addEventListener('click', (e) => {
    // set border around text-selection for a
    // specific amount of time, then reset the style

    e.preventDefault()

    // target.scrollIntoView({behavior: 'smooth'})
    const targetPos = target.getBoundingClientRect().top + window.scrollY
    let offsetPosition = targetPos - 20;
    window.scroll({
      top: offsetPosition,
      left: 0,
      behavior: 'smooth'
    })

    target.style.border = '1px solid blue'

    setTimeout(() => {
      target.style.border = ''
    }, '3000')

  })

  // -- append above nodes to label wrapper node
  const comment_label_wrapper = document.createElement('div')
  comment_label_wrapper.classList.add('comment-label-wrapper')
  // comment_label_wrapper.append(comment_input_text)
  show_text_selection.append(comment_input_text)

  // -- append wrapper nodes to label node
  comment_label.append(comment_label_wrapper)
  comment_label_wrapper.append(show_text_selection)

  // -- append input and label nodes to root wrapper node
  wrapper.append(comment_input)
  wrapper.append(comment_label)


  return wrapper

}


// <https://stackoverflow.com/a/4716021>
function moveCaretToEnd(el) {
  if (typeof el.selectionStart == "number") {
    el.selectionStart = el.selectionEnd = el.value.length;
  } else if (typeof el.createTextRange != "undefined") {
    el.focus();
    var range = el.createTextRange();
    range.collapse(false);
    range.select();
  }
}

// save username into a different, own store
// so we can more easily fetch it and pre-add it
// to any other comment done afterwards
function setUsername(name, article_slug) {

  const user_store = new LocalStore('user')
  const user = user_store.getByID(article_slug)

  let username = {id: '', value: ''}

  if (user === undefined || user.value === '') {
    username['id'] = `${article_slug}`
    username['value'] = name

    user_store.save(username)

  } else {
    username = user
  }

  return username

}

function removeCommentDOM(highlight_id) {
  // remove text-highlight
  const tip = document.querySelector(`[data-highlight-id="${highlight_id}"]`)
  if (tip !== null) {
    tip.remove()
  }

  // remove article-comment from draft list
  const article_comment = document.querySelector(`[data-text-selection-id="${highlight_id}"]`)
  if (article_comment !== null) {
    article_comment.remove()
  }

  // remove article block highlight, if any
  const block = document.querySelector(`.content-wrapper #${highlight_id}`)
  if (block !== null) {
    block.classList.remove('block-highlight')
  }

}

function updateCommentCounter(op, amount) {
  // update comment count
  const comment_count = document.querySelector('#comment_count')
  const current_count = new Number(comment_count.innerHTML)

  if (op === 'increase') {
    comment_count.innerHTML = current_count + amount

  } else if (op === 'decrease') {
    const result = current_count - amount
    comment_count.innerHTML = result < 0 ? 0 : result
  }

}

module.exports = { commentReviewList,
                   setUsername,
                   updateCommentCounter }

},{"./local.store":5}],2:[function(require,module,exports){
const LocalStore = require('./local.store')
const xss = require('xss')
const { commentReviewList, setUsername, updateCommentCounter } = require('./comment-review')

function respond_comment(e) {
  e.preventDefault()

  const form = e.target

  
  // -- save comment to localStorage under:
  //    <current-article-url>: [{..}, ...]

  // to correctly save object into LocalStore
  // the object needs to have an ID field
  // else LocalStore will replace the previous
  // comment with the newest one only
  // nb: check if selection-type => text

  const article_slug = window.location.pathname.split('/').pop().split('/').join('+')
  const comment_store = new LocalStore(`comment-${article_slug}`)
  let comment = make_comment(form, comment_store)
  if (!comment) {
    return
  }

  if (comment.content.selection_text !== undefined) {
    comment['id'] = comment.content.selection_text.id
  } else {
    comment['id'] = comment.content.block_id
  }

  // -- save username to local.store if not set yet
  setUsername(comment.content.user, comment.content.article_slug)
  
  comment_store.save(comment)
 
  // -- set comment-review list
  commentReviewList(article_slug)

  // -- create and append newly posted comment
  const article_comment = make_comment_el(comment)
  createComment(form, article_comment, comment)
  article_comment.focus()

}

function make_comment( form, store ) {
  // -- comment can either be text-selection
  //    or block-level comment
  //    how to avoid breaking the commenting system
  //    if there's no `selection_text`

  // -- check if text-comment is not empty,
  //    eg just empty spaces
  const children = Array.from(form.children)
  const input_body = children.find( c => c.name == 'body' )

  const input_text = xss(input_body.value.trim(), {
    whiteList:          {},        // empty, means filter out all tags
    stripIgnoreTag:     true,      // filter out all HTML not in the whilelist
    stripIgnoreTagBody: ['script'] // the script tag is a special case, we need to filter out its content
  })

  if (input_text === '') {
    // stop operation
    input_body.value = input_body.value.trim()
    input_body.focus()
    input_body.placeholder = 'Please add some text'

    input_body.style.border = '1px solid red'

    setTimeout(() => {
      input_body.style.border = ''
      input_body.placeholder = 'comment...'
    }, '3000')

    return false
  }

  const article_slug      = form.getAttribute( 'data-article-slug' )
  const block_id          = form.getAttribute( 'data-block-id' )
  const selection_type    = form.getAttribute( 'data-block-selection-type' )
  const comment_id        = form.getAttribute( 'data-block-comment-id' )
  const selection_text    = store.getByID(comment_id)
  const author            = xss(children.find( c => c.name == 'author' ).value, {
    whiteList:          {},        // empty, means filter out all tags
    stripIgnoreTag:     true,      // filter out all HTML not in the whilelist
    stripIgnoreTagBody: ['script'] // the script tag is a special case, we need to filter out its content
  })
  const text              = input_text
  const ts                = new Date().toISOString()

  return {
    slug: ts,
    title: ts,
    template: 'comment',
    status: 'draft',
    content: {
      user: author,
      timestamp: ts,
      article_slug: article_slug,
      block_id: block_id,
      text: text,
      selection_type: selection_type,
      selection_text: selection_text,
      // selection_coords: selection_coords
    }
  }
}

function make_comment_thread_el( form ) {
  const thread = document.createElement( 'section' )
  thread.classList.add( 'thread' )
  const thread_form = form.cloneNode( true )
  thread.appendChild( thread_form )
  return thread
}

function make_comment_el(data) {
  // -- section
  const text_comment = document.createElement('section')
  const section_text = data.content.text
  text_comment.append(section_text)

  // -- footer
  const footer = document.createElement('footer')
  footer.classList.add( 'small_italic' )
  const date = document.createElement('p')
  const timestamp = document.createElement('time')

  const ts = new Date(data.content.timestamp).toLocaleDateString('nl-NL', {
    timeZone: 'Europe/Berlin',
    day: '2-digit',
    month: '2-digit',
    year: 'numeric',
    hour: 'numeric',
    minute: 'numeric',
    second: 'numeric'
  })
  timestamp.setAttribute('datetime', data.content.timestamp)
  date.append(timestamp)
  date.innerHTML = `On ${ts}`

  const user = document.createElement('p')
  user.innerHTML = `by ${data.content.user}`

  footer.append(date)
  footer.append(user)

  // -- append everything to <article>
  const article = document.createElement('article')
  article.setAttribute('tabindex', '0')
  article.setAttribute('data-text-selection-id', data.id)
  
  article.classList.add('comment-draft')

  article.append(text_comment)
  article.append(footer)

  return article

}

function createComment(form, article, comment) {
  // -- append new comment to comment thread
  //    before <form>
  let thread

  // form: reset and hide form
  form.reset()
  form.blur()
  
  // check if the form is the toolbar form
  const form_parent = form.parentNode
  if (form_parent.classList.contains('toolbar')) {

    // make a new comment thread for this block
    thread = make_comment_thread_el(form)
    const block_id = form.getAttribute('data-block-id')

    if (block_id !== '') {
      const block = document.querySelector(`.content-wrapper section#${block_id}`)

      if (block !== null) {
        const aside = block.querySelector('aside')
        const thread_form = Array.from(thread.children)[0]
        
        thread.insertBefore(article, thread_form)
        aside.appendChild(thread)

        // hide input-form
        form_parent.classList.add('hidden')
        form_parent.style.removeProperty('--top')
        form_parent.style.removeProperty('--left')
      }
    }

  } else {
    thread = form_parent
    thread.insertBefore(article, form)
  }

  // if comment is at block-level, highlight block
  if (comment.content.selection_text === undefined && comment.id !== '') {
    const block = document.querySelector(`.content-wrapper #${comment.id}`)
    if (block !== null) {
      block.classList.add('block-highlight')
    }
  }

}

function commentsArticle(comment, form) {
  const article_comment = make_comment_el(comment)

  // set missing data to be used with the input-form
  form.setAttribute('data-block-selection-type', comment.content.selection_type)
  form.setAttribute('data-block-comment-id', comment.id)

  form.querySelector('#selection_type').value = comment.content.selection_type
  form.querySelector('#block_id').value = comment.content.block_id

  // we use setAttribute to force adding the value, else
  // for some reasons it would not work
  form.querySelector('#author').setAttribute('value', comment.content.user)

  createComment(form, article_comment, comment)
}

function blockFocus() {
  // block-focus overlay

  const blocks = Array.from(document.querySelectorAll('.block'))
        .filter(block => !block.classList.contains('columns'))

  const focusOverlay = document.querySelector('.focus-overlay')
  
  blocks.forEach(block => {
    block.addEventListener('focus', (e) => {
      e.target.classList.add('selected')
      focusOverlay.classList.toggle('active')
    })

    block.addEventListener('blur', (e) => {
      e.target.classList.remove('selected')
      focusOverlay.classList.toggle('active')
    })
  })
}

function comments(article_slug) {
  const user_store = new LocalStore('user')
  const user = user_store.getByID(article_slug)

  const comment_store = new LocalStore(`comment-${article_slug}`)
  const comments = comment_store.getAll()
  const comment_forms = document.querySelectorAll( '.comment_form' )

  for (const comment_form of comment_forms) {
    // -- set comment to default username if there's any
    if (user !== undefined) {
      comment_form.querySelector('#author').value = user.value
    }

    // -- setup article's draft comments
    //    check if comment has `status: draft` 
    //    and matches current block-id
    const blockID = comment_form.dataset.blockId
    const comments_draft = comments.filter(comment => {
      if (comment.status === 'draft' && comment.content.block_id === blockID) {
        return comment
      }
    })

    if (comments_draft.length > 0) {
      comments_draft.map(comment => {
        commentsArticle(comment, comment_form)
      })
    }

    comment_form.onsubmit = respond_comment
  }

}

module.exports = { respond_comment,
                   commentsArticle,
                   blockFocus,
                   comments }

},{"./comment-review":1,"./local.store":5,"xss":16}],3:[function(require,module,exports){
function footnotesDesign() {

  function smallScreen(refs, notesWrap, notes) {

    if (window.innerWidth <= 600) { 

      notesWrap.classList.add('hidden')

      if (notes.length > 0) {
        notes.map(note => {
          note.style.display = 'none' 
        })
      }

      if (refs.length > 0) {
        refs.map((ref, idx) => {

          // on click display connected note
          ref.addEventListener('click', (e) => {
            e.preventDefault()

            const id = ref.id.split('-').pop()
            const note = notes.find(note => note.id.split('-').pop() === id)

            // start counting from current li-item, as it is the only one visible
            // and therefore it would otherwise always start from 1
            // note.parentElement.setAttribute('start', idx +1)
            // note.style.setProperty('--footnote-count', idx +1)

            if (note.style.display === 'table-row') {

              note.style.display = 'none'
              notesWrap.removeAttribute('style')

            } else {

              // -- reset
              notes.map(note => {
                note.style.display = 'none' 
              })
              // --
              
              note.style.display = 'table-row'

              notesWrap.style.display = 'block'
              notesWrap.style.position = 'fixed'
              notesWrap.style.bottom = 0
              notesWrap.style.left = 0
              notesWrap.style.backgroundColor = 'white'

            }

          })
        })
      }

    } else {
      bigScreen()
    }
  }

  function bigScreen() {

    if (window.innerWidth >= 600) { 

      // -- reset from small-screen when window-resizing
      notesWrap.classList.remove('hidden')
      notesWrap.removeAttribute('style')

      if (notes.length > 0) {
        notes.map(note => {
          note.removeAttribute('style')
        })
      }
      // --


      // -- set notes-wrap
      //    we set notes-wrap to left => content-block width?
      //    TODO double check this, as the code should be
      //    => `sideColumn.width + contentBlock.width` instead
      let sideColumn = document.querySelector('.view-comment-options-wrapper')
      let sideColumnRect = sideColumn.getBoundingClientRect()

      let contentBlock = document.querySelector('.content-wrapper .row .column')
      let contentBlockRect = contentBlock.getBoundingClientRect()

      notesWrap.style.left = `${contentBlockRect.width}px`

      // -- position notes aligned to footnote-ref
      refs.forEach(ref  => {

        // get footnote-ref top position
        let top = Math.round(ref.getBoundingClientRect().top - notesWrap.getBoundingClientRect().top)

        // get note
        const id = ref.id.split('-').pop()
        const note = notes.find(note => note.id.split('-').pop() === id)

        if (note) {

          // set note to footnote-ref top position
          if (note.previousElementSibling) {
            top = solveFor(note, top, notesWrap.getBoundingClientRect().top)
          }

          note.style.position = 'absolute'
          note.style.top = `${top}px`
          // --

        }

      })

    }
  }

  function solveFor(el, currentTop, parentTop) {
    // get footnote-ref top and handle ref overlapping (eg at the same top pos)

    const previousEl = el.previousElementSibling
    const previousElTop = parseInt(previousEl.style.top, 10)
    const previousElBottom = previousEl.getBoundingClientRect().bottom - parentTop

    // check for overlaps
    if (currentTop === previousElTop) {
      const newTop = currentTop + previousEl.getBoundingClientRect().height
      return newTop
    } else if (currentTop < previousElBottom) {
      const newTop = previousElBottom
      return newTop
    } else {
      return currentTop
    } 

  }


  // -- footnotes init
  const refs = Array.from(document.querySelectorAll('.ref-ft'))
  const notesWrap = document.querySelector('.notes')
  const notes = Array.from(notesWrap.querySelectorAll('.notes li'))

  smallScreen(refs, notesWrap, notes)
  bigScreen(refs, notesWrap, notes)

  window.addEventListener('resize', () => {
    smallScreen(refs, notesWrap, notes)
    bigScreen(refs, notesWrap, notes)
  })
  
}

module.exports = footnotesDesign

},{}],4:[function(require,module,exports){
const LocalStore = require('./local.store')

async function highlightsSync(article_slug) {
  const url = `/cosmo-api/${ article_slug }`

  return fetch(url)
    .then(response => response.json())
    .then(response => {
      const newData = response
      textHighlightMergeUnique(newData, article_slug)
    })
  .catch(error => {
    return []
  });

}

function textHighlightMergeUnique(newData, article_slug) {
  // merge this array of text-highlights (newData)
  // w/ current localStorage['comment-{article-slug}']
  // filter out comments w/o block_id for backward support

  // the problem is that upon publishing an article
  // we're removing it from the store, but it's not really
  // being removed (?);
  // so when merging the two stores (backend and frontend)
  // we're still adding the published articles that we should
  // have removed. two ways:
  // - fix the remove from store bug
  // - filter out local store to keep only draft comments

  const comment_store = new LocalStore(`comment-${article_slug}`);
  let comments = comment_store.getAll();
  const drafts = comments.filter(comment => comment.status === 'draft')

  const highlightsMerged = [...drafts, ...newData]
  const highlights = highlightsMerged.filter((value, index, self) => {
    return index === self.findIndex(t => {
      return t.id === value.id && t.content.block_id !== null
    })
  })

  // to make sure we just set only the
  // localStore draft comments together with
  // the published comments from the backend:
  // we remove and save the comment_store
  // each time.
  // this mostly solves the problem
  // of removing a published comment from the
  // backend without using other ways to
  // pass that reference to the frontend and
  // remove it from the localStore.
  // brutal, but overall fine !:
  comment_store.removeAll()
  comment_store.save(highlights)
}

module.exports = highlightsSync

},{"./local.store":5}],5:[function(require,module,exports){
// <https://github.com/alienzhou/web-highlighter/blob/master/example/local.store.js>

class LocalStore {
    constructor(id) {
        this.key = id !== undefined ? `cosmo-${id}` : 'cosmo-highlight';
    }

    storeToJson() {
        const store = localStorage.getItem(this.key);
        let sources;
        try {
            sources = JSON.parse(store) || [];
        }
        catch (e) {
            sources = [];
        }
        return sources;
    }

    jsonToStore(stores) {
        localStorage.setItem(this.key, JSON.stringify(stores));
    }

    save(data) {
        const stores = this.storeToJson();
        const map = {};
        stores.forEach((store, idx) => map[store.id] = idx);

        if (!Array.isArray(data)) {
            data = [data];
        }

        data.forEach(store => {
            // update
            if (map[store.id] !== undefined) {
                stores[map[store.id]] = store;
            }
            // append
            else {
                stores.push(store);
            }
        })
        this.jsonToStore(stores);
    }

    forceSave(store) {
        const stores = this.storeToJson();
        stores.push(store);
        this.jsonToStore(stores);
    }

    remove(id) {
        const stores = this.storeToJson();
        let index = null;
        for (let i = 0; i < stores.length; i++) {
            if (stores[i].id === id) {
                index = i;
                break;
            }
        }
        stores.splice(index, 1);
        this.jsonToStore(stores);
    }

    getByID(id) {
        const stores = this.storeToJson();
        let index = null;
        for (let i = 0; i < stores.length; i++) {
          if (stores[i].id === id) {
            index = i;
            break;
          }
        }

        const store = stores.find(s => s.id === id);
        return store;
    }

    getAll() {
        return this.storeToJson();
    }

    removeAll() {
        this.jsonToStore([]);
    }
}

module.exports = LocalStore

},{}],6:[function(require,module,exports){
const textHighlight = require('../text-highlight')
const { blockFocus, comments } = require('../comments')
const LocalStore = require('../local.store')
const { commentReviewList } = require('../comment-review')
const viewMode = require('../view-mode')
const footnotesDesign = require('../footnotes-design')

;(async() => {
  
  const article_slug = window.location.pathname.split('/').pop().split('/').join('+')

  // text-highlight
  const article_element = document.querySelector( 'main' )
  const selection_toolbar = document.querySelector( '.toolbar' )

  await textHighlight(article_element, selection_toolbar, article_slug)

  // comments
  comments(article_slug)

  // view-mode
  viewMode()

  // comment-review list
  commentReviewList(article_slug)

  blockFocus()

  // footnotes design
  footnotesDesign()

})()

},{"../comment-review":1,"../comments":2,"../footnotes-design":3,"../local.store":5,"../text-highlight":7,"../view-mode":8}],7:[function(require,module,exports){
const highlightsSync = require('./highlights-sync')
const Highlighter = require('web-highlighter')
const LocalStore = require('./local.store')


// <https://github.com/alienzhou/web-highlighter/blob/master/example/index.js>
async function textHighlight(target, toolbar, article_slug) {

  const highlighter = new Highlighter({
    $root: document.querySelector('.content-wrapper'),
    wrapTag: 'span',
    exceptSelectors: ['.highlight-tip', 'aside']
  })

  highlighter.setOption({
    style: {
      className: 'bgc-accent',
    },
  })


  // -- restore all comments (drafts and published)
  //    which are mapped only to text-highlights with actual
  //    comments attached to it
  //    OR are block-level comments

  // -- synchronize text-highlights backend data with localStorage
  await highlightsSync(article_slug)
  
  const comment_store = new LocalStore(`comment-${article_slug}`)
  comment_store.getAll().forEach(comment => {

    if (typeof comment === 'object') {
      if ('content' in comment && comment.content.selection_text !== undefined) {
        const hs = comment.content.selection_text
        highlighter.fromStore(hs.startMeta, hs.endMeta, hs.text, hs.id)


        // if comment is at block-level, highlight block
        if (comment.content.selection_text.text === null && comment.content.block_id !== '') {
          const block = document.querySelector(`.content-wrapper #${comment.content.block_id}`)
          if (block !== null) {
            block.classList.add('block-highlight')
          }
        }

      }
    }
  });

  const highlight_store = new LocalStore(`comment-${article_slug}`)

  // except for the CREATE event
  // any other event is triggered when interacting
  // with an existing selection span
  highlighter
    .on(Highlighter.event.CLICK, ({id}) => {
      console.log('click -', id);
    })
    .on(Highlighter.event.HOVER, ({id}) => {
      console.log('hover -', id);
      highlighter.addClass('highlight-wrap-hover', id);
    })
    .on(Highlighter.event.HOVER_OUT, ({id}) => {
      console.log('hover out -', id);
      highlighter.removeClass('highlight-wrap-hover', id);
    })
    .on(Highlighter.event.CREATE, ({sources}) => {
      // console.log('CREATE')

      // close the comment box if it is toggled
      toolbar_hide(toolbar)

      // create span to allow removing the selection
      sources.forEach(source => {

        // -- setup text-selection
        const selectionNode = highlighter.getDoms(source.id)[0]
        const blockID = getBlockID(selectionNode)

        if (blockID == null) {
          // if blockID is missing or not set,
          // stop everything
          removeSelection(highlighter, source.id)
          return
        }

        const user_store = new LocalStore('user')
        const user = user_store.getByID(article_slug)

        // -- toggle comment input form
        const positionToolbar = getCoords(selectionNode)
        const block_type = 'text'
        toggle_toolbar(positionToolbar, toolbar, block_type, source.id, blockID, user)
        
        // -- save text-selection to highlight_store
        highlight_store.save(source)

        const form = toolbar.querySelector('form')
        form.querySelector('#selection_text').value = JSON.stringify(source)
      })

     })
    .on(Highlighter.event.REMOVE, ({ids}) => {
      // TODO implement remove action
      console.log('remove -', ids);
      // ids.forEach(id => store.remove(id));
    });

  // -- => start highlighter
  highlighter.run();

  function removeSelection(highlighter, id) {
    highlighter.remove(id);
  }

  function getBlockID(node) {
    const block = node.closest('section .block')

    if (block !== undefined && block !== null) {
      if (block.id) {
        return block.id
      }
    } else if (node.parentNode.dataset.bid !== undefined) {
      // this checks if instead of a block we're highlighting
      // a footnote with DOM <li id=note-ref-<ref> data-bid=<bid>>
      return node.parentNode.dataset.bid

    }

    return null
  }

  function toggle_toolbar(position, toolbar, blockType, sourceID, blockID, user) {
    const form = toolbar.querySelector('form')
    form.setAttribute('data-block-selection-type', blockType)
    form.setAttribute('data-block-comment-id', sourceID)
    form.setAttribute('data-block-id', blockID)

    form.querySelector('#selection_type').value = blockType
    form.querySelector('#block_id').value = blockID
    form.querySelector('#author').value = user.value

    // -- display input form for adding a comment
    toolbar.classList.remove('hidden')
    toolbar.style.setProperty( '--top', `${position.top}px` )
    toolbar.style.setProperty( '--left', `${position.left + position.width}px` )

    // handle click button to hide
    const btn_hide = toolbar.querySelector('.toolbar-btn-hide')
    btn_hide.addEventListener('click', () => {
      toolbar_hide(toolbar)

      const tip = document.querySelector(`[data-id="${sourceID}"]`)
      removeSelection(highlighter, sourceID)
    })

  }

  function toolbar_hide(toolbar) {
    toolbar.classList.add( 'hidden' )
    toolbar.style.removeProperty('--top')
    toolbar.style.removeProperty('--left')
  }

  function getCoords(elem) {
    let box = elem.getBoundingClientRect();

    return {
      top: box.top + window.pageYOffset,
      left: box.left + window.pageXOffset,
      width: box.width,
      height: box.height
    };
  }

}

module.exports = textHighlight;

},{"./highlights-sync":4,"./local.store":5,"web-highlighter":14}],8:[function(require,module,exports){
function viewMode() {
  const viewOptions = document.querySelector('.view-options')

  const selectedView = viewOptions.querySelector('input:checked')
  const inputs = Array.from(viewOptions.querySelectorAll('input'))

  inputs.map(input => {
    // set view based on currently selected input radio
    // (eg good for page load / refresh)
    if (input.checked) {
      toggleView(input.value) 
    }

    // set view based on clicked input radio 
    input.addEventListener('click', (e) => {
      const target = e.target
      toggleView(target.value) 
    })
  })

}

function toggleView(targetValue) {
  const columns = Array.from(document.querySelectorAll('.content-wrapper .column'))
  const blocks = Array.from(document.querySelectorAll('.content-wrapper .block'))
  const blocksContent = Array.from(document.querySelectorAll('.content-wrapper .block > .contents'))
  const asides = Array.from(document.querySelectorAll('aside'))
  const threads = Array.from(document.querySelectorAll('.thread'))

  // reset custom settings based on specific view
  columns.map(column => {
    column.setAttribute('data-col-width', '1/1')
  })

  blocks.map(block => {
    block.classList.remove('hidden')
    block.style.boxShadow = 'var(--gridshadow)'
    block.style.padding = '0.5rem'
  })

  blocksContent.map(block => {
    block.classList.remove('font-size-micro')
    block.classList.remove('hidden')
  })

  asides.map(aside => {
    aside.style.maxWidth = 'var(--side-width)'
    aside.style.width = 'var(--side-width)'
    aside.style.setProperty('--n', '1')
  })
  threads.map(thread => thread.classList.remove('hidden'))

  switch(targetValue) {
  case '1':
    // display only article-blocks
    threads.map(thread => thread.classList.add('hidden'))
    break;

  case '2':
    // display article-blocks + comments
    break;

  case '3':
    // display comments + article-blocks
    columns.map(column => {
      column.setAttribute('data-col-width', '1/4')
    })

    blocksContent.map(block => {
      block.classList.add('font-size-micro')
    })

    asides.map(aside => {
      aside.style.width = '67vw'
      aside.style.maxWidth = '67vw'
      aside.style.setProperty('--n', '4')
    })

    break;

  case '4':
    // display comments

    columns.map(column => {
      column.setAttribute('data-col-width', '1/4')
    })

    blocks.map(block => {
      block.style.boxShadow = 'none'
      block.style.padding = '0'
      console.log('block =>', block)
    })

    blocksContent.map(block => {
      block.classList.add('font-size-micro')
      block.classList.add('hidden')
    })

    asides.map(aside => {
      aside.style.width = '78vw'
      aside.style.maxWidth = '78vw'
      aside.style.setProperty('--n', '5')
    })

    break;

  }
}

module.exports = viewMode

},{}],9:[function(require,module,exports){
/**
 * cssfilter
 *
 * @author 老雷<leizongmin@gmail.com>
 */

var DEFAULT = require('./default');
var parseStyle = require('./parser');
var _ = require('./util');


/**
 * 返回值是否为空
 *
 * @param {Object} obj
 * @return {Boolean}
 */
function isNull (obj) {
  return (obj === undefined || obj === null);
}

/**
 * 浅拷贝对象
 *
 * @param {Object} obj
 * @return {Object}
 */
function shallowCopyObject (obj) {
  var ret = {};
  for (var i in obj) {
    ret[i] = obj[i];
  }
  return ret;
}

/**
 * 创建CSS过滤器
 *
 * @param {Object} options
 *   - {Object} whiteList
 *   - {Function} onAttr
 *   - {Function} onIgnoreAttr
 *   - {Function} safeAttrValue
 */
function FilterCSS (options) {
  options = shallowCopyObject(options || {});
  options.whiteList = options.whiteList || DEFAULT.whiteList;
  options.onAttr = options.onAttr || DEFAULT.onAttr;
  options.onIgnoreAttr = options.onIgnoreAttr || DEFAULT.onIgnoreAttr;
  options.safeAttrValue = options.safeAttrValue || DEFAULT.safeAttrValue;
  this.options = options;
}

FilterCSS.prototype.process = function (css) {
  // 兼容各种奇葩输入
  css = css || '';
  css = css.toString();
  if (!css) return '';

  var me = this;
  var options = me.options;
  var whiteList = options.whiteList;
  var onAttr = options.onAttr;
  var onIgnoreAttr = options.onIgnoreAttr;
  var safeAttrValue = options.safeAttrValue;

  var retCSS = parseStyle(css, function (sourcePosition, position, name, value, source) {

    var check = whiteList[name];
    var isWhite = false;
    if (check === true) isWhite = check;
    else if (typeof check === 'function') isWhite = check(value);
    else if (check instanceof RegExp) isWhite = check.test(value);
    if (isWhite !== true) isWhite = false;

    // 如果过滤后 value 为空则直接忽略
    value = safeAttrValue(name, value);
    if (!value) return;

    var opts = {
      position: position,
      sourcePosition: sourcePosition,
      source: source,
      isWhite: isWhite
    };

    if (isWhite) {

      var ret = onAttr(name, value, opts);
      if (isNull(ret)) {
        return name + ':' + value;
      } else {
        return ret;
      }

    } else {

      var ret = onIgnoreAttr(name, value, opts);
      if (!isNull(ret)) {
        return ret;
      }

    }
  });

  return retCSS;
};


module.exports = FilterCSS;

},{"./default":10,"./parser":12,"./util":13}],10:[function(require,module,exports){
/**
 * cssfilter
 *
 * @author 老雷<leizongmin@gmail.com>
 */

function getDefaultWhiteList () {
  // 白名单值说明：
  // true: 允许该属性
  // Function: function (val) { } 返回true表示允许该属性，其他值均表示不允许
  // RegExp: regexp.test(val) 返回true表示允许该属性，其他值均表示不允许
  // 除上面列出的值外均表示不允许
  var whiteList = {};

  whiteList['align-content'] = false; // default: auto
  whiteList['align-items'] = false; // default: auto
  whiteList['align-self'] = false; // default: auto
  whiteList['alignment-adjust'] = false; // default: auto
  whiteList['alignment-baseline'] = false; // default: baseline
  whiteList['all'] = false; // default: depending on individual properties
  whiteList['anchor-point'] = false; // default: none
  whiteList['animation'] = false; // default: depending on individual properties
  whiteList['animation-delay'] = false; // default: 0
  whiteList['animation-direction'] = false; // default: normal
  whiteList['animation-duration'] = false; // default: 0
  whiteList['animation-fill-mode'] = false; // default: none
  whiteList['animation-iteration-count'] = false; // default: 1
  whiteList['animation-name'] = false; // default: none
  whiteList['animation-play-state'] = false; // default: running
  whiteList['animation-timing-function'] = false; // default: ease
  whiteList['azimuth'] = false; // default: center
  whiteList['backface-visibility'] = false; // default: visible
  whiteList['background'] = true; // default: depending on individual properties
  whiteList['background-attachment'] = true; // default: scroll
  whiteList['background-clip'] = true; // default: border-box
  whiteList['background-color'] = true; // default: transparent
  whiteList['background-image'] = true; // default: none
  whiteList['background-origin'] = true; // default: padding-box
  whiteList['background-position'] = true; // default: 0% 0%
  whiteList['background-repeat'] = true; // default: repeat
  whiteList['background-size'] = true; // default: auto
  whiteList['baseline-shift'] = false; // default: baseline
  whiteList['binding'] = false; // default: none
  whiteList['bleed'] = false; // default: 6pt
  whiteList['bookmark-label'] = false; // default: content()
  whiteList['bookmark-level'] = false; // default: none
  whiteList['bookmark-state'] = false; // default: open
  whiteList['border'] = true; // default: depending on individual properties
  whiteList['border-bottom'] = true; // default: depending on individual properties
  whiteList['border-bottom-color'] = true; // default: current color
  whiteList['border-bottom-left-radius'] = true; // default: 0
  whiteList['border-bottom-right-radius'] = true; // default: 0
  whiteList['border-bottom-style'] = true; // default: none
  whiteList['border-bottom-width'] = true; // default: medium
  whiteList['border-collapse'] = true; // default: separate
  whiteList['border-color'] = true; // default: depending on individual properties
  whiteList['border-image'] = true; // default: none
  whiteList['border-image-outset'] = true; // default: 0
  whiteList['border-image-repeat'] = true; // default: stretch
  whiteList['border-image-slice'] = true; // default: 100%
  whiteList['border-image-source'] = true; // default: none
  whiteList['border-image-width'] = true; // default: 1
  whiteList['border-left'] = true; // default: depending on individual properties
  whiteList['border-left-color'] = true; // default: current color
  whiteList['border-left-style'] = true; // default: none
  whiteList['border-left-width'] = true; // default: medium
  whiteList['border-radius'] = true; // default: 0
  whiteList['border-right'] = true; // default: depending on individual properties
  whiteList['border-right-color'] = true; // default: current color
  whiteList['border-right-style'] = true; // default: none
  whiteList['border-right-width'] = true; // default: medium
  whiteList['border-spacing'] = true; // default: 0
  whiteList['border-style'] = true; // default: depending on individual properties
  whiteList['border-top'] = true; // default: depending on individual properties
  whiteList['border-top-color'] = true; // default: current color
  whiteList['border-top-left-radius'] = true; // default: 0
  whiteList['border-top-right-radius'] = true; // default: 0
  whiteList['border-top-style'] = true; // default: none
  whiteList['border-top-width'] = true; // default: medium
  whiteList['border-width'] = true; // default: depending on individual properties
  whiteList['bottom'] = false; // default: auto
  whiteList['box-decoration-break'] = true; // default: slice
  whiteList['box-shadow'] = true; // default: none
  whiteList['box-sizing'] = true; // default: content-box
  whiteList['box-snap'] = true; // default: none
  whiteList['box-suppress'] = true; // default: show
  whiteList['break-after'] = true; // default: auto
  whiteList['break-before'] = true; // default: auto
  whiteList['break-inside'] = true; // default: auto
  whiteList['caption-side'] = false; // default: top
  whiteList['chains'] = false; // default: none
  whiteList['clear'] = true; // default: none
  whiteList['clip'] = false; // default: auto
  whiteList['clip-path'] = false; // default: none
  whiteList['clip-rule'] = false; // default: nonzero
  whiteList['color'] = true; // default: implementation dependent
  whiteList['color-interpolation-filters'] = true; // default: auto
  whiteList['column-count'] = false; // default: auto
  whiteList['column-fill'] = false; // default: balance
  whiteList['column-gap'] = false; // default: normal
  whiteList['column-rule'] = false; // default: depending on individual properties
  whiteList['column-rule-color'] = false; // default: current color
  whiteList['column-rule-style'] = false; // default: medium
  whiteList['column-rule-width'] = false; // default: medium
  whiteList['column-span'] = false; // default: none
  whiteList['column-width'] = false; // default: auto
  whiteList['columns'] = false; // default: depending on individual properties
  whiteList['contain'] = false; // default: none
  whiteList['content'] = false; // default: normal
  whiteList['counter-increment'] = false; // default: none
  whiteList['counter-reset'] = false; // default: none
  whiteList['counter-set'] = false; // default: none
  whiteList['crop'] = false; // default: auto
  whiteList['cue'] = false; // default: depending on individual properties
  whiteList['cue-after'] = false; // default: none
  whiteList['cue-before'] = false; // default: none
  whiteList['cursor'] = false; // default: auto
  whiteList['direction'] = false; // default: ltr
  whiteList['display'] = true; // default: depending on individual properties
  whiteList['display-inside'] = true; // default: auto
  whiteList['display-list'] = true; // default: none
  whiteList['display-outside'] = true; // default: inline-level
  whiteList['dominant-baseline'] = false; // default: auto
  whiteList['elevation'] = false; // default: level
  whiteList['empty-cells'] = false; // default: show
  whiteList['filter'] = false; // default: none
  whiteList['flex'] = false; // default: depending on individual properties
  whiteList['flex-basis'] = false; // default: auto
  whiteList['flex-direction'] = false; // default: row
  whiteList['flex-flow'] = false; // default: depending on individual properties
  whiteList['flex-grow'] = false; // default: 0
  whiteList['flex-shrink'] = false; // default: 1
  whiteList['flex-wrap'] = false; // default: nowrap
  whiteList['float'] = false; // default: none
  whiteList['float-offset'] = false; // default: 0 0
  whiteList['flood-color'] = false; // default: black
  whiteList['flood-opacity'] = false; // default: 1
  whiteList['flow-from'] = false; // default: none
  whiteList['flow-into'] = false; // default: none
  whiteList['font'] = true; // default: depending on individual properties
  whiteList['font-family'] = true; // default: implementation dependent
  whiteList['font-feature-settings'] = true; // default: normal
  whiteList['font-kerning'] = true; // default: auto
  whiteList['font-language-override'] = true; // default: normal
  whiteList['font-size'] = true; // default: medium
  whiteList['font-size-adjust'] = true; // default: none
  whiteList['font-stretch'] = true; // default: normal
  whiteList['font-style'] = true; // default: normal
  whiteList['font-synthesis'] = true; // default: weight style
  whiteList['font-variant'] = true; // default: normal
  whiteList['font-variant-alternates'] = true; // default: normal
  whiteList['font-variant-caps'] = true; // default: normal
  whiteList['font-variant-east-asian'] = true; // default: normal
  whiteList['font-variant-ligatures'] = true; // default: normal
  whiteList['font-variant-numeric'] = true; // default: normal
  whiteList['font-variant-position'] = true; // default: normal
  whiteList['font-weight'] = true; // default: normal
  whiteList['grid'] = false; // default: depending on individual properties
  whiteList['grid-area'] = false; // default: depending on individual properties
  whiteList['grid-auto-columns'] = false; // default: auto
  whiteList['grid-auto-flow'] = false; // default: none
  whiteList['grid-auto-rows'] = false; // default: auto
  whiteList['grid-column'] = false; // default: depending on individual properties
  whiteList['grid-column-end'] = false; // default: auto
  whiteList['grid-column-start'] = false; // default: auto
  whiteList['grid-row'] = false; // default: depending on individual properties
  whiteList['grid-row-end'] = false; // default: auto
  whiteList['grid-row-start'] = false; // default: auto
  whiteList['grid-template'] = false; // default: depending on individual properties
  whiteList['grid-template-areas'] = false; // default: none
  whiteList['grid-template-columns'] = false; // default: none
  whiteList['grid-template-rows'] = false; // default: none
  whiteList['hanging-punctuation'] = false; // default: none
  whiteList['height'] = true; // default: auto
  whiteList['hyphens'] = false; // default: manual
  whiteList['icon'] = false; // default: auto
  whiteList['image-orientation'] = false; // default: auto
  whiteList['image-resolution'] = false; // default: normal
  whiteList['ime-mode'] = false; // default: auto
  whiteList['initial-letters'] = false; // default: normal
  whiteList['inline-box-align'] = false; // default: last
  whiteList['justify-content'] = false; // default: auto
  whiteList['justify-items'] = false; // default: auto
  whiteList['justify-self'] = false; // default: auto
  whiteList['left'] = false; // default: auto
  whiteList['letter-spacing'] = true; // default: normal
  whiteList['lighting-color'] = true; // default: white
  whiteList['line-box-contain'] = false; // default: block inline replaced
  whiteList['line-break'] = false; // default: auto
  whiteList['line-grid'] = false; // default: match-parent
  whiteList['line-height'] = false; // default: normal
  whiteList['line-snap'] = false; // default: none
  whiteList['line-stacking'] = false; // default: depending on individual properties
  whiteList['line-stacking-ruby'] = false; // default: exclude-ruby
  whiteList['line-stacking-shift'] = false; // default: consider-shifts
  whiteList['line-stacking-strategy'] = false; // default: inline-line-height
  whiteList['list-style'] = true; // default: depending on individual properties
  whiteList['list-style-image'] = true; // default: none
  whiteList['list-style-position'] = true; // default: outside
  whiteList['list-style-type'] = true; // default: disc
  whiteList['margin'] = true; // default: depending on individual properties
  whiteList['margin-bottom'] = true; // default: 0
  whiteList['margin-left'] = true; // default: 0
  whiteList['margin-right'] = true; // default: 0
  whiteList['margin-top'] = true; // default: 0
  whiteList['marker-offset'] = false; // default: auto
  whiteList['marker-side'] = false; // default: list-item
  whiteList['marks'] = false; // default: none
  whiteList['mask'] = false; // default: border-box
  whiteList['mask-box'] = false; // default: see individual properties
  whiteList['mask-box-outset'] = false; // default: 0
  whiteList['mask-box-repeat'] = false; // default: stretch
  whiteList['mask-box-slice'] = false; // default: 0 fill
  whiteList['mask-box-source'] = false; // default: none
  whiteList['mask-box-width'] = false; // default: auto
  whiteList['mask-clip'] = false; // default: border-box
  whiteList['mask-image'] = false; // default: none
  whiteList['mask-origin'] = false; // default: border-box
  whiteList['mask-position'] = false; // default: center
  whiteList['mask-repeat'] = false; // default: no-repeat
  whiteList['mask-size'] = false; // default: border-box
  whiteList['mask-source-type'] = false; // default: auto
  whiteList['mask-type'] = false; // default: luminance
  whiteList['max-height'] = true; // default: none
  whiteList['max-lines'] = false; // default: none
  whiteList['max-width'] = true; // default: none
  whiteList['min-height'] = true; // default: 0
  whiteList['min-width'] = true; // default: 0
  whiteList['move-to'] = false; // default: normal
  whiteList['nav-down'] = false; // default: auto
  whiteList['nav-index'] = false; // default: auto
  whiteList['nav-left'] = false; // default: auto
  whiteList['nav-right'] = false; // default: auto
  whiteList['nav-up'] = false; // default: auto
  whiteList['object-fit'] = false; // default: fill
  whiteList['object-position'] = false; // default: 50% 50%
  whiteList['opacity'] = false; // default: 1
  whiteList['order'] = false; // default: 0
  whiteList['orphans'] = false; // default: 2
  whiteList['outline'] = false; // default: depending on individual properties
  whiteList['outline-color'] = false; // default: invert
  whiteList['outline-offset'] = false; // default: 0
  whiteList['outline-style'] = false; // default: none
  whiteList['outline-width'] = false; // default: medium
  whiteList['overflow'] = false; // default: depending on individual properties
  whiteList['overflow-wrap'] = false; // default: normal
  whiteList['overflow-x'] = false; // default: visible
  whiteList['overflow-y'] = false; // default: visible
  whiteList['padding'] = true; // default: depending on individual properties
  whiteList['padding-bottom'] = true; // default: 0
  whiteList['padding-left'] = true; // default: 0
  whiteList['padding-right'] = true; // default: 0
  whiteList['padding-top'] = true; // default: 0
  whiteList['page'] = false; // default: auto
  whiteList['page-break-after'] = false; // default: auto
  whiteList['page-break-before'] = false; // default: auto
  whiteList['page-break-inside'] = false; // default: auto
  whiteList['page-policy'] = false; // default: start
  whiteList['pause'] = false; // default: implementation dependent
  whiteList['pause-after'] = false; // default: implementation dependent
  whiteList['pause-before'] = false; // default: implementation dependent
  whiteList['perspective'] = false; // default: none
  whiteList['perspective-origin'] = false; // default: 50% 50%
  whiteList['pitch'] = false; // default: medium
  whiteList['pitch-range'] = false; // default: 50
  whiteList['play-during'] = false; // default: auto
  whiteList['position'] = false; // default: static
  whiteList['presentation-level'] = false; // default: 0
  whiteList['quotes'] = false; // default: text
  whiteList['region-fragment'] = false; // default: auto
  whiteList['resize'] = false; // default: none
  whiteList['rest'] = false; // default: depending on individual properties
  whiteList['rest-after'] = false; // default: none
  whiteList['rest-before'] = false; // default: none
  whiteList['richness'] = false; // default: 50
  whiteList['right'] = false; // default: auto
  whiteList['rotation'] = false; // default: 0
  whiteList['rotation-point'] = false; // default: 50% 50%
  whiteList['ruby-align'] = false; // default: auto
  whiteList['ruby-merge'] = false; // default: separate
  whiteList['ruby-position'] = false; // default: before
  whiteList['shape-image-threshold'] = false; // default: 0.0
  whiteList['shape-outside'] = false; // default: none
  whiteList['shape-margin'] = false; // default: 0
  whiteList['size'] = false; // default: auto
  whiteList['speak'] = false; // default: auto
  whiteList['speak-as'] = false; // default: normal
  whiteList['speak-header'] = false; // default: once
  whiteList['speak-numeral'] = false; // default: continuous
  whiteList['speak-punctuation'] = false; // default: none
  whiteList['speech-rate'] = false; // default: medium
  whiteList['stress'] = false; // default: 50
  whiteList['string-set'] = false; // default: none
  whiteList['tab-size'] = false; // default: 8
  whiteList['table-layout'] = false; // default: auto
  whiteList['text-align'] = true; // default: start
  whiteList['text-align-last'] = true; // default: auto
  whiteList['text-combine-upright'] = true; // default: none
  whiteList['text-decoration'] = true; // default: none
  whiteList['text-decoration-color'] = true; // default: currentColor
  whiteList['text-decoration-line'] = true; // default: none
  whiteList['text-decoration-skip'] = true; // default: objects
  whiteList['text-decoration-style'] = true; // default: solid
  whiteList['text-emphasis'] = true; // default: depending on individual properties
  whiteList['text-emphasis-color'] = true; // default: currentColor
  whiteList['text-emphasis-position'] = true; // default: over right
  whiteList['text-emphasis-style'] = true; // default: none
  whiteList['text-height'] = true; // default: auto
  whiteList['text-indent'] = true; // default: 0
  whiteList['text-justify'] = true; // default: auto
  whiteList['text-orientation'] = true; // default: mixed
  whiteList['text-overflow'] = true; // default: clip
  whiteList['text-shadow'] = true; // default: none
  whiteList['text-space-collapse'] = true; // default: collapse
  whiteList['text-transform'] = true; // default: none
  whiteList['text-underline-position'] = true; // default: auto
  whiteList['text-wrap'] = true; // default: normal
  whiteList['top'] = false; // default: auto
  whiteList['transform'] = false; // default: none
  whiteList['transform-origin'] = false; // default: 50% 50% 0
  whiteList['transform-style'] = false; // default: flat
  whiteList['transition'] = false; // default: depending on individual properties
  whiteList['transition-delay'] = false; // default: 0s
  whiteList['transition-duration'] = false; // default: 0s
  whiteList['transition-property'] = false; // default: all
  whiteList['transition-timing-function'] = false; // default: ease
  whiteList['unicode-bidi'] = false; // default: normal
  whiteList['vertical-align'] = false; // default: baseline
  whiteList['visibility'] = false; // default: visible
  whiteList['voice-balance'] = false; // default: center
  whiteList['voice-duration'] = false; // default: auto
  whiteList['voice-family'] = false; // default: implementation dependent
  whiteList['voice-pitch'] = false; // default: medium
  whiteList['voice-range'] = false; // default: medium
  whiteList['voice-rate'] = false; // default: normal
  whiteList['voice-stress'] = false; // default: normal
  whiteList['voice-volume'] = false; // default: medium
  whiteList['volume'] = false; // default: medium
  whiteList['white-space'] = false; // default: normal
  whiteList['widows'] = false; // default: 2
  whiteList['width'] = true; // default: auto
  whiteList['will-change'] = false; // default: auto
  whiteList['word-break'] = true; // default: normal
  whiteList['word-spacing'] = true; // default: normal
  whiteList['word-wrap'] = true; // default: normal
  whiteList['wrap-flow'] = false; // default: auto
  whiteList['wrap-through'] = false; // default: wrap
  whiteList['writing-mode'] = false; // default: horizontal-tb
  whiteList['z-index'] = false; // default: auto

  return whiteList;
}


/**
 * 匹配到白名单上的一个属性时
 *
 * @param {String} name
 * @param {String} value
 * @param {Object} options
 * @return {String}
 */
function onAttr (name, value, options) {
  // do nothing
}

/**
 * 匹配到不在白名单上的一个属性时
 *
 * @param {String} name
 * @param {String} value
 * @param {Object} options
 * @return {String}
 */
function onIgnoreAttr (name, value, options) {
  // do nothing
}

var REGEXP_URL_JAVASCRIPT = /javascript\s*\:/img;

/**
 * 过滤属性值
 *
 * @param {String} name
 * @param {String} value
 * @return {String}
 */
function safeAttrValue(name, value) {
  if (REGEXP_URL_JAVASCRIPT.test(value)) return '';
  return value;
}


exports.whiteList = getDefaultWhiteList();
exports.getDefaultWhiteList = getDefaultWhiteList;
exports.onAttr = onAttr;
exports.onIgnoreAttr = onIgnoreAttr;
exports.safeAttrValue = safeAttrValue;

},{}],11:[function(require,module,exports){
/**
 * cssfilter
 *
 * @author 老雷<leizongmin@gmail.com>
 */

var DEFAULT = require('./default');
var FilterCSS = require('./css');


/**
 * XSS过滤
 *
 * @param {String} css 要过滤的CSS代码
 * @param {Object} options 选项：whiteList, onAttr, onIgnoreAttr
 * @return {String}
 */
function filterCSS (html, options) {
  var xss = new FilterCSS(options);
  return xss.process(html);
}


// 输出
exports = module.exports = filterCSS;
exports.FilterCSS = FilterCSS;
for (var i in DEFAULT) exports[i] = DEFAULT[i];

// 在浏览器端使用
if (typeof window !== 'undefined') {
  window.filterCSS = module.exports;
}

},{"./css":9,"./default":10}],12:[function(require,module,exports){
/**
 * cssfilter
 *
 * @author 老雷<leizongmin@gmail.com>
 */

var _ = require('./util');


/**
 * 解析style
 *
 * @param {String} css
 * @param {Function} onAttr 处理属性的函数
 *   参数格式： function (sourcePosition, position, name, value, source)
 * @return {String}
 */
function parseStyle (css, onAttr) {
  css = _.trimRight(css);
  if (css[css.length - 1] !== ';') css += ';';
  var cssLength = css.length;
  var isParenthesisOpen = false;
  var lastPos = 0;
  var i = 0;
  var retCSS = '';

  function addNewAttr () {
    // 如果没有正常的闭合圆括号，则直接忽略当前属性
    if (!isParenthesisOpen) {
      var source = _.trim(css.slice(lastPos, i));
      var j = source.indexOf(':');
      if (j !== -1) {
        var name = _.trim(source.slice(0, j));
        var value = _.trim(source.slice(j + 1));
        // 必须有属性名称
        if (name) {
          var ret = onAttr(lastPos, retCSS.length, name, value, source);
          if (ret) retCSS += ret + '; ';
        }
      }
    }
    lastPos = i + 1;
  }

  for (; i < cssLength; i++) {
    var c = css[i];
    if (c === '/' && css[i + 1] === '*') {
      // 备注开始
      var j = css.indexOf('*/', i + 2);
      // 如果没有正常的备注结束，则后面的部分全部跳过
      if (j === -1) break;
      // 直接将当前位置调到备注结尾，并且初始化状态
      i = j + 1;
      lastPos = i + 1;
      isParenthesisOpen = false;
    } else if (c === '(') {
      isParenthesisOpen = true;
    } else if (c === ')') {
      isParenthesisOpen = false;
    } else if (c === ';') {
      if (isParenthesisOpen) {
        // 在圆括号里面，忽略
      } else {
        addNewAttr();
      }
    } else if (c === '\n') {
      addNewAttr();
    }
  }

  return _.trim(retCSS);
}

module.exports = parseStyle;

},{"./util":13}],13:[function(require,module,exports){
module.exports = {
  indexOf: function (arr, item) {
    var i, j;
    if (Array.prototype.indexOf) {
      return arr.indexOf(item);
    }
    for (i = 0, j = arr.length; i < j; i++) {
      if (arr[i] === item) {
        return i;
      }
    }
    return -1;
  },
  forEach: function (arr, fn, scope) {
    var i, j;
    if (Array.prototype.forEach) {
      return arr.forEach(fn, scope);
    }
    for (i = 0, j = arr.length; i < j; i++) {
      fn.call(scope, arr[i], i, arr);
    }
  },
  trim: function (str) {
    if (String.prototype.trim) {
      return str.trim();
    }
    return str.replace(/(^\s*)|(\s*$)/g, '');
  },
  trimRight: function (str) {
    if (String.prototype.trimRight) {
      return str.trimRight();
    }
    return str.replace(/(\s*$)/g, '');
  }
};

},{}],14:[function(require,module,exports){
/*! web-highlighter v0.7.4 https://github.com/alienzhou/web-highlighter */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Highlighter=t():e.Highlighter=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.eventEmitter=t.INTERNAL_ERROR_EVENT=t.UNKNOWN_IDX=t.ROOT_IDX=t.getStylesheet=t.getDefaultOptions=t.CAMEL_DATASET_SPLIT_TYPE=t.CAMEL_DATASET_IDENTIFIER_EXTRA=t.CAMEL_DATASET_IDENTIFIER=t.DATASET_SPLIT_TYPE=t.DATASET_IDENTIFIER_EXTRA=t.DATASET_IDENTIFIER=t.STYLESHEET_ID=t.LOCAL_STORE_KEY=t.ID_DIVISION=void 0;var a=i(n(10)),l=i(n(2));t.ID_DIVISION=";",t.LOCAL_STORE_KEY="highlight-mengshou",t.STYLESHEET_ID="highlight-mengshou-style",t.DATASET_IDENTIFIER="highlight-id",t.DATASET_IDENTIFIER_EXTRA="highlight-id-extra",t.DATASET_SPLIT_TYPE="highlight-split-type",t.CAMEL_DATASET_IDENTIFIER=a.default(t.DATASET_IDENTIFIER),t.CAMEL_DATASET_IDENTIFIER_EXTRA=a.default(t.DATASET_IDENTIFIER_EXTRA),t.CAMEL_DATASET_SPLIT_TYPE=a.default(t.DATASET_SPLIT_TYPE);t.getDefaultOptions=function(){return{$root:document||document.documentElement,exceptSelectors:null,wrapTag:"span",verbose:!1,style:{className:"highlight-mengshou-wrap"}}};t.getStylesheet=function(){return"\n    ."+t.getDefaultOptions().style.className+" {\n        background: #ff9;\n        cursor: pointer;\n    }\n    ."+t.getDefaultOptions().style.className+".active {\n        background: #ffb;\n    }\n"},t.ROOT_IDX=-2,t.UNKNOWN_IDX=-1,t.INTERNAL_ERROR_EVENT="error";var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(l.default);t.eventEmitter=new u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserInputEvent=t.SelectedNodeType=t.CreateFrom=t.EventType=t.ERROR=t.SplitType=void 0,function(e){e.none="none",e.head="head",e.tail="tail",e.both="both"}(t.SplitType||(t.SplitType={})),function(e){e.DOM_TYPE_ERROR="[DOM] Receive wrong node type.",e.DOM_SELECTION_EMPTY="[DOM] The selection contains no dom node, may be you except them.",e.RANGE_INVALID="[RANGE] Got invalid dom range, can't convert to a valid highlight range.",e.RANGE_NODE_INVALID="[RANGE] Start or end node isn't a text node, it may occur an error.",e.DB_ID_DUPLICATE_ERROR="[STORE] Unique id conflict.",e.CACHE_SET_ERROR="[CACHE] Cache.data can't be set manually, please use .save().",e.SOURCE_TYPE_ERROR="[SOURCE] Object isn't a highlight source instance.",e.HIGHLIGHT_RANGE_FROZEN="[HIGHLIGHT_RANGE] A highlight range must be frozen before render.",e.HIGHLIGHT_SOURCE_RECREATE="[HIGHLIGHT_SOURCE] Recreate highlights from sources error.",e.HIGHLIGHT_SOURCE_NONE_RENDER="[HIGHLIGHT_SOURCE] This highlight source isn't rendered. May be the exception skips it or the dom structure has changed."}(t.ERROR||(t.ERROR={})),function(e){e.CREATE="selection:create",e.REMOVE="selection:remove",e.MODIFY="selection:modify",e.HOVER="selection:hover",e.HOVER_OUT="selection:hover-out",e.CLICK="selection:click"}(t.EventType||(t.EventType={})),function(e){e.STORE="from-store",e.INPUT="from-input"}(t.CreateFrom||(t.CreateFrom={})),function(e){e.text="text",e.span="span"}(t.SelectedNodeType||(t.SelectedNodeType={})),function(e){e.touchend="touchend",e.mouseup="mouseup",e.touchstart="touchstart",e.click="click",e.mouseover="mouseover"}(t.UserInputEvent||(t.UserInputEvent={}))},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.handlersMap=Object.create(null)}return e.prototype.on=function(e,t){return this.handlersMap[e]||(this.handlersMap[e]=[]),this.handlersMap[e].push(t),this},e.prototype.off=function(e,t){return this.handlersMap[e]&&this.handlersMap[e].splice(this.handlersMap[e].indexOf(t)>>>0,1),this},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.handlersMap[e]&&this.handlersMap[e].slice().forEach((function(e){e.apply(void 0,o(t))})),this},e}();t.default=i},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(5)),i=n(9),a=function(){function e(e,t,n,r,o){this.startMeta=e,this.endMeta=t,this.text=n,this.id=r,this.__isHighlightSource={},o&&(this.extra=o)}return e.prototype.deSerialize=function(e,t){var n=i.queryElementNode(this,e),r=n.start,a=n.end,l=i.getTextChildByOffset(r,this.startMeta.textOffset),u=i.getTextChildByOffset(a,this.endMeta.textOffset);if(!t.Serialize.Restore.isEmpty()){var s=t.Serialize.Restore.call(this,l,u)||[];l=s[0]||l,u=s[1]||u}return new o.default(l,u,this.text,this.id,!0)},e}();t.default=a},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.hasClass=t.removeAllClass=t.removeClass=t.addClass=t.addEventListener=t.removeEventListener=t.forEach=t.getHighlightById=t.getHighlightsByRoot=t.getExtraHighlightId=t.getHighlightId=t.isHighlightWrapNode=void 0;var a=n(0);t.isHighlightWrapNode=function(e){return!!e.dataset&&!!e.dataset[a.CAMEL_DATASET_IDENTIFIER]};var l=function(e,n){for(var r=!1,o=null;e;){if(t.isHighlightWrapNode(e)&&(o=e),e===n){r=!0;break}e=e.parentNode}return r?o:null};t.getHighlightId=function(e,t){return(e=l(e,t))?e.dataset[a.CAMEL_DATASET_IDENTIFIER]:""};t.getExtraHighlightId=function(e,t){return(e=l(e,t))?e.dataset[a.CAMEL_DATASET_IDENTIFIER_EXTRA].split(a.ID_DIVISION).filter((function(e){return e})):[]};t.getHighlightsByRoot=function(e,t){var n,o;Array.isArray(e)||(e=[e]);var i=[];try{for(var l=r(e),u=l.next();!u.done;u=l.next()){var s=u.value.querySelectorAll(t+"[data-"+a.DATASET_IDENTIFIER+"]");i.push.apply(i,s)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}return i};t.getHighlightById=function(e,t,n){var o,i,l=[],u=new RegExp("("+t+"\\"+a.ID_DIVISION+"|\\"+a.ID_DIVISION+"?"+t+"$)"),s=e.querySelectorAll(n+"[data-"+a.DATASET_IDENTIFIER+"]");try{for(var d=r(s),c=d.next();!c.done;c=d.next()){var f=c.value;if(f.dataset[a.CAMEL_DATASET_IDENTIFIER]!==t){var h=f.dataset[a.CAMEL_DATASET_IDENTIFIER_EXTRA];u.test(h)&&l.push(f)}else l.push(f)}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}return l};t.forEach=function(e,t){for(var n=0;n<e.length;n++)t(e[n],n,e)};t.removeEventListener=function(e,t,n){e.removeEventListener(t,n)};t.addEventListener=function(e,n,r){return e.addEventListener(n,r),function(){t.removeEventListener(e,n,r)}};t.addClass=function(e,t){var n;Array.isArray(t)||(t=[t]),(n=e.classList).add.apply(n,i(t))};t.removeClass=function(e,t){e.classList.remove(t)};t.removeAllClass=function(e){e.className=""};t.hasClass=function(e,t){return e.classList.contains(t)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(3)),i=n(1),a=n(11),l=r(n(6)),u=n(12),s=n(0),d=function(){function e(e,t,n,r,o){void 0===o&&(o=!1),3===e.$node.nodeType&&3===t.$node.nodeType||s.eventEmitter.emit(s.INTERNAL_ERROR_EVENT,{type:i.ERROR.RANGE_NODE_INVALID}),this.start=u.formatDomNode(e),this.end=u.formatDomNode(t),this.text=n,this.frozen=o,this.id=r}return e.fromSelection=function(t){var n=a.getDomRange();if(!n)return null;var r={$node:n.startContainer,offset:n.startOffset},o={$node:n.endContainer,offset:n.endOffset},i=n.toString(),u=t.call(r,o,i);return new e(r,o,i,u=null!=u?u:l.default())},e.prototype.serialize=function(e,t){var n,r=u.getDomMeta(this.start.$node,this.start.offset,e),i=u.getDomMeta(this.end.$node,this.end.offset,e);return t.Serialize.RecordInfo.isEmpty()||(n=t.Serialize.RecordInfo.call(this.start,this.end,e)),this.frozen=!0,new o.default(r,i,this.text,this.id,n)},e.removeDomRange=a.removeSelection,e}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)}},function(e,t,n){e.exports=n(8)},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=a(n(2)),u=a(n(5)),s=a(n(3)),d=a(n(6)),c=a(n(13)),f=a(n(14)),h=a(n(16)),p=a(n(17)),E=n(0),_=n(1),v=n(4),T=function(e){function t(t){var n=e.call(this)||this;n.event=f.default(),n.run=function(){return v.addEventListener(n.options.$root,n.event.PointerEnd,n._handleSelection)},n.stop=function(){v.removeEventListener(n.options.$root,n.event.PointerEnd,n._handleSelection)},n.addClass=function(e,t){n.getDoms(t).forEach((function(t){v.addClass(t,e)}))},n.removeClass=function(e,t){n.getDoms(t).forEach((function(t){v.removeClass(t,e)}))},n.getIdByDom=function(e){return v.getHighlightId(e,n.options.$root)},n.getExtraIdByDom=function(e){return v.getExtraHighlightId(e,n.options.$root)},n.getDoms=function(e){return e?v.getHighlightById(n.options.$root,e,n.options.wrapTag):v.getHighlightsByRoot(n.options.$root,n.options.wrapTag)},n.dispose=function(){var e=n.options.$root;v.removeEventListener(e,n.event.PointerOver,n._handleHighlightHover),v.removeEventListener(e,n.event.PointerEnd,n._handleSelection),v.removeEventListener(e,n.event.PointerTap,n._handleHighlightClick),n.removeAll()},n.setOption=function(e){n.options=i(i({},n.options),e),n.painter=new p.default({$root:n.options.$root,wrapTag:n.options.wrapTag,className:n.options.style.className,exceptSelectors:n.options.exceptSelectors},n.hooks)},n.fromRange=function(e){var t={$node:e.startContainer,offset:e.startOffset},r={$node:e.endContainer,offset:e.endOffset},o=e.toString(),i=n.hooks.Render.UUID.call(t,r,o);i=null!=i?i:d.default();var a=new u.default(t,r,o,i);return a?n._highlightFromHRange(a):(E.eventEmitter.emit(E.INTERNAL_ERROR_EVENT,{type:_.ERROR.RANGE_INVALID}),null)},n.fromStore=function(e,t,r,o,i){var a=new s.default(e,t,r,o,i);try{return n._highlightFromHSource(a),a}catch(e){return E.eventEmitter.emit(E.INTERNAL_ERROR_EVENT,{type:_.ERROR.HIGHLIGHT_SOURCE_RECREATE,error:e,detail:a}),null}},n._getHooks=function(){return{Render:{UUID:new c.default("Render.UUID"),SelectedNodes:new c.default("Render.SelectedNodes"),WrapNode:new c.default("Render.WrapNode")},Serialize:{Restore:new c.default("Serialize.Restore"),RecordInfo:new c.default("Serialize.RecordInfo")},Remove:{UpdateNodes:new c.default("Remove.UpdateNodes")}}},n._highlightFromHRange=function(e){var t=e.serialize(n.options.$root,n.hooks);return 0===n.painter.highlightRange(e).length?(E.eventEmitter.emit(E.INTERNAL_ERROR_EVENT,{type:_.ERROR.DOM_SELECTION_EMPTY}),null):(n.cache.save(t),n.emit(_.EventType.CREATE,{sources:[t],type:_.CreateFrom.INPUT},n),t)},n._handleSelection=function(){var e=u.default.fromSelection(n.hooks.Render.UUID);e&&(n._highlightFromHRange(e),u.default.removeDomRange())},n._handleHighlightHover=function(e){var t=e.target;if(!v.isHighlightWrapNode(t))return n._hoverId&&n.emit(_.EventType.HOVER_OUT,{id:n._hoverId},n,e),void(n._hoverId=null);var r=v.getHighlightId(t,n.options.$root);n._hoverId!==r&&(n._hoverId&&n.emit(_.EventType.HOVER_OUT,{id:n._hoverId},n,e),n._hoverId=r,n.emit(_.EventType.HOVER,{id:n._hoverId},n,e))},n._handleError=function(e){n.options.verbose&&console.warn(e)},n._handleHighlightClick=function(e){var t=e.target;if(v.isHighlightWrapNode(t)){var r=v.getHighlightId(t,n.options.$root);n.emit(_.EventType.CLICK,{id:r},n,e)}},n.options=E.getDefaultOptions(),n.hooks=n._getHooks(),n.setOption(t),n.cache=new h.default;var r=n.options.$root;return v.addEventListener(r,n.event.PointerOver,n._handleHighlightHover),v.addEventListener(r,n.event.PointerTap,n._handleHighlightClick),E.eventEmitter.on(E.INTERNAL_ERROR_EVENT,n._handleError),n}return o(t,e),t.prototype.remove=function(e){if(e){var t=this.painter.removeHighlight(e);this.cache.remove(e),t&&this.emit(_.EventType.REMOVE,{ids:[e]},this)}},t.prototype.removeAll=function(){this.painter.removeAllHighlight();var e=this.cache.removeAll();this.emit(_.EventType.REMOVE,{ids:e},this)},t.prototype._highlightFromHSource=function(e){void 0===e&&(e=[]);var t=this.painter.highlightSource(e);this.emit(_.EventType.CREATE,{sources:t,type:_.CreateFrom.STORE},this),this.cache.save(e)},t.event=_.EventType,t.isHighlightWrapNode=v.isHighlightWrapNode,t.isHighlightSource=function(e){return!!e.__isHighlightSource},t}(l.default);t.default=T},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryElementNode=t.getTextChildByOffset=void 0;var r=n(0);t.getTextChildByOffset=function(e,t){for(var n=[e],r=null,o=0,i=0;r=n.pop();){for(var a=r.childNodes,l=a.length-1;l>=0;l--)n.push(a[l]);if(3===r.nodeType&&(i=t-o,(o+=r.textContent.length)>=t))break}return r||(r=e),{$node:r,offset:i}};t.queryElementNode=function(e,t){return{start:e.startMeta.parentIndex===r.ROOT_IDX?t:t.getElementsByTagName(e.startMeta.parentTagName)[e.startMeta.parentIndex],end:e.endMeta.parentIndex===r.ROOT_IDX?t:t.getElementsByTagName(e.endMeta.parentTagName)[e.endMeta.parentIndex]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.split("-").reduce((function(e,t,n){return e+(0===n?t:t[0].toUpperCase()+t.slice(1))}),"")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeSelection=t.getDomRange=void 0;t.getDomRange=function(){var e=window.getSelection();return e.isCollapsed?(console.debug("no text selected"),null):e.getRangeAt(0)};t.removeSelection=function(){window.getSelection().removeAllRanges()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatDomNode=t.getDomMeta=void 0;var r=n(0);t.getDomMeta=function(e,t,n){var o=function(e){if(e instanceof HTMLElement&&(!e.dataset||!e.dataset[r.CAMEL_DATASET_IDENTIFIER]))return e;for(var t=e.parentNode;null==t?void 0:t.dataset[r.CAMEL_DATASET_IDENTIFIER];)t=t.parentNode;return t}(e),i=o===n?r.ROOT_IDX:function(e,t){for(var n=e.tagName,o=t.getElementsByTagName(n),i=0;i<o.length;i++)if(e===o[i])return i;return r.UNKNOWN_IDX}(o,n),a=function(e,t){for(var n=[e],r=null,o=0;r=n.pop();){for(var i=r.childNodes,a=i.length-1;a>=0;a--)n.push(i[a]);if(3===r.nodeType&&r!==t)o+=r.textContent.length;else if(3===r.nodeType)break}return o}(o,e);return{parentTagName:o.tagName,parentIndex:i,textOffset:a+t}};t.formatDomNode=function(e){return 3===e.$node.nodeType||4===e.$node.nodeType||8===e.$node.nodeType?e:{$node:e.$node.childNodes[e.offset],offset:0}}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.name="",this.ops=[],this.name=e}return e.prototype.tap=function(e){var t=this;return-1===this.ops.indexOf(e)&&this.ops.push(e),function(){t.remove(e)}},e.prototype.remove=function(e){var t=this.ops.indexOf(e);t<0||this.ops.splice(t,1)},e.prototype.isEmpty=function(){return 0===this.ops.length},e.prototype.call=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.ops.forEach((function(n){e=n.apply(void 0,o(t))})),e},e}();t.default=i},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=r(n(15));t.default=function(){var e=i.default(window.navigator.userAgent);return{PointerEnd:e?o.UserInputEvent.touchend:o.UserInputEvent.mouseup,PointerTap:e?o.UserInputEvent.touchstart:o.UserInputEvent.click,PointerOver:e?o.UserInputEvent.touchstart:o.UserInputEvent.mouseover}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/Android|iPhone|BlackBerry|BB10|Opera Mini|Phone|Mobile|Silk|Windows Phone|Mobile(?:.+)Firefox\b/i;t.default=function(e){return r.test(e)}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=a(n(2)),u=n(1),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._data=new Map,t}return o(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.getAll()},set:function(e){throw u.ERROR.CACHE_SET_ERROR},enumerable:!1,configurable:!0}),t.prototype.save=function(e){var t=this;Array.isArray(e)?e.forEach((function(e){return t._data.set(e.id,e)})):this._data.set(e.id,e)},t.prototype.get=function(e){return this._data.get(e)},t.prototype.remove=function(e){this._data.delete(e)},t.prototype.getAll=function(){var e,t,n=[];try{for(var r=i(this._data),o=r.next();!o.done;o=r.next()){var a=o.value;n.push(a[1])}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},t.prototype.removeAll=function(){var e,t,n=[];try{for(var r=i(this._data),o=r.next();!o.done;o=r.next()){var a=o.value;n.push(a[0])}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return this._data=new Map,n},t}(l.default);t.default=s},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=a(n(3)),u=n(18),s=n(4),d=n(1),c=n(20),f=n(0),h=function(){function e(e,t){this.options={$root:e.$root,wrapTag:e.wrapTag,exceptSelectors:e.exceptSelectors,className:e.className},this.hooks=t,c.initDefaultStylesheet()}return e.prototype.highlightRange=function(e){var t=this;if(!e.frozen)throw d.ERROR.HIGHLIGHT_RANGE_FROZEN;var n=this.options,r=n.$root,o=n.className,i=n.exceptSelectors,a=this.hooks,l=u.getSelectedNodes(r,e.start,e.end,i);return a.Render.SelectedNodes.isEmpty()||(l=a.Render.SelectedNodes.call(e.id,l)||[]),l.map((function(n){var r=u.wrapHighlight(n,e,o,t.options.wrapTag);return a.Render.WrapNode.isEmpty()||(r=a.Render.WrapNode.call(e.id,r)),r}))},e.prototype.highlightSource=function(e){var t=this,n=Array.isArray(e)?e:[e],r=[];return n.forEach((function(e){if(e instanceof l.default){var n=e.deSerialize(t.options.$root,t.hooks);t.highlightRange(n).length>0?r.push(e):f.eventEmitter.emit(f.INTERNAL_ERROR_EVENT,{type:d.ERROR.HIGHLIGHT_SOURCE_NONE_RENDER,detail:e})}else f.eventEmitter.emit(f.INTERNAL_ERROR_EVENT,{type:d.ERROR.SOURCE_TYPE_ERROR})})),r},e.prototype.removeHighlight=function(e){var t,n,o=new RegExp("("+e+"\\"+f.ID_DIVISION+"|\\"+f.ID_DIVISION+"?"+e+"$)"),a=this.hooks,l=this.options.wrapTag,d=document.querySelectorAll(l+"[data-"+f.DATASET_IDENTIFIER+"]"),c=[],h=[],p=[];try{for(var E=r(d),_=E.next();!_.done;_=E.next()){var v=_.value,T=v.dataset[f.CAMEL_DATASET_IDENTIFIER],y=v.dataset[f.CAMEL_DATASET_IDENTIFIER_EXTRA];T!==e||y?T===e?h.push(v):T!==e&&o.test(y)&&p.push(v):c.push(v)}}catch(e){t={error:e}}finally{try{_&&!_.done&&(n=E.return)&&n.call(E)}finally{if(t)throw t.error}}return c.forEach((function(t){var n=t.parentNode,r=document.createDocumentFragment();s.forEach(t.childNodes,(function(e){return r.appendChild(e.cloneNode(!1))}));var o=t.previousSibling,i=t.nextSibling;n.replaceChild(r,t),u.normalizeSiblingText(o,!0),u.normalizeSiblingText(i,!1),a.Remove.UpdateNodes.call(e,t,"remove")})),h.forEach((function(t){var n=t.dataset,r=n[f.CAMEL_DATASET_IDENTIFIER_EXTRA].split(f.ID_DIVISION),o=r.shift(),u=document.querySelector(l+"[data-"+f.DATASET_IDENTIFIER+'="'+o+'"]');u&&(s.removeAllClass(t),s.addClass(t,i(u.classList))),n[f.CAMEL_DATASET_IDENTIFIER]=o,n[f.CAMEL_DATASET_IDENTIFIER_EXTRA]=r.join(f.ID_DIVISION),a.Remove.UpdateNodes.call(e,t,"id-update")})),p.forEach((function(t){var n=t.dataset[f.CAMEL_DATASET_IDENTIFIER_EXTRA];t.dataset[f.CAMEL_DATASET_IDENTIFIER_EXTRA]=n.replace(o,""),a.Remove.UpdateNodes.call(e,t,"extra-update")})),c.length+h.length+p.length!==0},e.prototype.removeAllHighlight=function(){var e=this.options,t=e.wrapTag,n=e.$root;s.getHighlightsByRoot(n,t).forEach((function(e){var t=e.parentNode,n=document.createDocumentFragment();s.forEach(e.childNodes,(function(e){return n.appendChild(e.cloneNode(!1))})),t.replaceChild(n,e)}))},e}();t.default=h},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeSiblingText=t.wrapHighlight=t.getSelectedNodes=void 0;var i=n(1),a=n(4),l=n(0),u=n(19),s=function(e,t){if(!e)return!1;if(/^\./.test(t)){var n=t.replace(/^\./,"");return e&&a.hasClass(e,n)}if(/^#/.test(t)){var r=t.replace(/^#/,"");return e&&e.id===r}var o=t.toUpperCase();return e&&e.tagName===o};t.getSelectedNodes=function(e,t,n,r){var o=t.$node,a=n.$node,l=t.offset,u=n.offset;if(o===a&&o instanceof Text)return function(e,t,n,r){for(var o=e,a=function(e){return null==r?void 0:r.some((function(t){return s(e,t)}))};o;){if(1===o.nodeType&&a(o))return[];o=o.parentNode}e.splitText(t);var l=e.nextSibling;return l.splitText(n-t),[{$node:l,type:i.SelectedNodeType.text,splitType:i.SplitType.both}]}(o,l,u,r);for(var d=[e],c=[],f=function(e){return null==r?void 0:r.some((function(t){return s(e,t)}))},h=!1,p=null;p=d.pop();)if(1!==p.nodeType||!f(p)){for(var E=p.childNodes,_=E.length-1;_>=0;_--)d.push(E[_]);if(p===o){if(3===p.nodeType){p.splitText(l);var v=p.nextSibling;c.push({$node:v,type:i.SelectedNodeType.text,splitType:i.SplitType.head})}h=!0}else{if(p===a){if(3===p.nodeType)(v=p).splitText(u),c.push({$node:v,type:i.SelectedNodeType.text,splitType:i.SplitType.tail});break}h&&3===p.nodeType&&c.push({$node:p,type:i.SelectedNodeType.text,splitType:i.SplitType.none})}}return c};var d=function(e,t){var n=Array.isArray(t)?t:[t];return(n=0===n.length?[l.getDefaultOptions().style.className]:n).forEach((function(t){a.addClass(e,t)})),e},c=function(e){return!e||!e.textContent};t.wrapHighlight=function(e,t,n,r){var s=e.$node.parentNode,f=e.$node.previousSibling,h=e.$node.nextSibling;return a.isHighlightWrapNode(s)?!a.isHighlightWrapNode(s)||c(f)&&c(h)?function(e,t,n){var r=e.$node.parentNode,o=r;a.removeAllClass(o),d(o,n);var i=r.dataset,u=i[l.CAMEL_DATASET_IDENTIFIER];return i[l.CAMEL_DATASET_IDENTIFIER]=t.id,i[l.CAMEL_DATASET_IDENTIFIER_EXTRA]=i[l.CAMEL_DATASET_IDENTIFIER_EXTRA]?u+l.ID_DIVISION+i[l.CAMEL_DATASET_IDENTIFIER_EXTRA]:u,o}(e,t,n):function(e,t,n,r){var a=document.createElement(r),s=e.$node.parentNode,c=e.$node.previousSibling,f=e.$node.nextSibling,h=document.createDocumentFragment(),p=s.dataset[l.CAMEL_DATASET_IDENTIFIER],E=s.dataset[l.CAMEL_DATASET_IDENTIFIER_EXTRA],_=E?p+l.ID_DIVISION+E:p;a.setAttribute("data-"+l.DATASET_IDENTIFIER,t.id),a.setAttribute("data-"+l.DATASET_IDENTIFIER_EXTRA,_),a.appendChild(e.$node.cloneNode(!1));var v,T=!1,y=!1;c&&((g=s.cloneNode(!1)).textContent=c.textContent,h.appendChild(g),T=!0);var g,I=[];(Array.isArray(n)?I.push.apply(I,o(n)):I.push(n),d(a,u.unique(I)),h.appendChild(a),f)&&((g=s.cloneNode(!1)).textContent=f.textContent,h.appendChild(g),y=!0);return v=T&&y?i.SplitType.both:T?i.SplitType.head:y?i.SplitType.tail:i.SplitType.none,a.setAttribute("data-"+l.DATASET_SPLIT_TYPE,v),s.parentNode.replaceChild(h,s),a}(e,t,n,r):function(e,t,n,r){var o=document.createElement(r);return d(o,n),o.appendChild(e.$node.cloneNode(!1)),e.$node.parentNode.replaceChild(o,e.$node),o.setAttribute("data-"+l.DATASET_IDENTIFIER,t.id),o.setAttribute("data-"+l.DATASET_SPLIT_TYPE,e.splitType),o.setAttribute("data-"+l.DATASET_IDENTIFIER_EXTRA,""),o}(e,t,n,r)};t.normalizeSiblingText=function(e,t){if(void 0===t&&(t=!0),e&&3===e.nodeType){var n=t?e.nextSibling:e.previousSibling;if(3===n.nodeType){var r=n.nodeValue;e.nodeValue=t?e.nodeValue+r:r+e.nodeValue,n.parentNode.removeChild(n)}}}},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.unique=void 0;t.unique=function(e){var t,n,o=[];try{for(var i=r(e),a=i.next();!a.done;a=i.next()){var l=a.value;-1===o.indexOf(l)&&o.push(l)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initDefaultStylesheet=void 0;var r=n(0);t.initDefaultStylesheet=function(){var e=r.STYLESHEET_ID,t=document.getElementById(e);if(!t){var n=document.createTextNode(r.getStylesheet());(t=document.createElement("style")).id=e,t.appendChild(n),document.head.appendChild(t)}return t}}]).default}));

},{}],15:[function(require,module,exports){
/**
 * default settings
 *
 * @author Zongmin Lei<leizongmin@gmail.com>
 */

var FilterCSS = require("cssfilter").FilterCSS;
var getDefaultCSSWhiteList = require("cssfilter").getDefaultWhiteList;
var _ = require("./util");

function getDefaultWhiteList() {
  return {
    a: ["target", "href", "title"],
    abbr: ["title"],
    address: [],
    area: ["shape", "coords", "href", "alt"],
    article: [],
    aside: [],
    audio: [
      "autoplay",
      "controls",
      "crossorigin",
      "loop",
      "muted",
      "preload",
      "src",
    ],
    b: [],
    bdi: ["dir"],
    bdo: ["dir"],
    big: [],
    blockquote: ["cite"],
    br: [],
    caption: [],
    center: [],
    cite: [],
    code: [],
    col: ["align", "valign", "span", "width"],
    colgroup: ["align", "valign", "span", "width"],
    dd: [],
    del: ["datetime"],
    details: ["open"],
    div: [],
    dl: [],
    dt: [],
    em: [],
    figcaption: [],
    figure: [],
    font: ["color", "size", "face"],
    footer: [],
    h1: [],
    h2: [],
    h3: [],
    h4: [],
    h5: [],
    h6: [],
    header: [],
    hr: [],
    i: [],
    img: ["src", "alt", "title", "width", "height"],
    ins: ["datetime"],
    li: [],
    mark: [],
    nav: [],
    ol: [],
    p: [],
    pre: [],
    s: [],
    section: [],
    small: [],
    span: [],
    sub: [],
    summary: [],
    sup: [],
    strong: [],
    strike: [],
    table: ["width", "border", "align", "valign"],
    tbody: ["align", "valign"],
    td: ["width", "rowspan", "colspan", "align", "valign"],
    tfoot: ["align", "valign"],
    th: ["width", "rowspan", "colspan", "align", "valign"],
    thead: ["align", "valign"],
    tr: ["rowspan", "align", "valign"],
    tt: [],
    u: [],
    ul: [],
    video: [
      "autoplay",
      "controls",
      "crossorigin",
      "loop",
      "muted",
      "playsinline",
      "poster",
      "preload",
      "src",
      "height",
      "width",
    ],
  };
}

var defaultCSSFilter = new FilterCSS();

/**
 * default onTag function
 *
 * @param {String} tag
 * @param {String} html
 * @param {Object} options
 * @return {String}
 */
function onTag(tag, html, options) {
  // do nothing
}

/**
 * default onIgnoreTag function
 *
 * @param {String} tag
 * @param {String} html
 * @param {Object} options
 * @return {String}
 */
function onIgnoreTag(tag, html, options) {
  // do nothing
}

/**
 * default onTagAttr function
 *
 * @param {String} tag
 * @param {String} name
 * @param {String} value
 * @return {String}
 */
function onTagAttr(tag, name, value) {
  // do nothing
}

/**
 * default onIgnoreTagAttr function
 *
 * @param {String} tag
 * @param {String} name
 * @param {String} value
 * @return {String}
 */
function onIgnoreTagAttr(tag, name, value) {
  // do nothing
}

/**
 * default escapeHtml function
 *
 * @param {String} html
 */
function escapeHtml(html) {
  return html.replace(REGEXP_LT, "&lt;").replace(REGEXP_GT, "&gt;");
}

/**
 * default safeAttrValue function
 *
 * @param {String} tag
 * @param {String} name
 * @param {String} value
 * @param {Object} cssFilter
 * @return {String}
 */
function safeAttrValue(tag, name, value, cssFilter) {
  // unescape attribute value firstly
  value = friendlyAttrValue(value);

  if (name === "href" || name === "src") {
    // filter `href` and `src` attribute
    // only allow the value that starts with `http://` | `https://` | `mailto:` | `/` | `#`
    value = _.trim(value);
    if (value === "#") return "#";
    if (
      !(
        value.substr(0, 7) === "http://" ||
        value.substr(0, 8) === "https://" ||
        value.substr(0, 7) === "mailto:" ||
        value.substr(0, 4) === "tel:" ||
        value.substr(0, 11) === "data:image/" ||
        value.substr(0, 6) === "ftp://" ||
        value.substr(0, 2) === "./" ||
        value.substr(0, 3) === "../" ||
        value[0] === "#" ||
        value[0] === "/"
      )
    ) {
      return "";
    }
  } else if (name === "background") {
    // filter `background` attribute (maybe no use)
    // `javascript:`
    REGEXP_DEFAULT_ON_TAG_ATTR_4.lastIndex = 0;
    if (REGEXP_DEFAULT_ON_TAG_ATTR_4.test(value)) {
      return "";
    }
  } else if (name === "style") {
    // `expression()`
    REGEXP_DEFAULT_ON_TAG_ATTR_7.lastIndex = 0;
    if (REGEXP_DEFAULT_ON_TAG_ATTR_7.test(value)) {
      return "";
    }
    // `url()`
    REGEXP_DEFAULT_ON_TAG_ATTR_8.lastIndex = 0;
    if (REGEXP_DEFAULT_ON_TAG_ATTR_8.test(value)) {
      REGEXP_DEFAULT_ON_TAG_ATTR_4.lastIndex = 0;
      if (REGEXP_DEFAULT_ON_TAG_ATTR_4.test(value)) {
        return "";
      }
    }
    if (cssFilter !== false) {
      cssFilter = cssFilter || defaultCSSFilter;
      value = cssFilter.process(value);
    }
  }

  // escape `<>"` before returns
  value = escapeAttrValue(value);
  return value;
}

// RegExp list
var REGEXP_LT = /</g;
var REGEXP_GT = />/g;
var REGEXP_QUOTE = /"/g;
var REGEXP_QUOTE_2 = /&quot;/g;
var REGEXP_ATTR_VALUE_1 = /&#([a-zA-Z0-9]*);?/gim;
var REGEXP_ATTR_VALUE_COLON = /&colon;?/gim;
var REGEXP_ATTR_VALUE_NEWLINE = /&newline;?/gim;
// var REGEXP_DEFAULT_ON_TAG_ATTR_3 = /\/\*|\*\//gm;
var REGEXP_DEFAULT_ON_TAG_ATTR_4 =
  /((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi;
// var REGEXP_DEFAULT_ON_TAG_ATTR_5 = /^[\s"'`]*(d\s*a\s*t\s*a\s*)\:/gi;
// var REGEXP_DEFAULT_ON_TAG_ATTR_6 = /^[\s"'`]*(d\s*a\s*t\s*a\s*)\:\s*image\//gi;
var REGEXP_DEFAULT_ON_TAG_ATTR_7 =
  /e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi;
var REGEXP_DEFAULT_ON_TAG_ATTR_8 = /u\s*r\s*l\s*\(.*/gi;

/**
 * escape double quote
 *
 * @param {String} str
 * @return {String} str
 */
function escapeQuote(str) {
  return str.replace(REGEXP_QUOTE, "&quot;");
}

/**
 * unescape double quote
 *
 * @param {String} str
 * @return {String} str
 */
function unescapeQuote(str) {
  return str.replace(REGEXP_QUOTE_2, '"');
}

/**
 * escape html entities
 *
 * @param {String} str
 * @return {String}
 */
function escapeHtmlEntities(str) {
  return str.replace(REGEXP_ATTR_VALUE_1, function replaceUnicode(str, code) {
    return code[0] === "x" || code[0] === "X"
      ? String.fromCharCode(parseInt(code.substr(1), 16))
      : String.fromCharCode(parseInt(code, 10));
  });
}

/**
 * escape html5 new danger entities
 *
 * @param {String} str
 * @return {String}
 */
function escapeDangerHtml5Entities(str) {
  return str
    .replace(REGEXP_ATTR_VALUE_COLON, ":")
    .replace(REGEXP_ATTR_VALUE_NEWLINE, " ");
}

/**
 * clear nonprintable characters
 *
 * @param {String} str
 * @return {String}
 */
function clearNonPrintableCharacter(str) {
  var str2 = "";
  for (var i = 0, len = str.length; i < len; i++) {
    str2 += str.charCodeAt(i) < 32 ? " " : str.charAt(i);
  }
  return _.trim(str2);
}

/**
 * get friendly attribute value
 *
 * @param {String} str
 * @return {String}
 */
function friendlyAttrValue(str) {
  str = unescapeQuote(str);
  str = escapeHtmlEntities(str);
  str = escapeDangerHtml5Entities(str);
  str = clearNonPrintableCharacter(str);
  return str;
}

/**
 * unescape attribute value
 *
 * @param {String} str
 * @return {String}
 */
function escapeAttrValue(str) {
  str = escapeQuote(str);
  str = escapeHtml(str);
  return str;
}

/**
 * `onIgnoreTag` function for removing all the tags that are not in whitelist
 */
function onIgnoreTagStripAll() {
  return "";
}

/**
 * remove tag body
 * specify a `tags` list, if the tag is not in the `tags` list then process by the specify function (optional)
 *
 * @param {array} tags
 * @param {function} next
 */
function StripTagBody(tags, next) {
  if (typeof next !== "function") {
    next = function () {};
  }

  var isRemoveAllTag = !Array.isArray(tags);
  function isRemoveTag(tag) {
    if (isRemoveAllTag) return true;
    return _.indexOf(tags, tag) !== -1;
  }

  var removeList = [];
  var posStart = false;

  return {
    onIgnoreTag: function (tag, html, options) {
      if (isRemoveTag(tag)) {
        if (options.isClosing) {
          var ret = "[/removed]";
          var end = options.position + ret.length;
          removeList.push([
            posStart !== false ? posStart : options.position,
            end,
          ]);
          posStart = false;
          return ret;
        } else {
          if (!posStart) {
            posStart = options.position;
          }
          return "[removed]";
        }
      } else {
        return next(tag, html, options);
      }
    },
    remove: function (html) {
      var rethtml = "";
      var lastPos = 0;
      _.forEach(removeList, function (pos) {
        rethtml += html.slice(lastPos, pos[0]);
        lastPos = pos[1];
      });
      rethtml += html.slice(lastPos);
      return rethtml;
    },
  };
}

/**
 * remove html comments
 *
 * @param {String} html
 * @return {String}
 */
function stripCommentTag(html) {
  var retHtml = "";
  var lastPos = 0;
  while (lastPos < html.length) {
    var i = html.indexOf("<!--", lastPos);
    if (i === -1) {
      retHtml += html.slice(lastPos);
      break;
    }
    retHtml += html.slice(lastPos, i);
    var j = html.indexOf("-->", i);
    if (j === -1) {
      break;
    }
    lastPos = j + 3;
  }
  return retHtml;
}

/**
 * remove invisible characters
 *
 * @param {String} html
 * @return {String}
 */
function stripBlankChar(html) {
  var chars = html.split("");
  chars = chars.filter(function (char) {
    var c = char.charCodeAt(0);
    if (c === 127) return false;
    if (c <= 31) {
      if (c === 10 || c === 13) return true;
      return false;
    }
    return true;
  });
  return chars.join("");
}

exports.whiteList = getDefaultWhiteList();
exports.getDefaultWhiteList = getDefaultWhiteList;
exports.onTag = onTag;
exports.onIgnoreTag = onIgnoreTag;
exports.onTagAttr = onTagAttr;
exports.onIgnoreTagAttr = onIgnoreTagAttr;
exports.safeAttrValue = safeAttrValue;
exports.escapeHtml = escapeHtml;
exports.escapeQuote = escapeQuote;
exports.unescapeQuote = unescapeQuote;
exports.escapeHtmlEntities = escapeHtmlEntities;
exports.escapeDangerHtml5Entities = escapeDangerHtml5Entities;
exports.clearNonPrintableCharacter = clearNonPrintableCharacter;
exports.friendlyAttrValue = friendlyAttrValue;
exports.escapeAttrValue = escapeAttrValue;
exports.onIgnoreTagStripAll = onIgnoreTagStripAll;
exports.StripTagBody = StripTagBody;
exports.stripCommentTag = stripCommentTag;
exports.stripBlankChar = stripBlankChar;
exports.cssFilter = defaultCSSFilter;
exports.getDefaultCSSWhiteList = getDefaultCSSWhiteList;

},{"./util":18,"cssfilter":11}],16:[function(require,module,exports){
/**
 * xss
 *
 * @author Zongmin Lei<leizongmin@gmail.com>
 */

var DEFAULT = require("./default");
var parser = require("./parser");
var FilterXSS = require("./xss");

/**
 * filter xss function
 *
 * @param {String} html
 * @param {Object} options { whiteList, onTag, onTagAttr, onIgnoreTag, onIgnoreTagAttr, safeAttrValue, escapeHtml }
 * @return {String}
 */
function filterXSS(html, options) {
  var xss = new FilterXSS(options);
  return xss.process(html);
}

exports = module.exports = filterXSS;
exports.filterXSS = filterXSS;
exports.FilterXSS = FilterXSS;

(function () {
  for (var i in DEFAULT) {
    exports[i] = DEFAULT[i];
  }
  for (var j in parser) {
    exports[j] = parser[j];
  }
})();

// using `xss` on the browser, output `filterXSS` to the globals
if (typeof window !== "undefined") {
  window.filterXSS = module.exports;
}

// using `xss` on the WebWorker, output `filterXSS` to the globals
function isWorkerEnv() {
  return (
    typeof self !== "undefined" &&
    typeof DedicatedWorkerGlobalScope !== "undefined" &&
    self instanceof DedicatedWorkerGlobalScope
  );
}
if (isWorkerEnv()) {
  self.filterXSS = module.exports;
}

},{"./default":15,"./parser":17,"./xss":19}],17:[function(require,module,exports){
/**
 * Simple HTML Parser
 *
 * @author Zongmin Lei<leizongmin@gmail.com>
 */

var _ = require("./util");

/**
 * get tag name
 *
 * @param {String} html e.g. '<a hef="#">'
 * @return {String}
 */
function getTagName(html) {
  var i = _.spaceIndex(html);
  var tagName;
  if (i === -1) {
    tagName = html.slice(1, -1);
  } else {
    tagName = html.slice(1, i + 1);
  }
  tagName = _.trim(tagName).toLowerCase();
  if (tagName.slice(0, 1) === "/") tagName = tagName.slice(1);
  if (tagName.slice(-1) === "/") tagName = tagName.slice(0, -1);
  return tagName;
}

/**
 * is close tag?
 *
 * @param {String} html 如：'<a hef="#">'
 * @return {Boolean}
 */
function isClosing(html) {
  return html.slice(0, 2) === "</";
}

/**
 * parse input html and returns processed html
 *
 * @param {String} html
 * @param {Function} onTag e.g. function (sourcePosition, position, tag, html, isClosing)
 * @param {Function} escapeHtml
 * @return {String}
 */
function parseTag(html, onTag, escapeHtml) {
  "use strict";

  var rethtml = "";
  var lastPos = 0;
  var tagStart = false;
  var quoteStart = false;
  var currentPos = 0;
  var len = html.length;
  var currentTagName = "";
  var currentHtml = "";

  chariterator: for (currentPos = 0; currentPos < len; currentPos++) {
    var c = html.charAt(currentPos);
    if (tagStart === false) {
      if (c === "<") {
        tagStart = currentPos;
        continue;
      }
    } else {
      if (quoteStart === false) {
        if (c === "<") {
          rethtml += escapeHtml(html.slice(lastPos, currentPos));
          tagStart = currentPos;
          lastPos = currentPos;
          continue;
        }
        if (c === ">" || currentPos === len - 1) {
          rethtml += escapeHtml(html.slice(lastPos, tagStart));
          currentHtml = html.slice(tagStart, currentPos + 1);
          currentTagName = getTagName(currentHtml);
          rethtml += onTag(
            tagStart,
            rethtml.length,
            currentTagName,
            currentHtml,
            isClosing(currentHtml)
          );
          lastPos = currentPos + 1;
          tagStart = false;
          continue;
        }
        if (c === '"' || c === "'") {
          var i = 1;
          var ic = html.charAt(currentPos - i);

          while (ic.trim() === "" || ic === "=") {
            if (ic === "=") {
              quoteStart = c;
              continue chariterator;
            }
            ic = html.charAt(currentPos - ++i);
          }
        }
      } else {
        if (c === quoteStart) {
          quoteStart = false;
          continue;
        }
      }
    }
  }
  if (lastPos < len) {
    rethtml += escapeHtml(html.substr(lastPos));
  }

  return rethtml;
}

var REGEXP_ILLEGAL_ATTR_NAME = /[^a-zA-Z0-9\\_:.-]/gim;

/**
 * parse input attributes and returns processed attributes
 *
 * @param {String} html e.g. `href="#" target="_blank"`
 * @param {Function} onAttr e.g. `function (name, value)`
 * @return {String}
 */
function parseAttr(html, onAttr) {
  "use strict";

  var lastPos = 0;
  var lastMarkPos = 0;
  var retAttrs = [];
  var tmpName = false;
  var len = html.length;

  function addAttr(name, value) {
    name = _.trim(name);
    name = name.replace(REGEXP_ILLEGAL_ATTR_NAME, "").toLowerCase();
    if (name.length < 1) return;
    var ret = onAttr(name, value || "");
    if (ret) retAttrs.push(ret);
  }

  // 逐个分析字符
  for (var i = 0; i < len; i++) {
    var c = html.charAt(i);
    var v, j;
    if (tmpName === false && c === "=") {
      tmpName = html.slice(lastPos, i);
      lastPos = i + 1;
      lastMarkPos = html.charAt(lastPos) === '"' || html.charAt(lastPos) === "'" ? lastPos : findNextQuotationMark(html, i + 1);
      continue;
    }
    if (tmpName !== false) {
      if (
        i === lastMarkPos
      ) {
        j = html.indexOf(c, i + 1);
        if (j === -1) {
          break;
        } else {
          v = _.trim(html.slice(lastMarkPos + 1, j));
          addAttr(tmpName, v);
          tmpName = false;
          i = j;
          lastPos = i + 1;
          continue;
        }
      }
    }
    if (/\s|\n|\t/.test(c)) {
      html = html.replace(/\s|\n|\t/g, " ");
      if (tmpName === false) {
        j = findNextEqual(html, i);
        if (j === -1) {
          v = _.trim(html.slice(lastPos, i));
          addAttr(v);
          tmpName = false;
          lastPos = i + 1;
          continue;
        } else {
          i = j - 1;
          continue;
        }
      } else {
        j = findBeforeEqual(html, i - 1);
        if (j === -1) {
          v = _.trim(html.slice(lastPos, i));
          v = stripQuoteWrap(v);
          addAttr(tmpName, v);
          tmpName = false;
          lastPos = i + 1;
          continue;
        } else {
          continue;
        }
      }
    }
  }

  if (lastPos < html.length) {
    if (tmpName === false) {
      addAttr(html.slice(lastPos));
    } else {
      addAttr(tmpName, stripQuoteWrap(_.trim(html.slice(lastPos))));
    }
  }

  return _.trim(retAttrs.join(" "));
}

function findNextEqual(str, i) {
  for (; i < str.length; i++) {
    var c = str[i];
    if (c === " ") continue;
    if (c === "=") return i;
    return -1;
  }
}

function findNextQuotationMark(str, i) {
  for (; i < str.length; i++) {
    var c = str[i];
    if (c === " ") continue;
    if (c === "'" || c === '"') return i;
    return -1;
  }
}

function findBeforeEqual(str, i) {
  for (; i > 0; i--) {
    var c = str[i];
    if (c === " ") continue;
    if (c === "=") return i;
    return -1;
  }
}

function isQuoteWrapString(text) {
  if (
    (text[0] === '"' && text[text.length - 1] === '"') ||
    (text[0] === "'" && text[text.length - 1] === "'")
  ) {
    return true;
  } else {
    return false;
  }
}

function stripQuoteWrap(text) {
  if (isQuoteWrapString(text)) {
    return text.substr(1, text.length - 2);
  } else {
    return text;
  }
}

exports.parseTag = parseTag;
exports.parseAttr = parseAttr;

},{"./util":18}],18:[function(require,module,exports){
module.exports = {
  indexOf: function (arr, item) {
    var i, j;
    if (Array.prototype.indexOf) {
      return arr.indexOf(item);
    }
    for (i = 0, j = arr.length; i < j; i++) {
      if (arr[i] === item) {
        return i;
      }
    }
    return -1;
  },
  forEach: function (arr, fn, scope) {
    var i, j;
    if (Array.prototype.forEach) {
      return arr.forEach(fn, scope);
    }
    for (i = 0, j = arr.length; i < j; i++) {
      fn.call(scope, arr[i], i, arr);
    }
  },
  trim: function (str) {
    if (String.prototype.trim) {
      return str.trim();
    }
    return str.replace(/(^\s*)|(\s*$)/g, "");
  },
  spaceIndex: function (str) {
    var reg = /\s|\n|\t/;
    var match = reg.exec(str);
    return match ? match.index : -1;
  },
};

},{}],19:[function(require,module,exports){
/**
 * filter xss
 *
 * @author Zongmin Lei<leizongmin@gmail.com>
 */

var FilterCSS = require("cssfilter").FilterCSS;
var DEFAULT = require("./default");
var parser = require("./parser");
var parseTag = parser.parseTag;
var parseAttr = parser.parseAttr;
var _ = require("./util");

/**
 * returns `true` if the input value is `undefined` or `null`
 *
 * @param {Object} obj
 * @return {Boolean}
 */
function isNull(obj) {
  return obj === undefined || obj === null;
}

/**
 * get attributes for a tag
 *
 * @param {String} html
 * @return {Object}
 *   - {String} html
 *   - {Boolean} closing
 */
function getAttrs(html) {
  var i = _.spaceIndex(html);
  if (i === -1) {
    return {
      html: "",
      closing: html[html.length - 2] === "/",
    };
  }
  html = _.trim(html.slice(i + 1, -1));
  var isClosing = html[html.length - 1] === "/";
  if (isClosing) html = _.trim(html.slice(0, -1));
  return {
    html: html,
    closing: isClosing,
  };
}

/**
 * shallow copy
 *
 * @param {Object} obj
 * @return {Object}
 */
function shallowCopyObject(obj) {
  var ret = {};
  for (var i in obj) {
    ret[i] = obj[i];
  }
  return ret;
}

function keysToLowerCase(obj) {
  var ret = {};
  for (var i in obj) {
    if (Array.isArray(obj[i])) {
      ret[i.toLowerCase()] = obj[i].map(function (item) {
        return item.toLowerCase();
      });
    } else {
      ret[i.toLowerCase()] = obj[i];
    }
  }
  return ret;
}

/**
 * FilterXSS class
 *
 * @param {Object} options
 *        whiteList (or allowList), onTag, onTagAttr, onIgnoreTag,
 *        onIgnoreTagAttr, safeAttrValue, escapeHtml
 *        stripIgnoreTagBody, allowCommentTag, stripBlankChar
 *        css{whiteList, onAttr, onIgnoreAttr} `css=false` means don't use `cssfilter`
 */
function FilterXSS(options) {
  options = shallowCopyObject(options || {});

  if (options.stripIgnoreTag) {
    if (options.onIgnoreTag) {
      console.error(
        'Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'
      );
    }
    options.onIgnoreTag = DEFAULT.onIgnoreTagStripAll;
  }
  if (options.whiteList || options.allowList) {
    options.whiteList = keysToLowerCase(options.whiteList || options.allowList);
  } else {
    options.whiteList = DEFAULT.whiteList;
  }

  options.onTag = options.onTag || DEFAULT.onTag;
  options.onTagAttr = options.onTagAttr || DEFAULT.onTagAttr;
  options.onIgnoreTag = options.onIgnoreTag || DEFAULT.onIgnoreTag;
  options.onIgnoreTagAttr = options.onIgnoreTagAttr || DEFAULT.onIgnoreTagAttr;
  options.safeAttrValue = options.safeAttrValue || DEFAULT.safeAttrValue;
  options.escapeHtml = options.escapeHtml || DEFAULT.escapeHtml;
  this.options = options;

  if (options.css === false) {
    this.cssFilter = false;
  } else {
    options.css = options.css || {};
    this.cssFilter = new FilterCSS(options.css);
  }
}

/**
 * start process and returns result
 *
 * @param {String} html
 * @return {String}
 */
FilterXSS.prototype.process = function (html) {
  // compatible with the input
  html = html || "";
  html = html.toString();
  if (!html) return "";

  var me = this;
  var options = me.options;
  var whiteList = options.whiteList;
  var onTag = options.onTag;
  var onIgnoreTag = options.onIgnoreTag;
  var onTagAttr = options.onTagAttr;
  var onIgnoreTagAttr = options.onIgnoreTagAttr;
  var safeAttrValue = options.safeAttrValue;
  var escapeHtml = options.escapeHtml;
  var cssFilter = me.cssFilter;

  // remove invisible characters
  if (options.stripBlankChar) {
    html = DEFAULT.stripBlankChar(html);
  }

  // remove html comments
  if (!options.allowCommentTag) {
    html = DEFAULT.stripCommentTag(html);
  }

  // if enable stripIgnoreTagBody
  var stripIgnoreTagBody = false;
  if (options.stripIgnoreTagBody) {
    stripIgnoreTagBody = DEFAULT.StripTagBody(
      options.stripIgnoreTagBody,
      onIgnoreTag
    );
    onIgnoreTag = stripIgnoreTagBody.onIgnoreTag;
  }

  var retHtml = parseTag(
    html,
    function (sourcePosition, position, tag, html, isClosing) {
      var info = {
        sourcePosition: sourcePosition,
        position: position,
        isClosing: isClosing,
        isWhite: Object.prototype.hasOwnProperty.call(whiteList, tag),
      };

      // call `onTag()`
      var ret = onTag(tag, html, info);
      if (!isNull(ret)) return ret;

      if (info.isWhite) {
        if (info.isClosing) {
          return "</" + tag + ">";
        }

        var attrs = getAttrs(html);
        var whiteAttrList = whiteList[tag];
        var attrsHtml = parseAttr(attrs.html, function (name, value) {
          // call `onTagAttr()`
          var isWhiteAttr = _.indexOf(whiteAttrList, name) !== -1;
          var ret = onTagAttr(tag, name, value, isWhiteAttr);
          if (!isNull(ret)) return ret;

          if (isWhiteAttr) {
            // call `safeAttrValue()`
            value = safeAttrValue(tag, name, value, cssFilter);
            if (value) {
              return name + '="' + value + '"';
            } else {
              return name;
            }
          } else {
            // call `onIgnoreTagAttr()`
            ret = onIgnoreTagAttr(tag, name, value, isWhiteAttr);
            if (!isNull(ret)) return ret;
            return;
          }
        });

        // build new tag html
        html = "<" + tag;
        if (attrsHtml) html += " " + attrsHtml;
        if (attrs.closing) html += " /";
        html += ">";
        return html;
      } else {
        // call `onIgnoreTag()`
        ret = onIgnoreTag(tag, html, info);
        if (!isNull(ret)) return ret;
        return escapeHtml(html);
      }
    },
    escapeHtml
  );

  // if enable stripIgnoreTagBody
  if (stripIgnoreTagBody) {
    retHtml = stripIgnoreTagBody.remove(retHtml);
  }

  return retHtml;
};

module.exports = FilterXSS;

},{"./default":15,"./parser":17,"./util":18,"cssfilter":11}]},{},[6])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhc3NldHMvanMvY29tbWVudC1yZXZpZXcuanMiLCJhc3NldHMvanMvY29tbWVudHMuanMiLCJhc3NldHMvanMvZm9vdG5vdGVzLWRlc2lnbi5qcyIsImFzc2V0cy9qcy9oaWdobGlnaHRzLXN5bmMuanMiLCJhc3NldHMvanMvbG9jYWwuc3RvcmUuanMiLCJhc3NldHMvanMvdGVtcGxhdGVzL2FydGljbGUuanMiLCJhc3NldHMvanMvdGV4dC1oaWdobGlnaHQuanMiLCJhc3NldHMvanMvdmlldy1tb2RlLmpzIiwibm9kZV9tb2R1bGVzL2Nzc2ZpbHRlci9saWIvY3NzLmpzIiwibm9kZV9tb2R1bGVzL2Nzc2ZpbHRlci9saWIvZGVmYXVsdC5qcyIsIm5vZGVfbW9kdWxlcy9jc3NmaWx0ZXIvbGliL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2Nzc2ZpbHRlci9saWIvcGFyc2VyLmpzIiwibm9kZV9tb2R1bGVzL2Nzc2ZpbHRlci9saWIvdXRpbC5qcyIsIm5vZGVfbW9kdWxlcy93ZWItaGlnaGxpZ2h0ZXIvZGlzdC93ZWItaGlnaGxpZ2h0ZXIubWluLmpzIiwibm9kZV9tb2R1bGVzL3hzcy9saWIvZGVmYXVsdC5qcyIsIm5vZGVfbW9kdWxlcy94c3MvbGliL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3hzcy9saWIvcGFyc2VyLmpzIiwibm9kZV9tb2R1bGVzL3hzcy9saWIvdXRpbC5qcyIsIm5vZGVfbW9kdWxlcy94c3MvbGliL3hzcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25ZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbFNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25MQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25DQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM2NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDalFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJjb25zdCBMb2NhbFN0b3JlID0gcmVxdWlyZSgnLi9sb2NhbC5zdG9yZScpXG5cbi8vIC0tIGNvbW1lbnQtcmV2aWV3XG4vLyAgICBkaXNwbGF5IHVucHVibGlzaGVkIGNvbW1lbnRzXG4vLyAgICBzYXZlZCBpbiBsb2NhbFN0b3JhZ2UsXG4vLyAgICBhbGxvdyB0byByZW1vdmUgdW53YW50ZWQgb25lcyxcbi8vICAgIGVkaXQgdGhlbSwgYW5kIHRoZW4gc2VsZWN0aXZlbHlcbi8vICAgIHB1Ymxpc2ggdGhlbSBhbGwgaW4gb25lIGdvXG5cbmZ1bmN0aW9uIGNvbW1lbnRSZXZpZXdMaXN0KGFydGljbGVfc2x1Zykge1xuXG4gIC8vIC0tIGluaXQsIHZpZXcgcmVzZXRcbiAgY29uc3QgY29tbWVudF9kYXRhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbW1lbnQtZGF0YScpXG5cbiAgLy8gcmVtb3ZlIGV2ZXJ5IG5vZGUgaW5zaWRlIGNvbW1lbnQtZGF0YVxuICBBcnJheS5mcm9tKGNvbW1lbnRfZGF0YS5jaGlsZE5vZGVzKS5tYXAoaXRlbSA9PiB7XG4gICAgaXRlbS5yZW1vdmUoKVxuICB9KVxuIFxuICAvLyAtLSBwb3B1bGF0ZSBjb21tZW50LWRhdGEgdy8gdW5wdWJsaXNoZWQgY29tbWVudHMgZnJvbSBsb2NhbC1zdG9yYWdlXG4gIGNvbnN0IGNvbW1lbnRfc3RvcmUgPSBuZXcgTG9jYWxTdG9yZShgY29tbWVudC0ke2FydGljbGVfc2x1Z31gKVxuICBsZXQgY29tbWVudHMgPSBjb21tZW50X3N0b3JlLmdldEFsbCgpIFxuXG4gIC8vIHJlbW92ZSBwdWJsaXNoZWQgY29tbWVudHMgZnJvbSBsaXN0XG4gIC8vIHdlIGRpc3BsYXkgaW4gY29tbWVudC1yZXZpZXcgb25seSBkcmFmdCBjb21tZW50cyBcbiAgY29tbWVudHMgPSBjb21tZW50cy5maWx0ZXIoY29tbWVudCA9PiBjb21tZW50LnN0YXR1cyA9PT0gJ2RyYWZ0JylcblxuICBjb21tZW50cy5tYXAoKGNvbW1lbnQsIGlkeCkgPT4ge1xuICAgIGNvbnN0IGVsID0gbWFrZV9jb21tZW50X2VsKGNvbW1lbnQsIGlkeCwgYXJ0aWNsZV9zbHVnKVxuICAgIGNvbW1lbnRfZGF0YS5hcHBlbmQoZWwpXG4gIH0pXG5cbiAgLy8gLS0gc2V0dXAgY29tbWVudCBzdGF0dXMgYW5kIHVzZXJuYW1lXG4gIGlmIChjb21tZW50cy5sZW5ndGggKSB7XG4gICAgY29uc3QgY29tbWVudF9zdGF0dXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29tbWVudC1zdGF0dXMnKVxuICAgIGNvbW1lbnRfc3RhdHVzLmlubmVySFRNTCA9ICdZb3VyIHVucHVibGlzaGVkIGNvbW1lbnRzOidcbiAgfVxuXG4gIC8vIC0tIHNhdmUgdXNlcm5hbWUgaW50byBhIGRpZmZlcmVudCwgb3duIHN0b3JlXG4gIC8vICAgIHNvIHdlIGNhbiBtb3JlIGVhc2lseSBmZXRjaCBpdCBhbmQgcHJlLWFkZCBpdFxuICAvLyAgICB0byBhbnkgb3RoZXIgY29tbWVudCBkb25lIGFmdGVyd2FyZHNcbiAgbGV0IHVzZXJfbmFtZSA9ICcnXG4gIGlmIChjb21tZW50cy5sZW5ndGggPiAwKSB7XG4gICAgdXNlcl9uYW1lID0gY29tbWVudHNbMF0uY29udGVudC51c2VyXG4gIH1cblxuICBjb25zdCB1c2VybmFtZSA9IHNldFVzZXJuYW1lKHVzZXJfbmFtZSwgYXJ0aWNsZV9zbHVnKVxuXG4gIC8vIC0tIHNldCB1c2VybmFtZSB0byBjb21tZW50LWxpc3Qtc3RhdHVzIGFyZWFcbiAgY29uc3QgdXNlcm5hbWVfZWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb21tZW50LXVzZXJuYW1lLXdyYXBwZXInKVxuICBjb25zdCB1c2VybmFtZV9pbnB1dCA9IHVzZXJuYW1lX2VkaXQucXVlcnlTZWxlY3RvcignaW5wdXQnKVxuICB1c2VybmFtZV9pbnB1dC52YWx1ZSA9IHVzZXJuYW1lLnZhbHVlXG5cbiAgLy8gc2V0IGlucHV0IHRleHQgd2lkdGggdG8gc3BlY2lmaWMgdXNlcm5hbWUgbGVuZ3RoXG4gIHVzZXJuYW1lX2lucHV0LnN0eWxlLndpZHRoID0gYCR7dXNlcm5hbWVfaW5wdXQudmFsdWUubGVuZ3RoICsxfWNoYFxuXG4gIGNvbnN0IHVzZXJfc3RvcmUgPSBuZXcgTG9jYWxTdG9yZSgndXNlcicpXG4gIGNvbnN0IHVzZXJuYW1lX2VkaXRfYnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbW1lbnQtdXNlcm5hbWUtZWRpdC1idG4nKVxuXG4gIHVzZXJuYW1lX2VkaXRfYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldFxuICAgIFxuICAgIGlmICh0YXJnZXQudGV4dENvbnRlbnQgPT09ICdzYXZlJykge1xuICAgICAgLy8gc2F2ZSBpbnB1dCB0ZXh0XG4gICAgICB1c2VybmFtZS52YWx1ZSA9IHVzZXJuYW1lX2lucHV0LnZhbHVlXG4gICAgICB1c2VyX3N0b3JlLnNhdmUodXNlcm5hbWUpXG5cbiAgICAgIC8vIHJlc2V0IHN0eWxlc1xuICAgICAgdGFyZ2V0LnRleHRDb250ZW50ID0gJ2VkaXQnXG5cbiAgICAgIHVzZXJuYW1lX2lucHV0LnNldEF0dHJpYnV0ZSgncmVhZG9ubHknLCAncmVhZG9ubHknKVxuICAgICAgdXNlcm5hbWVfaW5wdXQuc3R5bGUud2lkdGggPSBgJHt1c2VybmFtZV9pbnB1dC52YWx1ZS5sZW5ndGggKzF9Y2hgXG4gICAgICB1c2VybmFtZV9pbnB1dC5zdHlsZS5ib3JkZXJDb2xvciA9ICd0cmFuc3BhcmVudCdcblxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLmZvY3VzKClcblxuICAgIH0gZWxzZSBpZiAodGFyZ2V0LnRleHRDb250ZW50ID09PSAnZWRpdCcpIHtcbiAgICAgIC8vIHRvZ2dsZSBzdHlsZXNcblxuICAgICAgdGFyZ2V0LnRleHRDb250ZW50ID0gJ3NhdmUnXG5cbiAgICAgIG1vdmVDYXJldFRvRW5kKHVzZXJuYW1lX2lucHV0KVxuICAgICAgXG4gICAgICB1c2VybmFtZV9pbnB1dC5yZW1vdmVBdHRyaWJ1dGUoJ3JlYWRvbmx5JylcbiAgICAgIHVzZXJuYW1lX2lucHV0LnN0eWxlLndpZHRoID0gJ2F1dG8nXG4gICAgICB1c2VybmFtZV9pbnB1dC5zdHlsZS5ib3JkZXJDb2xvciA9ICdibGFjaydcblxuICAgICAgdXNlcm5hbWVfaW5wdXQuZm9jdXMoKVxuICAgIH1cblxuICB9KVxuXG4gIC8vIC0tIHB1Ymxpc2gsIGVkaXQgYW5kIHJlbW92ZSBzZWxlY3RlZCBjb21tZW50c1xuICBjb25zdCBwdWJsaXNoX2J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3N0X2NvbW1lbnQnKVxuICBjb25zdCBlZGl0X2J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb21tZW50LWVkaXQnKVxuICBjb25zdCByZW1vdmVfYnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbW1lbnQtcmVtb3ZlJylcblxuICBpZiAoY29tbWVudHMubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IGlucHV0cyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbW1lbnQtbGlzdC1pbnB1dCcpKVxuXG4gICAgLy8gLS0gcHVibGlzaCBzZWxlY3RlZCBjb21tZW50c1xuICAgIHB1Ymxpc2hfYnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpXG5cbiAgICBwdWJsaXNoX2J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG5cbiAgICAgIGlucHV0cy5tYXAoaW5wdXQgPT4ge1xuICAgICAgICBcbiAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQpIHtcbiAgICAgICAgICBjb25zdCBoaWdobGlnaHRfaWQgPSBpbnB1dC5wYXJlbnROb2RlLmlkXG4gICAgICAgICAgY29uc3QgY29tbWVudCA9IGNvbW1lbnRzLmZpbmQoY29tbWVudCA9PiB7XG4gICAgICAgICAgICBpZiAoY29tbWVudC5jb250ZW50LnNlbGVjdGlvbl90ZXh0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgaWYgKGNvbW1lbnQuY29udGVudC5zZWxlY3Rpb25fdGV4dC5pZCA9PT0gaGlnaGxpZ2h0X2lkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbW1lbnRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaWYgKGNvbW1lbnQuY29udGVudC5ibG9ja19pZCA9PT0gaGlnaGxpZ2h0X2lkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbW1lbnRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG5cbiAgICAgICAgICBjb21tZW50WydzdGF0dXMnXSA9ICdwdWJsaXNoZWQnXG4gICAgICAgICAgaW5wdXQudmFsdWUgPSBKU09OLnN0cmluZ2lmeShjb21tZW50KVxuXG4gICAgICAgICAgLy8gcmVtb3ZlIHNlbGVjdGVkIGlucHV0LWNoZWNrZWQgaXRlbXMgZnJvbSBjb21tZW50cyBzdG9yZVxuICAgICAgICAgIGNvbW1lbnRfc3RvcmUucmVtb3ZlKGhpZ2hsaWdodF9pZClcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlucHV0LnZhbHVlID0gJydcblxuICAgICAgICB9XG5cbiAgICAgIH0pXG5cbiAgICB9KVxuXG4gICAgLy8gLS0gZWRpdCBzZWxlY3RlZCBjb21tZW50c1xuICAgIGVkaXRfYnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpXG5cbiAgICBlZGl0X2J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KClcblxuICAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXRcbiAgICAgIGNvbnN0IG9wZXJhdGlvbiA9IHRhcmdldC50ZXh0Q29udGVudFxuXG4gICAgICBjb25zdCBpc0lucHV0U2VsZWN0ZWQgPSBpbnB1dHMuZmluZChpbnB1dCA9PiBpbnB1dC5jaGVja2VkKVxuICAgICAgaWYgKGlzSW5wdXRTZWxlY3RlZCkge1xuICAgICAgICBpZiAodGFyZ2V0LnRleHRDb250ZW50ID09PSAnc2F2ZScpIHtcbiAgICAgICAgICB0YXJnZXQudGV4dENvbnRlbnQgPSAnZWRpdCdcbiAgICAgICAgfSBlbHNlIGlmICh0YXJnZXQudGV4dENvbnRlbnQgPT09ICdlZGl0Jykge1xuICAgICAgICAgIHRhcmdldC50ZXh0Q29udGVudCA9ICdzYXZlJ1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlucHV0cy5tYXAoKGlucHV0LCBpZHgpID0+IHtcbiAgICAgICAgXG4gICAgICAgIGlmIChpbnB1dC5jaGVja2VkKSB7XG5cbiAgICAgICAgICBjb25zdCBoaWdobGlnaHRfaWQgPSBpbnB1dC5wYXJlbnROb2RlLmlkXG4gICAgICAgICAgY29uc3QgY29tbWVudCA9IGNvbW1lbnRzLmZpbmQoY29tbWVudCA9PiB7XG4gICAgICAgICAgICBpZiAoY29tbWVudC5jb250ZW50LnNlbGVjdGlvbl90ZXh0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgaWYgKGNvbW1lbnQuY29udGVudC5zZWxlY3Rpb25fdGV4dC5pZCA9PT0gaGlnaGxpZ2h0X2lkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbW1lbnRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaWYgKGNvbW1lbnQuY29udGVudC5ibG9ja19pZCA9PT0gaGlnaGxpZ2h0X2lkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbW1lbnRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG5cbiAgICAgICAgICBjb25zdCBjb21tZW50X2lucHV0X3RleHQgPSBpbnB1dC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5jb21tZW50LWxhYmVsLXdyYXBwZXIgPiBpbnB1dCcpXG5cbiAgICAgICAgICBpZiAob3BlcmF0aW9uID09PSAnc2F2ZScpIHtcblxuICAgICAgICAgICAgLy8gc2F2ZSBpbnB1dCB0ZXh0XG4gICAgICAgICAgICBjb21tZW50LmNvbnRlbnQudGV4dCA9IGNvbW1lbnRfaW5wdXRfdGV4dC52YWx1ZVxuICAgICAgICAgICAgY29tbWVudF9zdG9yZS5zYXZlKGNvbW1lbnQpXG5cbiAgICAgICAgICAgIGNvbW1lbnRfaW5wdXRfdGV4dC5zZXRBdHRyaWJ1dGUoJ3JlYWRvbmx5JywgJ3JlYWRvbmx5JylcbiAgICAgICAgICAgIC8vIGNvbW1lbnRfaW5wdXRfdGV4dC5zdHlsZS53aWR0aCA9IGAke2NvbW1lbnRfaW5wdXRfdGV4dC52YWx1ZS5sZW5ndGggKzF9Y2hgXG4gICAgICAgICAgICBjb21tZW50X2lucHV0X3RleHQuc3R5bGUuYm9yZGVyQ29sb3IgPSAndHJhbnNwYXJlbnQnXG5cbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKS5mb2N1cygpXG5cbiAgICAgICAgICB9IGVsc2UgaWYgKG9wZXJhdGlvbiA9PT0gJ2VkaXQnKSB7XG5cbiAgICAgICAgICAgIG1vdmVDYXJldFRvRW5kKGNvbW1lbnRfaW5wdXRfdGV4dClcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29tbWVudF9pbnB1dF90ZXh0LnJlbW92ZUF0dHJpYnV0ZSgncmVhZG9ubHknKVxuICAgICAgICAgICAgY29tbWVudF9pbnB1dF90ZXh0LnN0eWxlLndpZHRoID0gJ2F1dG8nXG4gICAgICAgICAgICBjb21tZW50X2lucHV0X3RleHQuc3R5bGUuYm9yZGVyQ29sb3IgPSAnYmxhY2snXG5cbiAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgICB9KVxuXG4gICAgfSlcbiBcbiAgICAvLyAtLSByZW1vdmUgc2VsZWN0ZWQgY29tbWVudHNcbiAgICByZW1vdmVfYnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpXG5cbiAgICByZW1vdmVfYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKVxuXG4gICAgICBpbnB1dHMubWFwKGlucHV0ID0+IHtcbiAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQpIHtcbiAgICAgICAgICBjb25zdCBoaWdobGlnaHRfaWQgPSBpbnB1dC5wYXJlbnROb2RlLmlkXG4gICAgICAgICAgaWYgKGhpZ2hsaWdodF9pZCAhPT0gJycpIHtcbiAgICAgICAgICAgIGNvbW1lbnRfc3RvcmUucmVtb3ZlKGhpZ2hsaWdodF9pZClcbiAgICAgICAgICAgIHJlbW92ZUNvbW1lbnRET00oaGlnaGxpZ2h0X2lkKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgY29tbWVudFJldmlld0xpc3QoYXJ0aWNsZV9zbHVnKVxuICAgICAgdXBkYXRlQ29tbWVudENvdW50ZXIoJ2RlY3JlYXNlJywgY29tbWVudHMubGVuZ3RoKVxuICAgIH0pXG5cbiAgfSBlbHNlIHtcbiAgICBwdWJsaXNoX2J0bi5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKVxuICAgIGVkaXRfYnRuLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpXG4gICAgcmVtb3ZlX2J0bi5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKVxuICB9XG4gIFxufVxuXG5mdW5jdGlvbiBtYWtlX2NvbW1lbnRfZWwoY29tbWVudCwgaWR4LCBhcnRpY2xlX3NsdWcpIHtcbiAgY29uc3QgY29tbWVudF9zdG9yZSA9IG5ldyBMb2NhbFN0b3JlKGBjb21tZW50LSR7YXJ0aWNsZV9zbHVnfWApXG5cbiAgLy8gLS0gd3JhcHBlciBub2RlXG4gIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICB3cmFwcGVyLmNsYXNzTGlzdC5hZGQoJ2NvbW1lbnQtbGlzdC13cmFwcGVyJylcbiAgd3JhcHBlci5zZXRBdHRyaWJ1dGUoJ2lkJywgY29tbWVudC5pZClcblxuICAvLyAtLSBpbnB1dCBjaGVja2JveFxuICBjb25zdCBjb21tZW50X2lucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKVxuICBjb21tZW50X2lucHV0LnNldEF0dHJpYnV0ZSgndHlwZScsICdjaGVja2JveCcpXG4gIGNvbW1lbnRfaW5wdXQuc2V0QXR0cmlidXRlKCdpZCcsIGBjb21tZW50X2RhdGFbXWApXG4gIGNvbW1lbnRfaW5wdXQuc2V0QXR0cmlidXRlKCduYW1lJywgYGNvbW1lbnRfZGF0YVtdYClcbiAgY29tbWVudF9pbnB1dC5jbGFzc0xpc3QuYWRkKCdjb21tZW50LWxpc3QtaW5wdXQnKVxuXG4gIC8vIC0tIGxhYmVsXG4gIGNvbnN0IGNvbW1lbnRfbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpXG4gIGNvbW1lbnRfbGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCBgY29tbWVudC1saXN0LSR7aWR4fWApXG4gIGNvbW1lbnRfbGFiZWwuY2xhc3NMaXN0LmFkZCgnY29tbWVudC1saXN0LWxhYmVsJylcblxuICAvLyAtLSB0ZXh0XG4gIGNvbnN0IGNvbW1lbnRfaW5wdXRfdGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JylcbiAgY29tbWVudF9pbnB1dF90ZXh0LnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0JylcbiAgY29tbWVudF9pbnB1dF90ZXh0LnNldEF0dHJpYnV0ZSgnaWQnLCBgY29tbWVudC1saXN0LXRleHQtJHtpZHh9YClcbiAgY29tbWVudF9pbnB1dF90ZXh0LnNldEF0dHJpYnV0ZSgndGV4dCcsICdjb21tZW50LWxpc3QtdGV4dCcpXG4gIGNvbW1lbnRfaW5wdXRfdGV4dC5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgY29tbWVudC5jb250ZW50LnRleHQpXG4gIGNvbW1lbnRfaW5wdXRfdGV4dC5zZXRBdHRyaWJ1dGUoJ3JlYWRvbmx5JywgJ3JlYWRvbmx5JylcblxuICAvLyAtLSBhZGQgbGluayB0byB0ZXh0LXNlbGVjdGlvbiBzcGFuXG4gIGNvbnN0IGhpZ2hsaWdodF9pZCA9IGNvbW1lbnQuaWRcblxuICBjb25zdCB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1oaWdobGlnaHQtaWQ9XCIke2hpZ2hsaWdodF9pZH1cIl1gKVxuICBpZiAodGFyZ2V0ICE9PSBudWxsKSB7XG4gICAgdGFyZ2V0LnNldEF0dHJpYnV0ZSgnaWQnLCBoaWdobGlnaHRfaWQpIFxuICB9XG5cbiAgY29uc3Qgc2hvd190ZXh0X3NlbGVjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKVxuICBzaG93X3RleHRfc2VsZWN0aW9uLnNldEF0dHJpYnV0ZSgnaHJlZicsIGAjJHtoaWdobGlnaHRfaWR9YClcbiAgc2hvd190ZXh0X3NlbGVjdGlvbi5jbGFzc0xpc3QuYWRkKCdjb21tZW50LWxpc3Qtc2hvdy1oaWdobGlnaHQnKVxuXG4gIHNob3dfdGV4dF9zZWxlY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgIC8vIHNldCBib3JkZXIgYXJvdW5kIHRleHQtc2VsZWN0aW9uIGZvciBhXG4gICAgLy8gc3BlY2lmaWMgYW1vdW50IG9mIHRpbWUsIHRoZW4gcmVzZXQgdGhlIHN0eWxlXG5cbiAgICBlLnByZXZlbnREZWZhdWx0KClcblxuICAgIC8vIHRhcmdldC5zY3JvbGxJbnRvVmlldyh7YmVoYXZpb3I6ICdzbW9vdGgnfSlcbiAgICBjb25zdCB0YXJnZXRQb3MgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wICsgd2luZG93LnNjcm9sbFlcbiAgICBsZXQgb2Zmc2V0UG9zaXRpb24gPSB0YXJnZXRQb3MgLSAyMDtcbiAgICB3aW5kb3cuc2Nyb2xsKHtcbiAgICAgIHRvcDogb2Zmc2V0UG9zaXRpb24sXG4gICAgICBsZWZ0OiAwLFxuICAgICAgYmVoYXZpb3I6ICdzbW9vdGgnXG4gICAgfSlcblxuICAgIHRhcmdldC5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkIGJsdWUnXG5cbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRhcmdldC5zdHlsZS5ib3JkZXIgPSAnJ1xuICAgIH0sICczMDAwJylcblxuICB9KVxuXG4gIC8vIC0tIGFwcGVuZCBhYm92ZSBub2RlcyB0byBsYWJlbCB3cmFwcGVyIG5vZGVcbiAgY29uc3QgY29tbWVudF9sYWJlbF93cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgY29tbWVudF9sYWJlbF93cmFwcGVyLmNsYXNzTGlzdC5hZGQoJ2NvbW1lbnQtbGFiZWwtd3JhcHBlcicpXG4gIC8vIGNvbW1lbnRfbGFiZWxfd3JhcHBlci5hcHBlbmQoY29tbWVudF9pbnB1dF90ZXh0KVxuICBzaG93X3RleHRfc2VsZWN0aW9uLmFwcGVuZChjb21tZW50X2lucHV0X3RleHQpXG5cbiAgLy8gLS0gYXBwZW5kIHdyYXBwZXIgbm9kZXMgdG8gbGFiZWwgbm9kZVxuICBjb21tZW50X2xhYmVsLmFwcGVuZChjb21tZW50X2xhYmVsX3dyYXBwZXIpXG4gIGNvbW1lbnRfbGFiZWxfd3JhcHBlci5hcHBlbmQoc2hvd190ZXh0X3NlbGVjdGlvbilcblxuICAvLyAtLSBhcHBlbmQgaW5wdXQgYW5kIGxhYmVsIG5vZGVzIHRvIHJvb3Qgd3JhcHBlciBub2RlXG4gIHdyYXBwZXIuYXBwZW5kKGNvbW1lbnRfaW5wdXQpXG4gIHdyYXBwZXIuYXBwZW5kKGNvbW1lbnRfbGFiZWwpXG5cblxuICByZXR1cm4gd3JhcHBlclxuXG59XG5cblxuLy8gPGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS80NzE2MDIxPlxuZnVuY3Rpb24gbW92ZUNhcmV0VG9FbmQoZWwpIHtcbiAgaWYgKHR5cGVvZiBlbC5zZWxlY3Rpb25TdGFydCA9PSBcIm51bWJlclwiKSB7XG4gICAgZWwuc2VsZWN0aW9uU3RhcnQgPSBlbC5zZWxlY3Rpb25FbmQgPSBlbC52YWx1ZS5sZW5ndGg7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGVsLmNyZWF0ZVRleHRSYW5nZSAhPSBcInVuZGVmaW5lZFwiKSB7XG4gICAgZWwuZm9jdXMoKTtcbiAgICB2YXIgcmFuZ2UgPSBlbC5jcmVhdGVUZXh0UmFuZ2UoKTtcbiAgICByYW5nZS5jb2xsYXBzZShmYWxzZSk7XG4gICAgcmFuZ2Uuc2VsZWN0KCk7XG4gIH1cbn1cblxuLy8gc2F2ZSB1c2VybmFtZSBpbnRvIGEgZGlmZmVyZW50LCBvd24gc3RvcmVcbi8vIHNvIHdlIGNhbiBtb3JlIGVhc2lseSBmZXRjaCBpdCBhbmQgcHJlLWFkZCBpdFxuLy8gdG8gYW55IG90aGVyIGNvbW1lbnQgZG9uZSBhZnRlcndhcmRzXG5mdW5jdGlvbiBzZXRVc2VybmFtZShuYW1lLCBhcnRpY2xlX3NsdWcpIHtcblxuICBjb25zdCB1c2VyX3N0b3JlID0gbmV3IExvY2FsU3RvcmUoJ3VzZXInKVxuICBjb25zdCB1c2VyID0gdXNlcl9zdG9yZS5nZXRCeUlEKGFydGljbGVfc2x1ZylcblxuICBsZXQgdXNlcm5hbWUgPSB7aWQ6ICcnLCB2YWx1ZTogJyd9XG5cbiAgaWYgKHVzZXIgPT09IHVuZGVmaW5lZCB8fCB1c2VyLnZhbHVlID09PSAnJykge1xuICAgIHVzZXJuYW1lWydpZCddID0gYCR7YXJ0aWNsZV9zbHVnfWBcbiAgICB1c2VybmFtZVsndmFsdWUnXSA9IG5hbWVcblxuICAgIHVzZXJfc3RvcmUuc2F2ZSh1c2VybmFtZSlcblxuICB9IGVsc2Uge1xuICAgIHVzZXJuYW1lID0gdXNlclxuICB9XG5cbiAgcmV0dXJuIHVzZXJuYW1lXG5cbn1cblxuZnVuY3Rpb24gcmVtb3ZlQ29tbWVudERPTShoaWdobGlnaHRfaWQpIHtcbiAgLy8gcmVtb3ZlIHRleHQtaGlnaGxpZ2h0XG4gIGNvbnN0IHRpcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWhpZ2hsaWdodC1pZD1cIiR7aGlnaGxpZ2h0X2lkfVwiXWApXG4gIGlmICh0aXAgIT09IG51bGwpIHtcbiAgICB0aXAucmVtb3ZlKClcbiAgfVxuXG4gIC8vIHJlbW92ZSBhcnRpY2xlLWNvbW1lbnQgZnJvbSBkcmFmdCBsaXN0XG4gIGNvbnN0IGFydGljbGVfY29tbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXRleHQtc2VsZWN0aW9uLWlkPVwiJHtoaWdobGlnaHRfaWR9XCJdYClcbiAgaWYgKGFydGljbGVfY29tbWVudCAhPT0gbnVsbCkge1xuICAgIGFydGljbGVfY29tbWVudC5yZW1vdmUoKVxuICB9XG5cbiAgLy8gcmVtb3ZlIGFydGljbGUgYmxvY2sgaGlnaGxpZ2h0LCBpZiBhbnlcbiAgY29uc3QgYmxvY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuY29udGVudC13cmFwcGVyICMke2hpZ2hsaWdodF9pZH1gKVxuICBpZiAoYmxvY2sgIT09IG51bGwpIHtcbiAgICBibG9jay5jbGFzc0xpc3QucmVtb3ZlKCdibG9jay1oaWdobGlnaHQnKVxuICB9XG5cbn1cblxuZnVuY3Rpb24gdXBkYXRlQ29tbWVudENvdW50ZXIob3AsIGFtb3VudCkge1xuICAvLyB1cGRhdGUgY29tbWVudCBjb3VudFxuICBjb25zdCBjb21tZW50X2NvdW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NvbW1lbnRfY291bnQnKVxuICBjb25zdCBjdXJyZW50X2NvdW50ID0gbmV3IE51bWJlcihjb21tZW50X2NvdW50LmlubmVySFRNTClcblxuICBpZiAob3AgPT09ICdpbmNyZWFzZScpIHtcbiAgICBjb21tZW50X2NvdW50LmlubmVySFRNTCA9IGN1cnJlbnRfY291bnQgKyBhbW91bnRcblxuICB9IGVsc2UgaWYgKG9wID09PSAnZGVjcmVhc2UnKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gY3VycmVudF9jb3VudCAtIGFtb3VudFxuICAgIGNvbW1lbnRfY291bnQuaW5uZXJIVE1MID0gcmVzdWx0IDwgMCA/IDAgOiByZXN1bHRcbiAgfVxuXG59XG5cbm1vZHVsZS5leHBvcnRzID0geyBjb21tZW50UmV2aWV3TGlzdCxcbiAgICAgICAgICAgICAgICAgICBzZXRVc2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICB1cGRhdGVDb21tZW50Q291bnRlciB9XG4iLCJjb25zdCBMb2NhbFN0b3JlID0gcmVxdWlyZSgnLi9sb2NhbC5zdG9yZScpXG5jb25zdCB4c3MgPSByZXF1aXJlKCd4c3MnKVxuY29uc3QgeyBjb21tZW50UmV2aWV3TGlzdCwgc2V0VXNlcm5hbWUsIHVwZGF0ZUNvbW1lbnRDb3VudGVyIH0gPSByZXF1aXJlKCcuL2NvbW1lbnQtcmV2aWV3JylcblxuZnVuY3Rpb24gcmVzcG9uZF9jb21tZW50KGUpIHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpXG5cbiAgY29uc3QgZm9ybSA9IGUudGFyZ2V0XG5cbiAgXG4gIC8vIC0tIHNhdmUgY29tbWVudCB0byBsb2NhbFN0b3JhZ2UgdW5kZXI6XG4gIC8vICAgIDxjdXJyZW50LWFydGljbGUtdXJsPjogW3suLn0sIC4uLl1cblxuICAvLyB0byBjb3JyZWN0bHkgc2F2ZSBvYmplY3QgaW50byBMb2NhbFN0b3JlXG4gIC8vIHRoZSBvYmplY3QgbmVlZHMgdG8gaGF2ZSBhbiBJRCBmaWVsZFxuICAvLyBlbHNlIExvY2FsU3RvcmUgd2lsbCByZXBsYWNlIHRoZSBwcmV2aW91c1xuICAvLyBjb21tZW50IHdpdGggdGhlIG5ld2VzdCBvbmUgb25seVxuICAvLyBuYjogY2hlY2sgaWYgc2VsZWN0aW9uLXR5cGUgPT4gdGV4dFxuXG4gIGNvbnN0IGFydGljbGVfc2x1ZyA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdCgnLycpLnBvcCgpLnNwbGl0KCcvJykuam9pbignKycpXG4gIGNvbnN0IGNvbW1lbnRfc3RvcmUgPSBuZXcgTG9jYWxTdG9yZShgY29tbWVudC0ke2FydGljbGVfc2x1Z31gKVxuICBsZXQgY29tbWVudCA9IG1ha2VfY29tbWVudChmb3JtLCBjb21tZW50X3N0b3JlKVxuICBpZiAoIWNvbW1lbnQpIHtcbiAgICByZXR1cm5cbiAgfVxuXG4gIGlmIChjb21tZW50LmNvbnRlbnQuc2VsZWN0aW9uX3RleHQgIT09IHVuZGVmaW5lZCkge1xuICAgIGNvbW1lbnRbJ2lkJ10gPSBjb21tZW50LmNvbnRlbnQuc2VsZWN0aW9uX3RleHQuaWRcbiAgfSBlbHNlIHtcbiAgICBjb21tZW50WydpZCddID0gY29tbWVudC5jb250ZW50LmJsb2NrX2lkXG4gIH1cblxuICAvLyAtLSBzYXZlIHVzZXJuYW1lIHRvIGxvY2FsLnN0b3JlIGlmIG5vdCBzZXQgeWV0XG4gIHNldFVzZXJuYW1lKGNvbW1lbnQuY29udGVudC51c2VyLCBjb21tZW50LmNvbnRlbnQuYXJ0aWNsZV9zbHVnKVxuICBcbiAgY29tbWVudF9zdG9yZS5zYXZlKGNvbW1lbnQpXG4gXG4gIC8vIC0tIHNldCBjb21tZW50LXJldmlldyBsaXN0XG4gIGNvbW1lbnRSZXZpZXdMaXN0KGFydGljbGVfc2x1ZylcblxuICAvLyAtLSBjcmVhdGUgYW5kIGFwcGVuZCBuZXdseSBwb3N0ZWQgY29tbWVudFxuICBjb25zdCBhcnRpY2xlX2NvbW1lbnQgPSBtYWtlX2NvbW1lbnRfZWwoY29tbWVudClcbiAgY3JlYXRlQ29tbWVudChmb3JtLCBhcnRpY2xlX2NvbW1lbnQsIGNvbW1lbnQpXG4gIGFydGljbGVfY29tbWVudC5mb2N1cygpXG5cbn1cblxuZnVuY3Rpb24gbWFrZV9jb21tZW50KCBmb3JtLCBzdG9yZSApIHtcbiAgLy8gLS0gY29tbWVudCBjYW4gZWl0aGVyIGJlIHRleHQtc2VsZWN0aW9uXG4gIC8vICAgIG9yIGJsb2NrLWxldmVsIGNvbW1lbnRcbiAgLy8gICAgaG93IHRvIGF2b2lkIGJyZWFraW5nIHRoZSBjb21tZW50aW5nIHN5c3RlbVxuICAvLyAgICBpZiB0aGVyZSdzIG5vIGBzZWxlY3Rpb25fdGV4dGBcblxuICAvLyAtLSBjaGVjayBpZiB0ZXh0LWNvbW1lbnQgaXMgbm90IGVtcHR5LFxuICAvLyAgICBlZyBqdXN0IGVtcHR5IHNwYWNlc1xuICBjb25zdCBjaGlsZHJlbiA9IEFycmF5LmZyb20oZm9ybS5jaGlsZHJlbilcbiAgY29uc3QgaW5wdXRfYm9keSA9IGNoaWxkcmVuLmZpbmQoIGMgPT4gYy5uYW1lID09ICdib2R5JyApXG5cbiAgY29uc3QgaW5wdXRfdGV4dCA9IHhzcyhpbnB1dF9ib2R5LnZhbHVlLnRyaW0oKSwge1xuICAgIHdoaXRlTGlzdDogICAgICAgICAge30sICAgICAgICAvLyBlbXB0eSwgbWVhbnMgZmlsdGVyIG91dCBhbGwgdGFnc1xuICAgIHN0cmlwSWdub3JlVGFnOiAgICAgdHJ1ZSwgICAgICAvLyBmaWx0ZXIgb3V0IGFsbCBIVE1MIG5vdCBpbiB0aGUgd2hpbGVsaXN0XG4gICAgc3RyaXBJZ25vcmVUYWdCb2R5OiBbJ3NjcmlwdCddIC8vIHRoZSBzY3JpcHQgdGFnIGlzIGEgc3BlY2lhbCBjYXNlLCB3ZSBuZWVkIHRvIGZpbHRlciBvdXQgaXRzIGNvbnRlbnRcbiAgfSlcblxuICBpZiAoaW5wdXRfdGV4dCA9PT0gJycpIHtcbiAgICAvLyBzdG9wIG9wZXJhdGlvblxuICAgIGlucHV0X2JvZHkudmFsdWUgPSBpbnB1dF9ib2R5LnZhbHVlLnRyaW0oKVxuICAgIGlucHV0X2JvZHkuZm9jdXMoKVxuICAgIGlucHV0X2JvZHkucGxhY2Vob2xkZXIgPSAnUGxlYXNlIGFkZCBzb21lIHRleHQnXG5cbiAgICBpbnB1dF9ib2R5LnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgcmVkJ1xuXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpbnB1dF9ib2R5LnN0eWxlLmJvcmRlciA9ICcnXG4gICAgICBpbnB1dF9ib2R5LnBsYWNlaG9sZGVyID0gJ2NvbW1lbnQuLi4nXG4gICAgfSwgJzMwMDAnKVxuXG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICBjb25zdCBhcnRpY2xlX3NsdWcgICAgICA9IGZvcm0uZ2V0QXR0cmlidXRlKCAnZGF0YS1hcnRpY2xlLXNsdWcnIClcbiAgY29uc3QgYmxvY2tfaWQgICAgICAgICAgPSBmb3JtLmdldEF0dHJpYnV0ZSggJ2RhdGEtYmxvY2staWQnIClcbiAgY29uc3Qgc2VsZWN0aW9uX3R5cGUgICAgPSBmb3JtLmdldEF0dHJpYnV0ZSggJ2RhdGEtYmxvY2stc2VsZWN0aW9uLXR5cGUnIClcbiAgY29uc3QgY29tbWVudF9pZCAgICAgICAgPSBmb3JtLmdldEF0dHJpYnV0ZSggJ2RhdGEtYmxvY2stY29tbWVudC1pZCcgKVxuICBjb25zdCBzZWxlY3Rpb25fdGV4dCAgICA9IHN0b3JlLmdldEJ5SUQoY29tbWVudF9pZClcbiAgY29uc3QgYXV0aG9yICAgICAgICAgICAgPSB4c3MoY2hpbGRyZW4uZmluZCggYyA9PiBjLm5hbWUgPT0gJ2F1dGhvcicgKS52YWx1ZSwge1xuICAgIHdoaXRlTGlzdDogICAgICAgICAge30sICAgICAgICAvLyBlbXB0eSwgbWVhbnMgZmlsdGVyIG91dCBhbGwgdGFnc1xuICAgIHN0cmlwSWdub3JlVGFnOiAgICAgdHJ1ZSwgICAgICAvLyBmaWx0ZXIgb3V0IGFsbCBIVE1MIG5vdCBpbiB0aGUgd2hpbGVsaXN0XG4gICAgc3RyaXBJZ25vcmVUYWdCb2R5OiBbJ3NjcmlwdCddIC8vIHRoZSBzY3JpcHQgdGFnIGlzIGEgc3BlY2lhbCBjYXNlLCB3ZSBuZWVkIHRvIGZpbHRlciBvdXQgaXRzIGNvbnRlbnRcbiAgfSlcbiAgY29uc3QgdGV4dCAgICAgICAgICAgICAgPSBpbnB1dF90ZXh0XG4gIGNvbnN0IHRzICAgICAgICAgICAgICAgID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG5cbiAgcmV0dXJuIHtcbiAgICBzbHVnOiB0cyxcbiAgICB0aXRsZTogdHMsXG4gICAgdGVtcGxhdGU6ICdjb21tZW50JyxcbiAgICBzdGF0dXM6ICdkcmFmdCcsXG4gICAgY29udGVudDoge1xuICAgICAgdXNlcjogYXV0aG9yLFxuICAgICAgdGltZXN0YW1wOiB0cyxcbiAgICAgIGFydGljbGVfc2x1ZzogYXJ0aWNsZV9zbHVnLFxuICAgICAgYmxvY2tfaWQ6IGJsb2NrX2lkLFxuICAgICAgdGV4dDogdGV4dCxcbiAgICAgIHNlbGVjdGlvbl90eXBlOiBzZWxlY3Rpb25fdHlwZSxcbiAgICAgIHNlbGVjdGlvbl90ZXh0OiBzZWxlY3Rpb25fdGV4dCxcbiAgICAgIC8vIHNlbGVjdGlvbl9jb29yZHM6IHNlbGVjdGlvbl9jb29yZHNcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gbWFrZV9jb21tZW50X3RocmVhZF9lbCggZm9ybSApIHtcbiAgY29uc3QgdGhyZWFkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ3NlY3Rpb24nIClcbiAgdGhyZWFkLmNsYXNzTGlzdC5hZGQoICd0aHJlYWQnIClcbiAgY29uc3QgdGhyZWFkX2Zvcm0gPSBmb3JtLmNsb25lTm9kZSggdHJ1ZSApXG4gIHRocmVhZC5hcHBlbmRDaGlsZCggdGhyZWFkX2Zvcm0gKVxuICByZXR1cm4gdGhyZWFkXG59XG5cbmZ1bmN0aW9uIG1ha2VfY29tbWVudF9lbChkYXRhKSB7XG4gIC8vIC0tIHNlY3Rpb25cbiAgY29uc3QgdGV4dF9jb21tZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2VjdGlvbicpXG4gIGNvbnN0IHNlY3Rpb25fdGV4dCA9IGRhdGEuY29udGVudC50ZXh0XG4gIHRleHRfY29tbWVudC5hcHBlbmQoc2VjdGlvbl90ZXh0KVxuXG4gIC8vIC0tIGZvb3RlclxuICBjb25zdCBmb290ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb290ZXInKVxuICBmb290ZXIuY2xhc3NMaXN0LmFkZCggJ3NtYWxsX2l0YWxpYycgKVxuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXG4gIGNvbnN0IHRpbWVzdGFtcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RpbWUnKVxuXG4gIGNvbnN0IHRzID0gbmV3IERhdGUoZGF0YS5jb250ZW50LnRpbWVzdGFtcCkudG9Mb2NhbGVEYXRlU3RyaW5nKCdubC1OTCcsIHtcbiAgICB0aW1lWm9uZTogJ0V1cm9wZS9CZXJsaW4nLFxuICAgIGRheTogJzItZGlnaXQnLFxuICAgIG1vbnRoOiAnMi1kaWdpdCcsXG4gICAgeWVhcjogJ251bWVyaWMnLFxuICAgIGhvdXI6ICdudW1lcmljJyxcbiAgICBtaW51dGU6ICdudW1lcmljJyxcbiAgICBzZWNvbmQ6ICdudW1lcmljJ1xuICB9KVxuICB0aW1lc3RhbXAuc2V0QXR0cmlidXRlKCdkYXRldGltZScsIGRhdGEuY29udGVudC50aW1lc3RhbXApXG4gIGRhdGUuYXBwZW5kKHRpbWVzdGFtcClcbiAgZGF0ZS5pbm5lckhUTUwgPSBgT24gJHt0c31gXG5cbiAgY29uc3QgdXNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICB1c2VyLmlubmVySFRNTCA9IGBieSAke2RhdGEuY29udGVudC51c2VyfWBcblxuICBmb290ZXIuYXBwZW5kKGRhdGUpXG4gIGZvb3Rlci5hcHBlbmQodXNlcilcblxuICAvLyAtLSBhcHBlbmQgZXZlcnl0aGluZyB0byA8YXJ0aWNsZT5cbiAgY29uc3QgYXJ0aWNsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2FydGljbGUnKVxuICBhcnRpY2xlLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnMCcpXG4gIGFydGljbGUuc2V0QXR0cmlidXRlKCdkYXRhLXRleHQtc2VsZWN0aW9uLWlkJywgZGF0YS5pZClcbiAgXG4gIGFydGljbGUuY2xhc3NMaXN0LmFkZCgnY29tbWVudC1kcmFmdCcpXG5cbiAgYXJ0aWNsZS5hcHBlbmQodGV4dF9jb21tZW50KVxuICBhcnRpY2xlLmFwcGVuZChmb290ZXIpXG5cbiAgcmV0dXJuIGFydGljbGVcblxufVxuXG5mdW5jdGlvbiBjcmVhdGVDb21tZW50KGZvcm0sIGFydGljbGUsIGNvbW1lbnQpIHtcbiAgLy8gLS0gYXBwZW5kIG5ldyBjb21tZW50IHRvIGNvbW1lbnQgdGhyZWFkXG4gIC8vICAgIGJlZm9yZSA8Zm9ybT5cbiAgbGV0IHRocmVhZFxuXG4gIC8vIGZvcm06IHJlc2V0IGFuZCBoaWRlIGZvcm1cbiAgZm9ybS5yZXNldCgpXG4gIGZvcm0uYmx1cigpXG4gIFxuICAvLyBjaGVjayBpZiB0aGUgZm9ybSBpcyB0aGUgdG9vbGJhciBmb3JtXG4gIGNvbnN0IGZvcm1fcGFyZW50ID0gZm9ybS5wYXJlbnROb2RlXG4gIGlmIChmb3JtX3BhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoJ3Rvb2xiYXInKSkge1xuXG4gICAgLy8gbWFrZSBhIG5ldyBjb21tZW50IHRocmVhZCBmb3IgdGhpcyBibG9ja1xuICAgIHRocmVhZCA9IG1ha2VfY29tbWVudF90aHJlYWRfZWwoZm9ybSlcbiAgICBjb25zdCBibG9ja19pZCA9IGZvcm0uZ2V0QXR0cmlidXRlKCdkYXRhLWJsb2NrLWlkJylcblxuICAgIGlmIChibG9ja19pZCAhPT0gJycpIHtcbiAgICAgIGNvbnN0IGJsb2NrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmNvbnRlbnQtd3JhcHBlciBzZWN0aW9uIyR7YmxvY2tfaWR9YClcblxuICAgICAgaWYgKGJsb2NrICE9PSBudWxsKSB7XG4gICAgICAgIGNvbnN0IGFzaWRlID0gYmxvY2sucXVlcnlTZWxlY3RvcignYXNpZGUnKVxuICAgICAgICBjb25zdCB0aHJlYWRfZm9ybSA9IEFycmF5LmZyb20odGhyZWFkLmNoaWxkcmVuKVswXVxuICAgICAgICBcbiAgICAgICAgdGhyZWFkLmluc2VydEJlZm9yZShhcnRpY2xlLCB0aHJlYWRfZm9ybSlcbiAgICAgICAgYXNpZGUuYXBwZW5kQ2hpbGQodGhyZWFkKVxuXG4gICAgICAgIC8vIGhpZGUgaW5wdXQtZm9ybVxuICAgICAgICBmb3JtX3BhcmVudC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKVxuICAgICAgICBmb3JtX3BhcmVudC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnLS10b3AnKVxuICAgICAgICBmb3JtX3BhcmVudC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnLS1sZWZ0JylcbiAgICAgIH1cbiAgICB9XG5cbiAgfSBlbHNlIHtcbiAgICB0aHJlYWQgPSBmb3JtX3BhcmVudFxuICAgIHRocmVhZC5pbnNlcnRCZWZvcmUoYXJ0aWNsZSwgZm9ybSlcbiAgfVxuXG4gIC8vIGlmIGNvbW1lbnQgaXMgYXQgYmxvY2stbGV2ZWwsIGhpZ2hsaWdodCBibG9ja1xuICBpZiAoY29tbWVudC5jb250ZW50LnNlbGVjdGlvbl90ZXh0ID09PSB1bmRlZmluZWQgJiYgY29tbWVudC5pZCAhPT0gJycpIHtcbiAgICBjb25zdCBibG9jayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5jb250ZW50LXdyYXBwZXIgIyR7Y29tbWVudC5pZH1gKVxuICAgIGlmIChibG9jayAhPT0gbnVsbCkge1xuICAgICAgYmxvY2suY2xhc3NMaXN0LmFkZCgnYmxvY2staGlnaGxpZ2h0JylcbiAgICB9XG4gIH1cblxufVxuXG5mdW5jdGlvbiBjb21tZW50c0FydGljbGUoY29tbWVudCwgZm9ybSkge1xuICBjb25zdCBhcnRpY2xlX2NvbW1lbnQgPSBtYWtlX2NvbW1lbnRfZWwoY29tbWVudClcblxuICAvLyBzZXQgbWlzc2luZyBkYXRhIHRvIGJlIHVzZWQgd2l0aCB0aGUgaW5wdXQtZm9ybVxuICBmb3JtLnNldEF0dHJpYnV0ZSgnZGF0YS1ibG9jay1zZWxlY3Rpb24tdHlwZScsIGNvbW1lbnQuY29udGVudC5zZWxlY3Rpb25fdHlwZSlcbiAgZm9ybS5zZXRBdHRyaWJ1dGUoJ2RhdGEtYmxvY2stY29tbWVudC1pZCcsIGNvbW1lbnQuaWQpXG5cbiAgZm9ybS5xdWVyeVNlbGVjdG9yKCcjc2VsZWN0aW9uX3R5cGUnKS52YWx1ZSA9IGNvbW1lbnQuY29udGVudC5zZWxlY3Rpb25fdHlwZVxuICBmb3JtLnF1ZXJ5U2VsZWN0b3IoJyNibG9ja19pZCcpLnZhbHVlID0gY29tbWVudC5jb250ZW50LmJsb2NrX2lkXG5cbiAgLy8gd2UgdXNlIHNldEF0dHJpYnV0ZSB0byBmb3JjZSBhZGRpbmcgdGhlIHZhbHVlLCBlbHNlXG4gIC8vIGZvciBzb21lIHJlYXNvbnMgaXQgd291bGQgbm90IHdvcmtcbiAgZm9ybS5xdWVyeVNlbGVjdG9yKCcjYXV0aG9yJykuc2V0QXR0cmlidXRlKCd2YWx1ZScsIGNvbW1lbnQuY29udGVudC51c2VyKVxuXG4gIGNyZWF0ZUNvbW1lbnQoZm9ybSwgYXJ0aWNsZV9jb21tZW50LCBjb21tZW50KVxufVxuXG5mdW5jdGlvbiBibG9ja0ZvY3VzKCkge1xuICAvLyBibG9jay1mb2N1cyBvdmVybGF5XG5cbiAgY29uc3QgYmxvY2tzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYmxvY2snKSlcbiAgICAgICAgLmZpbHRlcihibG9jayA9PiAhYmxvY2suY2xhc3NMaXN0LmNvbnRhaW5zKCdjb2x1bW5zJykpXG5cbiAgY29uc3QgZm9jdXNPdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvY3VzLW92ZXJsYXknKVxuICBcbiAgYmxvY2tzLmZvckVhY2goYmxvY2sgPT4ge1xuICAgIGJsb2NrLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgKGUpID0+IHtcbiAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcbiAgICAgIGZvY3VzT3ZlcmxheS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKVxuICAgIH0pXG5cbiAgICBibG9jay5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgKGUpID0+IHtcbiAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJylcbiAgICAgIGZvY3VzT3ZlcmxheS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKVxuICAgIH0pXG4gIH0pXG59XG5cbmZ1bmN0aW9uIGNvbW1lbnRzKGFydGljbGVfc2x1Zykge1xuICBjb25zdCB1c2VyX3N0b3JlID0gbmV3IExvY2FsU3RvcmUoJ3VzZXInKVxuICBjb25zdCB1c2VyID0gdXNlcl9zdG9yZS5nZXRCeUlEKGFydGljbGVfc2x1ZylcblxuICBjb25zdCBjb21tZW50X3N0b3JlID0gbmV3IExvY2FsU3RvcmUoYGNvbW1lbnQtJHthcnRpY2xlX3NsdWd9YClcbiAgY29uc3QgY29tbWVudHMgPSBjb21tZW50X3N0b3JlLmdldEFsbCgpXG4gIGNvbnN0IGNvbW1lbnRfZm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCAnLmNvbW1lbnRfZm9ybScgKVxuXG4gIGZvciAoY29uc3QgY29tbWVudF9mb3JtIG9mIGNvbW1lbnRfZm9ybXMpIHtcbiAgICAvLyAtLSBzZXQgY29tbWVudCB0byBkZWZhdWx0IHVzZXJuYW1lIGlmIHRoZXJlJ3MgYW55XG4gICAgaWYgKHVzZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29tbWVudF9mb3JtLnF1ZXJ5U2VsZWN0b3IoJyNhdXRob3InKS52YWx1ZSA9IHVzZXIudmFsdWVcbiAgICB9XG5cbiAgICAvLyAtLSBzZXR1cCBhcnRpY2xlJ3MgZHJhZnQgY29tbWVudHNcbiAgICAvLyAgICBjaGVjayBpZiBjb21tZW50IGhhcyBgc3RhdHVzOiBkcmFmdGAgXG4gICAgLy8gICAgYW5kIG1hdGNoZXMgY3VycmVudCBibG9jay1pZFxuICAgIGNvbnN0IGJsb2NrSUQgPSBjb21tZW50X2Zvcm0uZGF0YXNldC5ibG9ja0lkXG4gICAgY29uc3QgY29tbWVudHNfZHJhZnQgPSBjb21tZW50cy5maWx0ZXIoY29tbWVudCA9PiB7XG4gICAgICBpZiAoY29tbWVudC5zdGF0dXMgPT09ICdkcmFmdCcgJiYgY29tbWVudC5jb250ZW50LmJsb2NrX2lkID09PSBibG9ja0lEKSB7XG4gICAgICAgIHJldHVybiBjb21tZW50XG4gICAgICB9XG4gICAgfSlcblxuICAgIGlmIChjb21tZW50c19kcmFmdC5sZW5ndGggPiAwKSB7XG4gICAgICBjb21tZW50c19kcmFmdC5tYXAoY29tbWVudCA9PiB7XG4gICAgICAgIGNvbW1lbnRzQXJ0aWNsZShjb21tZW50LCBjb21tZW50X2Zvcm0pXG4gICAgICB9KVxuICAgIH1cblxuICAgIGNvbW1lbnRfZm9ybS5vbnN1Ym1pdCA9IHJlc3BvbmRfY29tbWVudFxuICB9XG5cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7IHJlc3BvbmRfY29tbWVudCxcbiAgICAgICAgICAgICAgICAgICBjb21tZW50c0FydGljbGUsXG4gICAgICAgICAgICAgICAgICAgYmxvY2tGb2N1cyxcbiAgICAgICAgICAgICAgICAgICBjb21tZW50cyB9XG4iLCJmdW5jdGlvbiBmb290bm90ZXNEZXNpZ24oKSB7XG5cbiAgZnVuY3Rpb24gc21hbGxTY3JlZW4ocmVmcywgbm90ZXNXcmFwLCBub3Rlcykge1xuXG4gICAgaWYgKHdpbmRvdy5pbm5lcldpZHRoIDw9IDYwMCkgeyBcblxuICAgICAgbm90ZXNXcmFwLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpXG5cbiAgICAgIGlmIChub3Rlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIG5vdGVzLm1hcChub3RlID0+IHtcbiAgICAgICAgICBub3RlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZScgXG4gICAgICAgIH0pXG4gICAgICB9XG5cbiAgICAgIGlmIChyZWZzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmVmcy5tYXAoKHJlZiwgaWR4KSA9PiB7XG5cbiAgICAgICAgICAvLyBvbiBjbGljayBkaXNwbGF5IGNvbm5lY3RlZCBub3RlXG4gICAgICAgICAgcmVmLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuXG4gICAgICAgICAgICBjb25zdCBpZCA9IHJlZi5pZC5zcGxpdCgnLScpLnBvcCgpXG4gICAgICAgICAgICBjb25zdCBub3RlID0gbm90ZXMuZmluZChub3RlID0+IG5vdGUuaWQuc3BsaXQoJy0nKS5wb3AoKSA9PT0gaWQpXG5cbiAgICAgICAgICAgIC8vIHN0YXJ0IGNvdW50aW5nIGZyb20gY3VycmVudCBsaS1pdGVtLCBhcyBpdCBpcyB0aGUgb25seSBvbmUgdmlzaWJsZVxuICAgICAgICAgICAgLy8gYW5kIHRoZXJlZm9yZSBpdCB3b3VsZCBvdGhlcndpc2UgYWx3YXlzIHN0YXJ0IGZyb20gMVxuICAgICAgICAgICAgLy8gbm90ZS5wYXJlbnRFbGVtZW50LnNldEF0dHJpYnV0ZSgnc3RhcnQnLCBpZHggKzEpXG4gICAgICAgICAgICAvLyBub3RlLnN0eWxlLnNldFByb3BlcnR5KCctLWZvb3Rub3RlLWNvdW50JywgaWR4ICsxKVxuXG4gICAgICAgICAgICBpZiAobm90ZS5zdHlsZS5kaXNwbGF5ID09PSAndGFibGUtcm93Jykge1xuXG4gICAgICAgICAgICAgIG5vdGUuc3R5bGUuZGlzcGxheSA9ICdub25lJ1xuICAgICAgICAgICAgICBub3Rlc1dyYXAucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpXG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgLy8gLS0gcmVzZXRcbiAgICAgICAgICAgICAgbm90ZXMubWFwKG5vdGUgPT4ge1xuICAgICAgICAgICAgICAgIG5vdGUuc3R5bGUuZGlzcGxheSA9ICdub25lJyBcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLy8gLS1cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIG5vdGUuc3R5bGUuZGlzcGxheSA9ICd0YWJsZS1yb3cnXG5cbiAgICAgICAgICAgICAgbm90ZXNXcmFwLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snXG4gICAgICAgICAgICAgIG5vdGVzV3JhcC5zdHlsZS5wb3NpdGlvbiA9ICdmaXhlZCdcbiAgICAgICAgICAgICAgbm90ZXNXcmFwLnN0eWxlLmJvdHRvbSA9IDBcbiAgICAgICAgICAgICAgbm90ZXNXcmFwLnN0eWxlLmxlZnQgPSAwXG4gICAgICAgICAgICAgIG5vdGVzV3JhcC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnd2hpdGUnXG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICB9XG5cbiAgICB9IGVsc2Uge1xuICAgICAgYmlnU2NyZWVuKClcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBiaWdTY3JlZW4oKSB7XG5cbiAgICBpZiAod2luZG93LmlubmVyV2lkdGggPj0gNjAwKSB7IFxuXG4gICAgICAvLyAtLSByZXNldCBmcm9tIHNtYWxsLXNjcmVlbiB3aGVuIHdpbmRvdy1yZXNpemluZ1xuICAgICAgbm90ZXNXcmFwLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpXG4gICAgICBub3Rlc1dyYXAucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpXG5cbiAgICAgIGlmIChub3Rlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIG5vdGVzLm1hcChub3RlID0+IHtcbiAgICAgICAgICBub3RlLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKVxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgLy8gLS1cblxuXG4gICAgICAvLyAtLSBzZXQgbm90ZXMtd3JhcFxuICAgICAgLy8gICAgd2Ugc2V0IG5vdGVzLXdyYXAgdG8gbGVmdCA9PiBjb250ZW50LWJsb2NrIHdpZHRoP1xuICAgICAgLy8gICAgVE9ETyBkb3VibGUgY2hlY2sgdGhpcywgYXMgdGhlIGNvZGUgc2hvdWxkIGJlXG4gICAgICAvLyAgICA9PiBgc2lkZUNvbHVtbi53aWR0aCArIGNvbnRlbnRCbG9jay53aWR0aGAgaW5zdGVhZFxuICAgICAgbGV0IHNpZGVDb2x1bW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlldy1jb21tZW50LW9wdGlvbnMtd3JhcHBlcicpXG4gICAgICBsZXQgc2lkZUNvbHVtblJlY3QgPSBzaWRlQ29sdW1uLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG5cbiAgICAgIGxldCBjb250ZW50QmxvY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudC13cmFwcGVyIC5yb3cgLmNvbHVtbicpXG4gICAgICBsZXQgY29udGVudEJsb2NrUmVjdCA9IGNvbnRlbnRCbG9jay5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuXG4gICAgICBub3Rlc1dyYXAuc3R5bGUubGVmdCA9IGAke2NvbnRlbnRCbG9ja1JlY3Qud2lkdGh9cHhgXG5cbiAgICAgIC8vIC0tIHBvc2l0aW9uIG5vdGVzIGFsaWduZWQgdG8gZm9vdG5vdGUtcmVmXG4gICAgICByZWZzLmZvckVhY2gocmVmICA9PiB7XG5cbiAgICAgICAgLy8gZ2V0IGZvb3Rub3RlLXJlZiB0b3AgcG9zaXRpb25cbiAgICAgICAgbGV0IHRvcCA9IE1hdGgucm91bmQocmVmLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCAtIG5vdGVzV3JhcC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3ApXG5cbiAgICAgICAgLy8gZ2V0IG5vdGVcbiAgICAgICAgY29uc3QgaWQgPSByZWYuaWQuc3BsaXQoJy0nKS5wb3AoKVxuICAgICAgICBjb25zdCBub3RlID0gbm90ZXMuZmluZChub3RlID0+IG5vdGUuaWQuc3BsaXQoJy0nKS5wb3AoKSA9PT0gaWQpXG5cbiAgICAgICAgaWYgKG5vdGUpIHtcblxuICAgICAgICAgIC8vIHNldCBub3RlIHRvIGZvb3Rub3RlLXJlZiB0b3AgcG9zaXRpb25cbiAgICAgICAgICBpZiAobm90ZS5wcmV2aW91c0VsZW1lbnRTaWJsaW5nKSB7XG4gICAgICAgICAgICB0b3AgPSBzb2x2ZUZvcihub3RlLCB0b3AsIG5vdGVzV3JhcC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3ApXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbm90ZS5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSdcbiAgICAgICAgICBub3RlLnN0eWxlLnRvcCA9IGAke3RvcH1weGBcbiAgICAgICAgICAvLyAtLVxuXG4gICAgICAgIH1cblxuICAgICAgfSlcblxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHNvbHZlRm9yKGVsLCBjdXJyZW50VG9wLCBwYXJlbnRUb3ApIHtcbiAgICAvLyBnZXQgZm9vdG5vdGUtcmVmIHRvcCBhbmQgaGFuZGxlIHJlZiBvdmVybGFwcGluZyAoZWcgYXQgdGhlIHNhbWUgdG9wIHBvcylcblxuICAgIGNvbnN0IHByZXZpb3VzRWwgPSBlbC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nXG4gICAgY29uc3QgcHJldmlvdXNFbFRvcCA9IHBhcnNlSW50KHByZXZpb3VzRWwuc3R5bGUudG9wLCAxMClcbiAgICBjb25zdCBwcmV2aW91c0VsQm90dG9tID0gcHJldmlvdXNFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5ib3R0b20gLSBwYXJlbnRUb3BcblxuICAgIC8vIGNoZWNrIGZvciBvdmVybGFwc1xuICAgIGlmIChjdXJyZW50VG9wID09PSBwcmV2aW91c0VsVG9wKSB7XG4gICAgICBjb25zdCBuZXdUb3AgPSBjdXJyZW50VG9wICsgcHJldmlvdXNFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHRcbiAgICAgIHJldHVybiBuZXdUb3BcbiAgICB9IGVsc2UgaWYgKGN1cnJlbnRUb3AgPCBwcmV2aW91c0VsQm90dG9tKSB7XG4gICAgICBjb25zdCBuZXdUb3AgPSBwcmV2aW91c0VsQm90dG9tXG4gICAgICByZXR1cm4gbmV3VG9wXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBjdXJyZW50VG9wXG4gICAgfSBcblxuICB9XG5cblxuICAvLyAtLSBmb290bm90ZXMgaW5pdFxuICBjb25zdCByZWZzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucmVmLWZ0JykpXG4gIGNvbnN0IG5vdGVzV3JhcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ub3RlcycpXG4gIGNvbnN0IG5vdGVzID0gQXJyYXkuZnJvbShub3Rlc1dyYXAucXVlcnlTZWxlY3RvckFsbCgnLm5vdGVzIGxpJykpXG5cbiAgc21hbGxTY3JlZW4ocmVmcywgbm90ZXNXcmFwLCBub3RlcylcbiAgYmlnU2NyZWVuKHJlZnMsIG5vdGVzV3JhcCwgbm90ZXMpXG5cbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpID0+IHtcbiAgICBzbWFsbFNjcmVlbihyZWZzLCBub3Rlc1dyYXAsIG5vdGVzKVxuICAgIGJpZ1NjcmVlbihyZWZzLCBub3Rlc1dyYXAsIG5vdGVzKVxuICB9KVxuICBcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmb290bm90ZXNEZXNpZ25cbiIsImNvbnN0IExvY2FsU3RvcmUgPSByZXF1aXJlKCcuL2xvY2FsLnN0b3JlJylcblxuYXN5bmMgZnVuY3Rpb24gaGlnaGxpZ2h0c1N5bmMoYXJ0aWNsZV9zbHVnKSB7XG4gIGNvbnN0IHVybCA9IGAvY29zbW8tYXBpLyR7IGFydGljbGVfc2x1ZyB9YFxuXG4gIHJldHVybiBmZXRjaCh1cmwpXG4gICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxuICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgIGNvbnN0IG5ld0RhdGEgPSByZXNwb25zZVxuICAgICAgdGV4dEhpZ2hsaWdodE1lcmdlVW5pcXVlKG5ld0RhdGEsIGFydGljbGVfc2x1ZylcbiAgICB9KVxuICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgIHJldHVybiBbXVxuICB9KTtcblxufVxuXG5mdW5jdGlvbiB0ZXh0SGlnaGxpZ2h0TWVyZ2VVbmlxdWUobmV3RGF0YSwgYXJ0aWNsZV9zbHVnKSB7XG4gIC8vIG1lcmdlIHRoaXMgYXJyYXkgb2YgdGV4dC1oaWdobGlnaHRzIChuZXdEYXRhKVxuICAvLyB3LyBjdXJyZW50IGxvY2FsU3RvcmFnZVsnY29tbWVudC17YXJ0aWNsZS1zbHVnfSddXG4gIC8vIGZpbHRlciBvdXQgY29tbWVudHMgdy9vIGJsb2NrX2lkIGZvciBiYWNrd2FyZCBzdXBwb3J0XG5cbiAgLy8gdGhlIHByb2JsZW0gaXMgdGhhdCB1cG9uIHB1Ymxpc2hpbmcgYW4gYXJ0aWNsZVxuICAvLyB3ZSdyZSByZW1vdmluZyBpdCBmcm9tIHRoZSBzdG9yZSwgYnV0IGl0J3Mgbm90IHJlYWxseVxuICAvLyBiZWluZyByZW1vdmVkICg/KTtcbiAgLy8gc28gd2hlbiBtZXJnaW5nIHRoZSB0d28gc3RvcmVzIChiYWNrZW5kIGFuZCBmcm9udGVuZClcbiAgLy8gd2UncmUgc3RpbGwgYWRkaW5nIHRoZSBwdWJsaXNoZWQgYXJ0aWNsZXMgdGhhdCB3ZSBzaG91bGRcbiAgLy8gaGF2ZSByZW1vdmVkLiB0d28gd2F5czpcbiAgLy8gLSBmaXggdGhlIHJlbW92ZSBmcm9tIHN0b3JlIGJ1Z1xuICAvLyAtIGZpbHRlciBvdXQgbG9jYWwgc3RvcmUgdG8ga2VlcCBvbmx5IGRyYWZ0IGNvbW1lbnRzXG5cbiAgY29uc3QgY29tbWVudF9zdG9yZSA9IG5ldyBMb2NhbFN0b3JlKGBjb21tZW50LSR7YXJ0aWNsZV9zbHVnfWApO1xuICBsZXQgY29tbWVudHMgPSBjb21tZW50X3N0b3JlLmdldEFsbCgpO1xuICBjb25zdCBkcmFmdHMgPSBjb21tZW50cy5maWx0ZXIoY29tbWVudCA9PiBjb21tZW50LnN0YXR1cyA9PT0gJ2RyYWZ0JylcblxuICBjb25zdCBoaWdobGlnaHRzTWVyZ2VkID0gWy4uLmRyYWZ0cywgLi4ubmV3RGF0YV1cbiAgY29uc3QgaGlnaGxpZ2h0cyA9IGhpZ2hsaWdodHNNZXJnZWQuZmlsdGVyKCh2YWx1ZSwgaW5kZXgsIHNlbGYpID0+IHtcbiAgICByZXR1cm4gaW5kZXggPT09IHNlbGYuZmluZEluZGV4KHQgPT4ge1xuICAgICAgcmV0dXJuIHQuaWQgPT09IHZhbHVlLmlkICYmIHQuY29udGVudC5ibG9ja19pZCAhPT0gbnVsbFxuICAgIH0pXG4gIH0pXG5cbiAgLy8gdG8gbWFrZSBzdXJlIHdlIGp1c3Qgc2V0IG9ubHkgdGhlXG4gIC8vIGxvY2FsU3RvcmUgZHJhZnQgY29tbWVudHMgdG9nZXRoZXIgd2l0aFxuICAvLyB0aGUgcHVibGlzaGVkIGNvbW1lbnRzIGZyb20gdGhlIGJhY2tlbmQ6XG4gIC8vIHdlIHJlbW92ZSBhbmQgc2F2ZSB0aGUgY29tbWVudF9zdG9yZVxuICAvLyBlYWNoIHRpbWUuXG4gIC8vIHRoaXMgbW9zdGx5IHNvbHZlcyB0aGUgcHJvYmxlbVxuICAvLyBvZiByZW1vdmluZyBhIHB1Ymxpc2hlZCBjb21tZW50IGZyb20gdGhlXG4gIC8vIGJhY2tlbmQgd2l0aG91dCB1c2luZyBvdGhlciB3YXlzIHRvXG4gIC8vIHBhc3MgdGhhdCByZWZlcmVuY2UgdG8gdGhlIGZyb250ZW5kIGFuZFxuICAvLyByZW1vdmUgaXQgZnJvbSB0aGUgbG9jYWxTdG9yZS5cbiAgLy8gYnJ1dGFsLCBidXQgb3ZlcmFsbCBmaW5lICE6XG4gIGNvbW1lbnRfc3RvcmUucmVtb3ZlQWxsKClcbiAgY29tbWVudF9zdG9yZS5zYXZlKGhpZ2hsaWdodHMpXG59XG5cbm1vZHVsZS5leHBvcnRzID0gaGlnaGxpZ2h0c1N5bmNcbiIsIi8vIDxodHRwczovL2dpdGh1Yi5jb20vYWxpZW56aG91L3dlYi1oaWdobGlnaHRlci9ibG9iL21hc3Rlci9leGFtcGxlL2xvY2FsLnN0b3JlLmpzPlxuXG5jbGFzcyBMb2NhbFN0b3JlIHtcbiAgICBjb25zdHJ1Y3RvcihpZCkge1xuICAgICAgICB0aGlzLmtleSA9IGlkICE9PSB1bmRlZmluZWQgPyBgY29zbW8tJHtpZH1gIDogJ2Nvc21vLWhpZ2hsaWdodCc7XG4gICAgfVxuXG4gICAgc3RvcmVUb0pzb24oKSB7XG4gICAgICAgIGNvbnN0IHN0b3JlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5rZXkpO1xuICAgICAgICBsZXQgc291cmNlcztcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHNvdXJjZXMgPSBKU09OLnBhcnNlKHN0b3JlKSB8fCBbXTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgc291cmNlcyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb3VyY2VzO1xuICAgIH1cblxuICAgIGpzb25Ub1N0b3JlKHN0b3Jlcykge1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLmtleSwgSlNPTi5zdHJpbmdpZnkoc3RvcmVzKSk7XG4gICAgfVxuXG4gICAgc2F2ZShkYXRhKSB7XG4gICAgICAgIGNvbnN0IHN0b3JlcyA9IHRoaXMuc3RvcmVUb0pzb24oKTtcbiAgICAgICAgY29uc3QgbWFwID0ge307XG4gICAgICAgIHN0b3Jlcy5mb3JFYWNoKChzdG9yZSwgaWR4KSA9PiBtYXBbc3RvcmUuaWRdID0gaWR4KTtcblxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZGF0YSkpIHtcbiAgICAgICAgICAgIGRhdGEgPSBbZGF0YV07XG4gICAgICAgIH1cblxuICAgICAgICBkYXRhLmZvckVhY2goc3RvcmUgPT4ge1xuICAgICAgICAgICAgLy8gdXBkYXRlXG4gICAgICAgICAgICBpZiAobWFwW3N0b3JlLmlkXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc3RvcmVzW21hcFtzdG9yZS5pZF1dID0gc3RvcmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBhcHBlbmRcbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHN0b3Jlcy5wdXNoKHN0b3JlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgdGhpcy5qc29uVG9TdG9yZShzdG9yZXMpO1xuICAgIH1cblxuICAgIGZvcmNlU2F2ZShzdG9yZSkge1xuICAgICAgICBjb25zdCBzdG9yZXMgPSB0aGlzLnN0b3JlVG9Kc29uKCk7XG4gICAgICAgIHN0b3Jlcy5wdXNoKHN0b3JlKTtcbiAgICAgICAgdGhpcy5qc29uVG9TdG9yZShzdG9yZXMpO1xuICAgIH1cblxuICAgIHJlbW92ZShpZCkge1xuICAgICAgICBjb25zdCBzdG9yZXMgPSB0aGlzLnN0b3JlVG9Kc29uKCk7XG4gICAgICAgIGxldCBpbmRleCA9IG51bGw7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RvcmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoc3RvcmVzW2ldLmlkID09PSBpZCkge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzdG9yZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgdGhpcy5qc29uVG9TdG9yZShzdG9yZXMpO1xuICAgIH1cblxuICAgIGdldEJ5SUQoaWQpIHtcbiAgICAgICAgY29uc3Qgc3RvcmVzID0gdGhpcy5zdG9yZVRvSnNvbigpO1xuICAgICAgICBsZXQgaW5kZXggPSBudWxsO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0b3Jlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmIChzdG9yZXNbaV0uaWQgPT09IGlkKSB7XG4gICAgICAgICAgICBpbmRleCA9IGk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzdG9yZSA9IHN0b3Jlcy5maW5kKHMgPT4gcy5pZCA9PT0gaWQpO1xuICAgICAgICByZXR1cm4gc3RvcmU7XG4gICAgfVxuXG4gICAgZ2V0QWxsKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yZVRvSnNvbigpO1xuICAgIH1cblxuICAgIHJlbW92ZUFsbCgpIHtcbiAgICAgICAgdGhpcy5qc29uVG9TdG9yZShbXSk7XG4gICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IExvY2FsU3RvcmVcbiIsImNvbnN0IHRleHRIaWdobGlnaHQgPSByZXF1aXJlKCcuLi90ZXh0LWhpZ2hsaWdodCcpXG5jb25zdCB7IGJsb2NrRm9jdXMsIGNvbW1lbnRzIH0gPSByZXF1aXJlKCcuLi9jb21tZW50cycpXG5jb25zdCBMb2NhbFN0b3JlID0gcmVxdWlyZSgnLi4vbG9jYWwuc3RvcmUnKVxuY29uc3QgeyBjb21tZW50UmV2aWV3TGlzdCB9ID0gcmVxdWlyZSgnLi4vY29tbWVudC1yZXZpZXcnKVxuY29uc3Qgdmlld01vZGUgPSByZXF1aXJlKCcuLi92aWV3LW1vZGUnKVxuY29uc3QgZm9vdG5vdGVzRGVzaWduID0gcmVxdWlyZSgnLi4vZm9vdG5vdGVzLWRlc2lnbicpXG5cbjsoYXN5bmMoKSA9PiB7XG4gIFxuICBjb25zdCBhcnRpY2xlX3NsdWcgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKS5wb3AoKS5zcGxpdCgnLycpLmpvaW4oJysnKVxuXG4gIC8vIHRleHQtaGlnaGxpZ2h0XG4gIGNvbnN0IGFydGljbGVfZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoICdtYWluJyApXG4gIGNvbnN0IHNlbGVjdGlvbl90b29sYmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvciggJy50b29sYmFyJyApXG5cbiAgYXdhaXQgdGV4dEhpZ2hsaWdodChhcnRpY2xlX2VsZW1lbnQsIHNlbGVjdGlvbl90b29sYmFyLCBhcnRpY2xlX3NsdWcpXG5cbiAgLy8gY29tbWVudHNcbiAgY29tbWVudHMoYXJ0aWNsZV9zbHVnKVxuXG4gIC8vIHZpZXctbW9kZVxuICB2aWV3TW9kZSgpXG5cbiAgLy8gY29tbWVudC1yZXZpZXcgbGlzdFxuICBjb21tZW50UmV2aWV3TGlzdChhcnRpY2xlX3NsdWcpXG5cbiAgYmxvY2tGb2N1cygpXG5cbiAgLy8gZm9vdG5vdGVzIGRlc2lnblxuICBmb290bm90ZXNEZXNpZ24oKVxuXG59KSgpXG4iLCJjb25zdCBoaWdobGlnaHRzU3luYyA9IHJlcXVpcmUoJy4vaGlnaGxpZ2h0cy1zeW5jJylcbmNvbnN0IEhpZ2hsaWdodGVyID0gcmVxdWlyZSgnd2ViLWhpZ2hsaWdodGVyJylcbmNvbnN0IExvY2FsU3RvcmUgPSByZXF1aXJlKCcuL2xvY2FsLnN0b3JlJylcblxuXG4vLyA8aHR0cHM6Ly9naXRodWIuY29tL2FsaWVuemhvdS93ZWItaGlnaGxpZ2h0ZXIvYmxvYi9tYXN0ZXIvZXhhbXBsZS9pbmRleC5qcz5cbmFzeW5jIGZ1bmN0aW9uIHRleHRIaWdobGlnaHQodGFyZ2V0LCB0b29sYmFyLCBhcnRpY2xlX3NsdWcpIHtcblxuICBjb25zdCBoaWdobGlnaHRlciA9IG5ldyBIaWdobGlnaHRlcih7XG4gICAgJHJvb3Q6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50LXdyYXBwZXInKSxcbiAgICB3cmFwVGFnOiAnc3BhbicsXG4gICAgZXhjZXB0U2VsZWN0b3JzOiBbJy5oaWdobGlnaHQtdGlwJywgJ2FzaWRlJ11cbiAgfSlcblxuICBoaWdobGlnaHRlci5zZXRPcHRpb24oe1xuICAgIHN0eWxlOiB7XG4gICAgICBjbGFzc05hbWU6ICdiZ2MtYWNjZW50JyxcbiAgICB9LFxuICB9KVxuXG5cbiAgLy8gLS0gcmVzdG9yZSBhbGwgY29tbWVudHMgKGRyYWZ0cyBhbmQgcHVibGlzaGVkKVxuICAvLyAgICB3aGljaCBhcmUgbWFwcGVkIG9ubHkgdG8gdGV4dC1oaWdobGlnaHRzIHdpdGggYWN0dWFsXG4gIC8vICAgIGNvbW1lbnRzIGF0dGFjaGVkIHRvIGl0XG4gIC8vICAgIE9SIGFyZSBibG9jay1sZXZlbCBjb21tZW50c1xuXG4gIC8vIC0tIHN5bmNocm9uaXplIHRleHQtaGlnaGxpZ2h0cyBiYWNrZW5kIGRhdGEgd2l0aCBsb2NhbFN0b3JhZ2VcbiAgYXdhaXQgaGlnaGxpZ2h0c1N5bmMoYXJ0aWNsZV9zbHVnKVxuICBcbiAgY29uc3QgY29tbWVudF9zdG9yZSA9IG5ldyBMb2NhbFN0b3JlKGBjb21tZW50LSR7YXJ0aWNsZV9zbHVnfWApXG4gIGNvbW1lbnRfc3RvcmUuZ2V0QWxsKCkuZm9yRWFjaChjb21tZW50ID0+IHtcblxuICAgIGlmICh0eXBlb2YgY29tbWVudCA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGlmICgnY29udGVudCcgaW4gY29tbWVudCAmJiBjb21tZW50LmNvbnRlbnQuc2VsZWN0aW9uX3RleHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb25zdCBocyA9IGNvbW1lbnQuY29udGVudC5zZWxlY3Rpb25fdGV4dFxuICAgICAgICBoaWdobGlnaHRlci5mcm9tU3RvcmUoaHMuc3RhcnRNZXRhLCBocy5lbmRNZXRhLCBocy50ZXh0LCBocy5pZClcblxuXG4gICAgICAgIC8vIGlmIGNvbW1lbnQgaXMgYXQgYmxvY2stbGV2ZWwsIGhpZ2hsaWdodCBibG9ja1xuICAgICAgICBpZiAoY29tbWVudC5jb250ZW50LnNlbGVjdGlvbl90ZXh0LnRleHQgPT09IG51bGwgJiYgY29tbWVudC5jb250ZW50LmJsb2NrX2lkICE9PSAnJykge1xuICAgICAgICAgIGNvbnN0IGJsb2NrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmNvbnRlbnQtd3JhcHBlciAjJHtjb21tZW50LmNvbnRlbnQuYmxvY2tfaWR9YClcbiAgICAgICAgICBpZiAoYmxvY2sgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGJsb2NrLmNsYXNzTGlzdC5hZGQoJ2Jsb2NrLWhpZ2hsaWdodCcpXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIGNvbnN0IGhpZ2hsaWdodF9zdG9yZSA9IG5ldyBMb2NhbFN0b3JlKGBjb21tZW50LSR7YXJ0aWNsZV9zbHVnfWApXG5cbiAgLy8gZXhjZXB0IGZvciB0aGUgQ1JFQVRFIGV2ZW50XG4gIC8vIGFueSBvdGhlciBldmVudCBpcyB0cmlnZ2VyZWQgd2hlbiBpbnRlcmFjdGluZ1xuICAvLyB3aXRoIGFuIGV4aXN0aW5nIHNlbGVjdGlvbiBzcGFuXG4gIGhpZ2hsaWdodGVyXG4gICAgLm9uKEhpZ2hsaWdodGVyLmV2ZW50LkNMSUNLLCAoe2lkfSkgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ2NsaWNrIC0nLCBpZCk7XG4gICAgfSlcbiAgICAub24oSGlnaGxpZ2h0ZXIuZXZlbnQuSE9WRVIsICh7aWR9KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnaG92ZXIgLScsIGlkKTtcbiAgICAgIGhpZ2hsaWdodGVyLmFkZENsYXNzKCdoaWdobGlnaHQtd3JhcC1ob3ZlcicsIGlkKTtcbiAgICB9KVxuICAgIC5vbihIaWdobGlnaHRlci5ldmVudC5IT1ZFUl9PVVQsICh7aWR9KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnaG92ZXIgb3V0IC0nLCBpZCk7XG4gICAgICBoaWdobGlnaHRlci5yZW1vdmVDbGFzcygnaGlnaGxpZ2h0LXdyYXAtaG92ZXInLCBpZCk7XG4gICAgfSlcbiAgICAub24oSGlnaGxpZ2h0ZXIuZXZlbnQuQ1JFQVRFLCAoe3NvdXJjZXN9KSA9PiB7XG4gICAgICAvLyBjb25zb2xlLmxvZygnQ1JFQVRFJylcblxuICAgICAgLy8gY2xvc2UgdGhlIGNvbW1lbnQgYm94IGlmIGl0IGlzIHRvZ2dsZWRcbiAgICAgIHRvb2xiYXJfaGlkZSh0b29sYmFyKVxuXG4gICAgICAvLyBjcmVhdGUgc3BhbiB0byBhbGxvdyByZW1vdmluZyB0aGUgc2VsZWN0aW9uXG4gICAgICBzb3VyY2VzLmZvckVhY2goc291cmNlID0+IHtcblxuICAgICAgICAvLyAtLSBzZXR1cCB0ZXh0LXNlbGVjdGlvblxuICAgICAgICBjb25zdCBzZWxlY3Rpb25Ob2RlID0gaGlnaGxpZ2h0ZXIuZ2V0RG9tcyhzb3VyY2UuaWQpWzBdXG4gICAgICAgIGNvbnN0IGJsb2NrSUQgPSBnZXRCbG9ja0lEKHNlbGVjdGlvbk5vZGUpXG5cbiAgICAgICAgaWYgKGJsb2NrSUQgPT0gbnVsbCkge1xuICAgICAgICAgIC8vIGlmIGJsb2NrSUQgaXMgbWlzc2luZyBvciBub3Qgc2V0LFxuICAgICAgICAgIC8vIHN0b3AgZXZlcnl0aGluZ1xuICAgICAgICAgIHJlbW92ZVNlbGVjdGlvbihoaWdobGlnaHRlciwgc291cmNlLmlkKVxuICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdXNlcl9zdG9yZSA9IG5ldyBMb2NhbFN0b3JlKCd1c2VyJylcbiAgICAgICAgY29uc3QgdXNlciA9IHVzZXJfc3RvcmUuZ2V0QnlJRChhcnRpY2xlX3NsdWcpXG5cbiAgICAgICAgLy8gLS0gdG9nZ2xlIGNvbW1lbnQgaW5wdXQgZm9ybVxuICAgICAgICBjb25zdCBwb3NpdGlvblRvb2xiYXIgPSBnZXRDb29yZHMoc2VsZWN0aW9uTm9kZSlcbiAgICAgICAgY29uc3QgYmxvY2tfdHlwZSA9ICd0ZXh0J1xuICAgICAgICB0b2dnbGVfdG9vbGJhcihwb3NpdGlvblRvb2xiYXIsIHRvb2xiYXIsIGJsb2NrX3R5cGUsIHNvdXJjZS5pZCwgYmxvY2tJRCwgdXNlcilcbiAgICAgICAgXG4gICAgICAgIC8vIC0tIHNhdmUgdGV4dC1zZWxlY3Rpb24gdG8gaGlnaGxpZ2h0X3N0b3JlXG4gICAgICAgIGhpZ2hsaWdodF9zdG9yZS5zYXZlKHNvdXJjZSlcblxuICAgICAgICBjb25zdCBmb3JtID0gdG9vbGJhci5xdWVyeVNlbGVjdG9yKCdmb3JtJylcbiAgICAgICAgZm9ybS5xdWVyeVNlbGVjdG9yKCcjc2VsZWN0aW9uX3RleHQnKS52YWx1ZSA9IEpTT04uc3RyaW5naWZ5KHNvdXJjZSlcbiAgICAgIH0pXG5cbiAgICAgfSlcbiAgICAub24oSGlnaGxpZ2h0ZXIuZXZlbnQuUkVNT1ZFLCAoe2lkc30pID0+IHtcbiAgICAgIC8vIFRPRE8gaW1wbGVtZW50IHJlbW92ZSBhY3Rpb25cbiAgICAgIGNvbnNvbGUubG9nKCdyZW1vdmUgLScsIGlkcyk7XG4gICAgICAvLyBpZHMuZm9yRWFjaChpZCA9PiBzdG9yZS5yZW1vdmUoaWQpKTtcbiAgICB9KTtcblxuICAvLyAtLSA9PiBzdGFydCBoaWdobGlnaHRlclxuICBoaWdobGlnaHRlci5ydW4oKTtcblxuICBmdW5jdGlvbiByZW1vdmVTZWxlY3Rpb24oaGlnaGxpZ2h0ZXIsIGlkKSB7XG4gICAgaGlnaGxpZ2h0ZXIucmVtb3ZlKGlkKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEJsb2NrSUQobm9kZSkge1xuICAgIGNvbnN0IGJsb2NrID0gbm9kZS5jbG9zZXN0KCdzZWN0aW9uIC5ibG9jaycpXG5cbiAgICBpZiAoYmxvY2sgIT09IHVuZGVmaW5lZCAmJiBibG9jayAhPT0gbnVsbCkge1xuICAgICAgaWYgKGJsb2NrLmlkKSB7XG4gICAgICAgIHJldHVybiBibG9jay5pZFxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAobm9kZS5wYXJlbnROb2RlLmRhdGFzZXQuYmlkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIC8vIHRoaXMgY2hlY2tzIGlmIGluc3RlYWQgb2YgYSBibG9jayB3ZSdyZSBoaWdobGlnaHRpbmdcbiAgICAgIC8vIGEgZm9vdG5vdGUgd2l0aCBET00gPGxpIGlkPW5vdGUtcmVmLTxyZWY+IGRhdGEtYmlkPTxiaWQ+PlxuICAgICAgcmV0dXJuIG5vZGUucGFyZW50Tm9kZS5kYXRhc2V0LmJpZFxuXG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIGZ1bmN0aW9uIHRvZ2dsZV90b29sYmFyKHBvc2l0aW9uLCB0b29sYmFyLCBibG9ja1R5cGUsIHNvdXJjZUlELCBibG9ja0lELCB1c2VyKSB7XG4gICAgY29uc3QgZm9ybSA9IHRvb2xiYXIucXVlcnlTZWxlY3RvcignZm9ybScpXG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoJ2RhdGEtYmxvY2stc2VsZWN0aW9uLXR5cGUnLCBibG9ja1R5cGUpXG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoJ2RhdGEtYmxvY2stY29tbWVudC1pZCcsIHNvdXJjZUlEKVxuICAgIGZvcm0uc2V0QXR0cmlidXRlKCdkYXRhLWJsb2NrLWlkJywgYmxvY2tJRClcblxuICAgIGZvcm0ucXVlcnlTZWxlY3RvcignI3NlbGVjdGlvbl90eXBlJykudmFsdWUgPSBibG9ja1R5cGVcbiAgICBmb3JtLnF1ZXJ5U2VsZWN0b3IoJyNibG9ja19pZCcpLnZhbHVlID0gYmxvY2tJRFxuICAgIGZvcm0ucXVlcnlTZWxlY3RvcignI2F1dGhvcicpLnZhbHVlID0gdXNlci52YWx1ZVxuXG4gICAgLy8gLS0gZGlzcGxheSBpbnB1dCBmb3JtIGZvciBhZGRpbmcgYSBjb21tZW50XG4gICAgdG9vbGJhci5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKVxuICAgIHRvb2xiYXIuc3R5bGUuc2V0UHJvcGVydHkoICctLXRvcCcsIGAke3Bvc2l0aW9uLnRvcH1weGAgKVxuICAgIHRvb2xiYXIuc3R5bGUuc2V0UHJvcGVydHkoICctLWxlZnQnLCBgJHtwb3NpdGlvbi5sZWZ0ICsgcG9zaXRpb24ud2lkdGh9cHhgIClcblxuICAgIC8vIGhhbmRsZSBjbGljayBidXR0b24gdG8gaGlkZVxuICAgIGNvbnN0IGJ0bl9oaWRlID0gdG9vbGJhci5xdWVyeVNlbGVjdG9yKCcudG9vbGJhci1idG4taGlkZScpXG4gICAgYnRuX2hpZGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0b29sYmFyX2hpZGUodG9vbGJhcilcblxuICAgICAgY29uc3QgdGlwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtaWQ9XCIke3NvdXJjZUlEfVwiXWApXG4gICAgICByZW1vdmVTZWxlY3Rpb24oaGlnaGxpZ2h0ZXIsIHNvdXJjZUlEKVxuICAgIH0pXG5cbiAgfVxuXG4gIGZ1bmN0aW9uIHRvb2xiYXJfaGlkZSh0b29sYmFyKSB7XG4gICAgdG9vbGJhci5jbGFzc0xpc3QuYWRkKCAnaGlkZGVuJyApXG4gICAgdG9vbGJhci5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnLS10b3AnKVxuICAgIHRvb2xiYXIuc3R5bGUucmVtb3ZlUHJvcGVydHkoJy0tbGVmdCcpXG4gIH1cblxuICBmdW5jdGlvbiBnZXRDb29yZHMoZWxlbSkge1xuICAgIGxldCBib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvcDogYm94LnRvcCArIHdpbmRvdy5wYWdlWU9mZnNldCxcbiAgICAgIGxlZnQ6IGJveC5sZWZ0ICsgd2luZG93LnBhZ2VYT2Zmc2V0LFxuICAgICAgd2lkdGg6IGJveC53aWR0aCxcbiAgICAgIGhlaWdodDogYm94LmhlaWdodFxuICAgIH07XG4gIH1cblxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHRleHRIaWdobGlnaHQ7XG4iLCJmdW5jdGlvbiB2aWV3TW9kZSgpIHtcbiAgY29uc3Qgdmlld09wdGlvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlldy1vcHRpb25zJylcblxuICBjb25zdCBzZWxlY3RlZFZpZXcgPSB2aWV3T3B0aW9ucy5xdWVyeVNlbGVjdG9yKCdpbnB1dDpjaGVja2VkJylcbiAgY29uc3QgaW5wdXRzID0gQXJyYXkuZnJvbSh2aWV3T3B0aW9ucy5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpKVxuXG4gIGlucHV0cy5tYXAoaW5wdXQgPT4ge1xuICAgIC8vIHNldCB2aWV3IGJhc2VkIG9uIGN1cnJlbnRseSBzZWxlY3RlZCBpbnB1dCByYWRpb1xuICAgIC8vIChlZyBnb29kIGZvciBwYWdlIGxvYWQgLyByZWZyZXNoKVxuICAgIGlmIChpbnB1dC5jaGVja2VkKSB7XG4gICAgICB0b2dnbGVWaWV3KGlucHV0LnZhbHVlKSBcbiAgICB9XG5cbiAgICAvLyBzZXQgdmlldyBiYXNlZCBvbiBjbGlja2VkIGlucHV0IHJhZGlvIFxuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0XG4gICAgICB0b2dnbGVWaWV3KHRhcmdldC52YWx1ZSkgXG4gICAgfSlcbiAgfSlcblxufVxuXG5mdW5jdGlvbiB0b2dnbGVWaWV3KHRhcmdldFZhbHVlKSB7XG4gIGNvbnN0IGNvbHVtbnMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250ZW50LXdyYXBwZXIgLmNvbHVtbicpKVxuICBjb25zdCBibG9ja3MgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250ZW50LXdyYXBwZXIgLmJsb2NrJykpXG4gIGNvbnN0IGJsb2Nrc0NvbnRlbnQgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250ZW50LXdyYXBwZXIgLmJsb2NrID4gLmNvbnRlbnRzJykpXG4gIGNvbnN0IGFzaWRlcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYXNpZGUnKSlcbiAgY29uc3QgdGhyZWFkcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRocmVhZCcpKVxuXG4gIC8vIHJlc2V0IGN1c3RvbSBzZXR0aW5ncyBiYXNlZCBvbiBzcGVjaWZpYyB2aWV3XG4gIGNvbHVtbnMubWFwKGNvbHVtbiA9PiB7XG4gICAgY29sdW1uLnNldEF0dHJpYnV0ZSgnZGF0YS1jb2wtd2lkdGgnLCAnMS8xJylcbiAgfSlcblxuICBibG9ja3MubWFwKGJsb2NrID0+IHtcbiAgICBibG9jay5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKVxuICAgIGJsb2NrLnN0eWxlLmJveFNoYWRvdyA9ICd2YXIoLS1ncmlkc2hhZG93KSdcbiAgICBibG9jay5zdHlsZS5wYWRkaW5nID0gJzAuNXJlbSdcbiAgfSlcblxuICBibG9ja3NDb250ZW50Lm1hcChibG9jayA9PiB7XG4gICAgYmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnZm9udC1zaXplLW1pY3JvJylcbiAgICBibG9jay5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKVxuICB9KVxuXG4gIGFzaWRlcy5tYXAoYXNpZGUgPT4ge1xuICAgIGFzaWRlLnN0eWxlLm1heFdpZHRoID0gJ3ZhcigtLXNpZGUtd2lkdGgpJ1xuICAgIGFzaWRlLnN0eWxlLndpZHRoID0gJ3ZhcigtLXNpZGUtd2lkdGgpJ1xuICAgIGFzaWRlLnN0eWxlLnNldFByb3BlcnR5KCctLW4nLCAnMScpXG4gIH0pXG4gIHRocmVhZHMubWFwKHRocmVhZCA9PiB0aHJlYWQuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJykpXG5cbiAgc3dpdGNoKHRhcmdldFZhbHVlKSB7XG4gIGNhc2UgJzEnOlxuICAgIC8vIGRpc3BsYXkgb25seSBhcnRpY2xlLWJsb2Nrc1xuICAgIHRocmVhZHMubWFwKHRocmVhZCA9PiB0aHJlYWQuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJykpXG4gICAgYnJlYWs7XG5cbiAgY2FzZSAnMic6XG4gICAgLy8gZGlzcGxheSBhcnRpY2xlLWJsb2NrcyArIGNvbW1lbnRzXG4gICAgYnJlYWs7XG5cbiAgY2FzZSAnMyc6XG4gICAgLy8gZGlzcGxheSBjb21tZW50cyArIGFydGljbGUtYmxvY2tzXG4gICAgY29sdW1ucy5tYXAoY29sdW1uID0+IHtcbiAgICAgIGNvbHVtbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtY29sLXdpZHRoJywgJzEvNCcpXG4gICAgfSlcblxuICAgIGJsb2Nrc0NvbnRlbnQubWFwKGJsb2NrID0+IHtcbiAgICAgIGJsb2NrLmNsYXNzTGlzdC5hZGQoJ2ZvbnQtc2l6ZS1taWNybycpXG4gICAgfSlcblxuICAgIGFzaWRlcy5tYXAoYXNpZGUgPT4ge1xuICAgICAgYXNpZGUuc3R5bGUud2lkdGggPSAnNjd2dydcbiAgICAgIGFzaWRlLnN0eWxlLm1heFdpZHRoID0gJzY3dncnXG4gICAgICBhc2lkZS5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1uJywgJzQnKVxuICAgIH0pXG5cbiAgICBicmVhaztcblxuICBjYXNlICc0JzpcbiAgICAvLyBkaXNwbGF5IGNvbW1lbnRzXG5cbiAgICBjb2x1bW5zLm1hcChjb2x1bW4gPT4ge1xuICAgICAgY29sdW1uLnNldEF0dHJpYnV0ZSgnZGF0YS1jb2wtd2lkdGgnLCAnMS80JylcbiAgICB9KVxuXG4gICAgYmxvY2tzLm1hcChibG9jayA9PiB7XG4gICAgICBibG9jay5zdHlsZS5ib3hTaGFkb3cgPSAnbm9uZSdcbiAgICAgIGJsb2NrLnN0eWxlLnBhZGRpbmcgPSAnMCdcbiAgICAgIGNvbnNvbGUubG9nKCdibG9jayA9PicsIGJsb2NrKVxuICAgIH0pXG5cbiAgICBibG9ja3NDb250ZW50Lm1hcChibG9jayA9PiB7XG4gICAgICBibG9jay5jbGFzc0xpc3QuYWRkKCdmb250LXNpemUtbWljcm8nKVxuICAgICAgYmxvY2suY2xhc3NMaXN0LmFkZCgnaGlkZGVuJylcbiAgICB9KVxuXG4gICAgYXNpZGVzLm1hcChhc2lkZSA9PiB7XG4gICAgICBhc2lkZS5zdHlsZS53aWR0aCA9ICc3OHZ3J1xuICAgICAgYXNpZGUuc3R5bGUubWF4V2lkdGggPSAnNzh2dydcbiAgICAgIGFzaWRlLnN0eWxlLnNldFByb3BlcnR5KCctLW4nLCAnNScpXG4gICAgfSlcblxuICAgIGJyZWFrO1xuXG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB2aWV3TW9kZVxuIiwiLyoqXG4gKiBjc3NmaWx0ZXJcbiAqXG4gKiBAYXV0aG9yIOiAgembtzxsZWl6b25nbWluQGdtYWlsLmNvbT5cbiAqL1xuXG52YXIgREVGQVVMVCA9IHJlcXVpcmUoJy4vZGVmYXVsdCcpO1xudmFyIHBhcnNlU3R5bGUgPSByZXF1aXJlKCcuL3BhcnNlcicpO1xudmFyIF8gPSByZXF1aXJlKCcuL3V0aWwnKTtcblxuXG4vKipcbiAqIOi/lOWbnuWAvOaYr+WQpuS4uuepulxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmpcbiAqIEByZXR1cm4ge0Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzTnVsbCAob2JqKSB7XG4gIHJldHVybiAob2JqID09PSB1bmRlZmluZWQgfHwgb2JqID09PSBudWxsKTtcbn1cblxuLyoqXG4gKiDmtYXmi7fotJ3lr7nosaFcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqXG4gKiBAcmV0dXJuIHtPYmplY3R9XG4gKi9cbmZ1bmN0aW9uIHNoYWxsb3dDb3B5T2JqZWN0IChvYmopIHtcbiAgdmFyIHJldCA9IHt9O1xuICBmb3IgKHZhciBpIGluIG9iaikge1xuICAgIHJldFtpXSA9IG9ialtpXTtcbiAgfVxuICByZXR1cm4gcmV0O1xufVxuXG4vKipcbiAqIOWIm+W7ukNTU+i/h+a7pOWZqFxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gKiAgIC0ge09iamVjdH0gd2hpdGVMaXN0XG4gKiAgIC0ge0Z1bmN0aW9ufSBvbkF0dHJcbiAqICAgLSB7RnVuY3Rpb259IG9uSWdub3JlQXR0clxuICogICAtIHtGdW5jdGlvbn0gc2FmZUF0dHJWYWx1ZVxuICovXG5mdW5jdGlvbiBGaWx0ZXJDU1MgKG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IHNoYWxsb3dDb3B5T2JqZWN0KG9wdGlvbnMgfHwge30pO1xuICBvcHRpb25zLndoaXRlTGlzdCA9IG9wdGlvbnMud2hpdGVMaXN0IHx8IERFRkFVTFQud2hpdGVMaXN0O1xuICBvcHRpb25zLm9uQXR0ciA9IG9wdGlvbnMub25BdHRyIHx8IERFRkFVTFQub25BdHRyO1xuICBvcHRpb25zLm9uSWdub3JlQXR0ciA9IG9wdGlvbnMub25JZ25vcmVBdHRyIHx8IERFRkFVTFQub25JZ25vcmVBdHRyO1xuICBvcHRpb25zLnNhZmVBdHRyVmFsdWUgPSBvcHRpb25zLnNhZmVBdHRyVmFsdWUgfHwgREVGQVVMVC5zYWZlQXR0clZhbHVlO1xuICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xufVxuXG5GaWx0ZXJDU1MucHJvdG90eXBlLnByb2Nlc3MgPSBmdW5jdGlvbiAoY3NzKSB7XG4gIC8vIOWFvOWuueWQhOenjeWlh+iRqei+k+WFpVxuICBjc3MgPSBjc3MgfHwgJyc7XG4gIGNzcyA9IGNzcy50b1N0cmluZygpO1xuICBpZiAoIWNzcykgcmV0dXJuICcnO1xuXG4gIHZhciBtZSA9IHRoaXM7XG4gIHZhciBvcHRpb25zID0gbWUub3B0aW9ucztcbiAgdmFyIHdoaXRlTGlzdCA9IG9wdGlvbnMud2hpdGVMaXN0O1xuICB2YXIgb25BdHRyID0gb3B0aW9ucy5vbkF0dHI7XG4gIHZhciBvbklnbm9yZUF0dHIgPSBvcHRpb25zLm9uSWdub3JlQXR0cjtcbiAgdmFyIHNhZmVBdHRyVmFsdWUgPSBvcHRpb25zLnNhZmVBdHRyVmFsdWU7XG5cbiAgdmFyIHJldENTUyA9IHBhcnNlU3R5bGUoY3NzLCBmdW5jdGlvbiAoc291cmNlUG9zaXRpb24sIHBvc2l0aW9uLCBuYW1lLCB2YWx1ZSwgc291cmNlKSB7XG5cbiAgICB2YXIgY2hlY2sgPSB3aGl0ZUxpc3RbbmFtZV07XG4gICAgdmFyIGlzV2hpdGUgPSBmYWxzZTtcbiAgICBpZiAoY2hlY2sgPT09IHRydWUpIGlzV2hpdGUgPSBjaGVjaztcbiAgICBlbHNlIGlmICh0eXBlb2YgY2hlY2sgPT09ICdmdW5jdGlvbicpIGlzV2hpdGUgPSBjaGVjayh2YWx1ZSk7XG4gICAgZWxzZSBpZiAoY2hlY2sgaW5zdGFuY2VvZiBSZWdFeHApIGlzV2hpdGUgPSBjaGVjay50ZXN0KHZhbHVlKTtcbiAgICBpZiAoaXNXaGl0ZSAhPT0gdHJ1ZSkgaXNXaGl0ZSA9IGZhbHNlO1xuXG4gICAgLy8g5aaC5p6c6L+H5ruk5ZCOIHZhbHVlIOS4uuepuuWImeebtOaOpeW/veeVpVxuICAgIHZhbHVlID0gc2FmZUF0dHJWYWx1ZShuYW1lLCB2YWx1ZSk7XG4gICAgaWYgKCF2YWx1ZSkgcmV0dXJuO1xuXG4gICAgdmFyIG9wdHMgPSB7XG4gICAgICBwb3NpdGlvbjogcG9zaXRpb24sXG4gICAgICBzb3VyY2VQb3NpdGlvbjogc291cmNlUG9zaXRpb24sXG4gICAgICBzb3VyY2U6IHNvdXJjZSxcbiAgICAgIGlzV2hpdGU6IGlzV2hpdGVcbiAgICB9O1xuXG4gICAgaWYgKGlzV2hpdGUpIHtcblxuICAgICAgdmFyIHJldCA9IG9uQXR0cihuYW1lLCB2YWx1ZSwgb3B0cyk7XG4gICAgICBpZiAoaXNOdWxsKHJldCkpIHtcbiAgICAgICAgcmV0dXJuIG5hbWUgKyAnOicgKyB2YWx1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgICB9XG5cbiAgICB9IGVsc2Uge1xuXG4gICAgICB2YXIgcmV0ID0gb25JZ25vcmVBdHRyKG5hbWUsIHZhbHVlLCBvcHRzKTtcbiAgICAgIGlmICghaXNOdWxsKHJldCkpIHtcbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgIH1cblxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHJldENTUztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBGaWx0ZXJDU1M7XG4iLCIvKipcbiAqIGNzc2ZpbHRlclxuICpcbiAqIEBhdXRob3Ig6ICB6Zu3PGxlaXpvbmdtaW5AZ21haWwuY29tPlxuICovXG5cbmZ1bmN0aW9uIGdldERlZmF1bHRXaGl0ZUxpc3QgKCkge1xuICAvLyDnmb3lkI3ljZXlgLzor7TmmI7vvJpcbiAgLy8gdHJ1ZTog5YWB6K646K+l5bGe5oCnXG4gIC8vIEZ1bmN0aW9uOiBmdW5jdGlvbiAodmFsKSB7IH0g6L+U5ZuedHJ1ZeihqOekuuWFgeiuuOivpeWxnuaAp++8jOWFtuS7luWAvOWdh+ihqOekuuS4jeWFgeiuuFxuICAvLyBSZWdFeHA6IHJlZ2V4cC50ZXN0KHZhbCkg6L+U5ZuedHJ1ZeihqOekuuWFgeiuuOivpeWxnuaAp++8jOWFtuS7luWAvOWdh+ihqOekuuS4jeWFgeiuuFxuICAvLyDpmaTkuIrpnaLliJflh7rnmoTlgLzlpJblnYfooajnpLrkuI3lhYHorrhcbiAgdmFyIHdoaXRlTGlzdCA9IHt9O1xuXG4gIHdoaXRlTGlzdFsnYWxpZ24tY29udGVudCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WydhbGlnbi1pdGVtcyddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WydhbGlnbi1zZWxmJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ2FsaWdubWVudC1hZGp1c3QnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnYWxpZ25tZW50LWJhc2VsaW5lJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYmFzZWxpbmVcbiAgd2hpdGVMaXN0WydhbGwnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBkZXBlbmRpbmcgb24gaW5kaXZpZHVhbCBwcm9wZXJ0aWVzXG4gIHdoaXRlTGlzdFsnYW5jaG9yLXBvaW50J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2FuaW1hdGlvbiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGRlcGVuZGluZyBvbiBpbmRpdmlkdWFsIHByb3BlcnRpZXNcbiAgd2hpdGVMaXN0WydhbmltYXRpb24tZGVsYXknXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiAwXG4gIHdoaXRlTGlzdFsnYW5pbWF0aW9uLWRpcmVjdGlvbiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vcm1hbFxuICB3aGl0ZUxpc3RbJ2FuaW1hdGlvbi1kdXJhdGlvbiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IDBcbiAgd2hpdGVMaXN0WydhbmltYXRpb24tZmlsbC1tb2RlJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2FuaW1hdGlvbi1pdGVyYXRpb24tY291bnQnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiAxXG4gIHdoaXRlTGlzdFsnYW5pbWF0aW9uLW5hbWUnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsnYW5pbWF0aW9uLXBsYXktc3RhdGUnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBydW5uaW5nXG4gIHdoaXRlTGlzdFsnYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGVhc2VcbiAgd2hpdGVMaXN0WydhemltdXRoJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogY2VudGVyXG4gIHdoaXRlTGlzdFsnYmFja2ZhY2UtdmlzaWJpbGl0eSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IHZpc2libGVcbiAgd2hpdGVMaXN0WydiYWNrZ3JvdW5kJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBkZXBlbmRpbmcgb24gaW5kaXZpZHVhbCBwcm9wZXJ0aWVzXG4gIHdoaXRlTGlzdFsnYmFja2dyb3VuZC1hdHRhY2htZW50J10gPSB0cnVlOyAvLyBkZWZhdWx0OiBzY3JvbGxcbiAgd2hpdGVMaXN0WydiYWNrZ3JvdW5kLWNsaXAnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IGJvcmRlci1ib3hcbiAgd2hpdGVMaXN0WydiYWNrZ3JvdW5kLWNvbG9yJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiB0cmFuc3BhcmVudFxuICB3aGl0ZUxpc3RbJ2JhY2tncm91bmQtaW1hZ2UnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0WydiYWNrZ3JvdW5kLW9yaWdpbiddID0gdHJ1ZTsgLy8gZGVmYXVsdDogcGFkZGluZy1ib3hcbiAgd2hpdGVMaXN0WydiYWNrZ3JvdW5kLXBvc2l0aW9uJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiAwJSAwJVxuICB3aGl0ZUxpc3RbJ2JhY2tncm91bmQtcmVwZWF0J10gPSB0cnVlOyAvLyBkZWZhdWx0OiByZXBlYXRcbiAgd2hpdGVMaXN0WydiYWNrZ3JvdW5kLXNpemUnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WydiYXNlbGluZS1zaGlmdCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGJhc2VsaW5lXG4gIHdoaXRlTGlzdFsnYmluZGluZyddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0WydibGVlZCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IDZwdFxuICB3aGl0ZUxpc3RbJ2Jvb2ttYXJrLWxhYmVsJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogY29udGVudCgpXG4gIHdoaXRlTGlzdFsnYm9va21hcmstbGV2ZWwnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsnYm9va21hcmstc3RhdGUnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBvcGVuXG4gIHdoaXRlTGlzdFsnYm9yZGVyJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBkZXBlbmRpbmcgb24gaW5kaXZpZHVhbCBwcm9wZXJ0aWVzXG4gIHdoaXRlTGlzdFsnYm9yZGVyLWJvdHRvbSddID0gdHJ1ZTsgLy8gZGVmYXVsdDogZGVwZW5kaW5nIG9uIGluZGl2aWR1YWwgcHJvcGVydGllc1xuICB3aGl0ZUxpc3RbJ2JvcmRlci1ib3R0b20tY29sb3InXSA9IHRydWU7IC8vIGRlZmF1bHQ6IGN1cnJlbnQgY29sb3JcbiAgd2hpdGVMaXN0Wydib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiAwXG4gIHdoaXRlTGlzdFsnYm9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXMnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IDBcbiAgd2hpdGVMaXN0Wydib3JkZXItYm90dG9tLXN0eWxlJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsnYm9yZGVyLWJvdHRvbS13aWR0aCddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbWVkaXVtXG4gIHdoaXRlTGlzdFsnYm9yZGVyLWNvbGxhcHNlJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBzZXBhcmF0ZVxuICB3aGl0ZUxpc3RbJ2JvcmRlci1jb2xvciddID0gdHJ1ZTsgLy8gZGVmYXVsdDogZGVwZW5kaW5nIG9uIGluZGl2aWR1YWwgcHJvcGVydGllc1xuICB3aGl0ZUxpc3RbJ2JvcmRlci1pbWFnZSddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2JvcmRlci1pbWFnZS1vdXRzZXQnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IDBcbiAgd2hpdGVMaXN0Wydib3JkZXItaW1hZ2UtcmVwZWF0J10gPSB0cnVlOyAvLyBkZWZhdWx0OiBzdHJldGNoXG4gIHdoaXRlTGlzdFsnYm9yZGVyLWltYWdlLXNsaWNlJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiAxMDAlXG4gIHdoaXRlTGlzdFsnYm9yZGVyLWltYWdlLXNvdXJjZSddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2JvcmRlci1pbWFnZS13aWR0aCddID0gdHJ1ZTsgLy8gZGVmYXVsdDogMVxuICB3aGl0ZUxpc3RbJ2JvcmRlci1sZWZ0J10gPSB0cnVlOyAvLyBkZWZhdWx0OiBkZXBlbmRpbmcgb24gaW5kaXZpZHVhbCBwcm9wZXJ0aWVzXG4gIHdoaXRlTGlzdFsnYm9yZGVyLWxlZnQtY29sb3InXSA9IHRydWU7IC8vIGRlZmF1bHQ6IGN1cnJlbnQgY29sb3JcbiAgd2hpdGVMaXN0Wydib3JkZXItbGVmdC1zdHlsZSddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2JvcmRlci1sZWZ0LXdpZHRoJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBtZWRpdW1cbiAgd2hpdGVMaXN0Wydib3JkZXItcmFkaXVzJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiAwXG4gIHdoaXRlTGlzdFsnYm9yZGVyLXJpZ2h0J10gPSB0cnVlOyAvLyBkZWZhdWx0OiBkZXBlbmRpbmcgb24gaW5kaXZpZHVhbCBwcm9wZXJ0aWVzXG4gIHdoaXRlTGlzdFsnYm9yZGVyLXJpZ2h0LWNvbG9yJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBjdXJyZW50IGNvbG9yXG4gIHdoaXRlTGlzdFsnYm9yZGVyLXJpZ2h0LXN0eWxlJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsnYm9yZGVyLXJpZ2h0LXdpZHRoJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBtZWRpdW1cbiAgd2hpdGVMaXN0Wydib3JkZXItc3BhY2luZyddID0gdHJ1ZTsgLy8gZGVmYXVsdDogMFxuICB3aGl0ZUxpc3RbJ2JvcmRlci1zdHlsZSddID0gdHJ1ZTsgLy8gZGVmYXVsdDogZGVwZW5kaW5nIG9uIGluZGl2aWR1YWwgcHJvcGVydGllc1xuICB3aGl0ZUxpc3RbJ2JvcmRlci10b3AnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IGRlcGVuZGluZyBvbiBpbmRpdmlkdWFsIHByb3BlcnRpZXNcbiAgd2hpdGVMaXN0Wydib3JkZXItdG9wLWNvbG9yJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBjdXJyZW50IGNvbG9yXG4gIHdoaXRlTGlzdFsnYm9yZGVyLXRvcC1sZWZ0LXJhZGl1cyddID0gdHJ1ZTsgLy8gZGVmYXVsdDogMFxuICB3aGl0ZUxpc3RbJ2JvcmRlci10b3AtcmlnaHQtcmFkaXVzJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiAwXG4gIHdoaXRlTGlzdFsnYm9yZGVyLXRvcC1zdHlsZSddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2JvcmRlci10b3Atd2lkdGgnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IG1lZGl1bVxuICB3aGl0ZUxpc3RbJ2JvcmRlci13aWR0aCddID0gdHJ1ZTsgLy8gZGVmYXVsdDogZGVwZW5kaW5nIG9uIGluZGl2aWR1YWwgcHJvcGVydGllc1xuICB3aGl0ZUxpc3RbJ2JvdHRvbSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0Wydib3gtZGVjb3JhdGlvbi1icmVhayddID0gdHJ1ZTsgLy8gZGVmYXVsdDogc2xpY2VcbiAgd2hpdGVMaXN0Wydib3gtc2hhZG93J10gPSB0cnVlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsnYm94LXNpemluZyddID0gdHJ1ZTsgLy8gZGVmYXVsdDogY29udGVudC1ib3hcbiAgd2hpdGVMaXN0Wydib3gtc25hcCddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2JveC1zdXBwcmVzcyddID0gdHJ1ZTsgLy8gZGVmYXVsdDogc2hvd1xuICB3aGl0ZUxpc3RbJ2JyZWFrLWFmdGVyJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnYnJlYWstYmVmb3JlJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnYnJlYWstaW5zaWRlJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnY2FwdGlvbi1zaWRlJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogdG9wXG4gIHdoaXRlTGlzdFsnY2hhaW5zJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2NsZWFyJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsnY2xpcCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WydjbGlwLXBhdGgnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsnY2xpcC1ydWxlJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm9uemVyb1xuICB3aGl0ZUxpc3RbJ2NvbG9yJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBpbXBsZW1lbnRhdGlvbiBkZXBlbmRlbnRcbiAgd2hpdGVMaXN0Wydjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnMnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0Wydjb2x1bW4tY291bnQnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnY29sdW1uLWZpbGwnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBiYWxhbmNlXG4gIHdoaXRlTGlzdFsnY29sdW1uLWdhcCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vcm1hbFxuICB3aGl0ZUxpc3RbJ2NvbHVtbi1ydWxlJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogZGVwZW5kaW5nIG9uIGluZGl2aWR1YWwgcHJvcGVydGllc1xuICB3aGl0ZUxpc3RbJ2NvbHVtbi1ydWxlLWNvbG9yJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogY3VycmVudCBjb2xvclxuICB3aGl0ZUxpc3RbJ2NvbHVtbi1ydWxlLXN0eWxlJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbWVkaXVtXG4gIHdoaXRlTGlzdFsnY29sdW1uLXJ1bGUtd2lkdGgnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBtZWRpdW1cbiAgd2hpdGVMaXN0Wydjb2x1bW4tc3BhbiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0Wydjb2x1bW4td2lkdGgnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnY29sdW1ucyddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGRlcGVuZGluZyBvbiBpbmRpdmlkdWFsIHByb3BlcnRpZXNcbiAgd2hpdGVMaXN0Wydjb250YWluJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2NvbnRlbnQnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub3JtYWxcbiAgd2hpdGVMaXN0Wydjb3VudGVyLWluY3JlbWVudCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0Wydjb3VudGVyLXJlc2V0J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2NvdW50ZXItc2V0J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2Nyb3AnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnY3VlJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogZGVwZW5kaW5nIG9uIGluZGl2aWR1YWwgcHJvcGVydGllc1xuICB3aGl0ZUxpc3RbJ2N1ZS1hZnRlciddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0WydjdWUtYmVmb3JlJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2N1cnNvciddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WydkaXJlY3Rpb24nXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBsdHJcbiAgd2hpdGVMaXN0WydkaXNwbGF5J10gPSB0cnVlOyAvLyBkZWZhdWx0OiBkZXBlbmRpbmcgb24gaW5kaXZpZHVhbCBwcm9wZXJ0aWVzXG4gIHdoaXRlTGlzdFsnZGlzcGxheS1pbnNpZGUnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WydkaXNwbGF5LWxpc3QnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0WydkaXNwbGF5LW91dHNpZGUnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IGlubGluZS1sZXZlbFxuICB3aGl0ZUxpc3RbJ2RvbWluYW50LWJhc2VsaW5lJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ2VsZXZhdGlvbiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGxldmVsXG4gIHdoaXRlTGlzdFsnZW1wdHktY2VsbHMnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBzaG93XG4gIHdoaXRlTGlzdFsnZmlsdGVyJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2ZsZXgnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBkZXBlbmRpbmcgb24gaW5kaXZpZHVhbCBwcm9wZXJ0aWVzXG4gIHdoaXRlTGlzdFsnZmxleC1iYXNpcyddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WydmbGV4LWRpcmVjdGlvbiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IHJvd1xuICB3aGl0ZUxpc3RbJ2ZsZXgtZmxvdyddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGRlcGVuZGluZyBvbiBpbmRpdmlkdWFsIHByb3BlcnRpZXNcbiAgd2hpdGVMaXN0WydmbGV4LWdyb3cnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiAwXG4gIHdoaXRlTGlzdFsnZmxleC1zaHJpbmsnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiAxXG4gIHdoaXRlTGlzdFsnZmxleC13cmFwJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm93cmFwXG4gIHdoaXRlTGlzdFsnZmxvYXQnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsnZmxvYXQtb2Zmc2V0J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogMCAwXG4gIHdoaXRlTGlzdFsnZmxvb2QtY29sb3InXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBibGFja1xuICB3aGl0ZUxpc3RbJ2Zsb29kLW9wYWNpdHknXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiAxXG4gIHdoaXRlTGlzdFsnZmxvdy1mcm9tJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2Zsb3ctaW50byddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0Wydmb250J10gPSB0cnVlOyAvLyBkZWZhdWx0OiBkZXBlbmRpbmcgb24gaW5kaXZpZHVhbCBwcm9wZXJ0aWVzXG4gIHdoaXRlTGlzdFsnZm9udC1mYW1pbHknXSA9IHRydWU7IC8vIGRlZmF1bHQ6IGltcGxlbWVudGF0aW9uIGRlcGVuZGVudFxuICB3aGl0ZUxpc3RbJ2ZvbnQtZmVhdHVyZS1zZXR0aW5ncyddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbm9ybWFsXG4gIHdoaXRlTGlzdFsnZm9udC1rZXJuaW5nJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnZm9udC1sYW5ndWFnZS1vdmVycmlkZSddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbm9ybWFsXG4gIHdoaXRlTGlzdFsnZm9udC1zaXplJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBtZWRpdW1cbiAgd2hpdGVMaXN0Wydmb250LXNpemUtYWRqdXN0J10gPSB0cnVlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsnZm9udC1zdHJldGNoJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBub3JtYWxcbiAgd2hpdGVMaXN0Wydmb250LXN0eWxlJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBub3JtYWxcbiAgd2hpdGVMaXN0Wydmb250LXN5bnRoZXNpcyddID0gdHJ1ZTsgLy8gZGVmYXVsdDogd2VpZ2h0IHN0eWxlXG4gIHdoaXRlTGlzdFsnZm9udC12YXJpYW50J10gPSB0cnVlOyAvLyBkZWZhdWx0OiBub3JtYWxcbiAgd2hpdGVMaXN0Wydmb250LXZhcmlhbnQtYWx0ZXJuYXRlcyddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbm9ybWFsXG4gIHdoaXRlTGlzdFsnZm9udC12YXJpYW50LWNhcHMnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IG5vcm1hbFxuICB3aGl0ZUxpc3RbJ2ZvbnQtdmFyaWFudC1lYXN0LWFzaWFuJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBub3JtYWxcbiAgd2hpdGVMaXN0Wydmb250LXZhcmlhbnQtbGlnYXR1cmVzJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBub3JtYWxcbiAgd2hpdGVMaXN0Wydmb250LXZhcmlhbnQtbnVtZXJpYyddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbm9ybWFsXG4gIHdoaXRlTGlzdFsnZm9udC12YXJpYW50LXBvc2l0aW9uJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBub3JtYWxcbiAgd2hpdGVMaXN0Wydmb250LXdlaWdodCddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbm9ybWFsXG4gIHdoaXRlTGlzdFsnZ3JpZCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGRlcGVuZGluZyBvbiBpbmRpdmlkdWFsIHByb3BlcnRpZXNcbiAgd2hpdGVMaXN0WydncmlkLWFyZWEnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBkZXBlbmRpbmcgb24gaW5kaXZpZHVhbCBwcm9wZXJ0aWVzXG4gIHdoaXRlTGlzdFsnZ3JpZC1hdXRvLWNvbHVtbnMnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnZ3JpZC1hdXRvLWZsb3cnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsnZ3JpZC1hdXRvLXJvd3MnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnZ3JpZC1jb2x1bW4nXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBkZXBlbmRpbmcgb24gaW5kaXZpZHVhbCBwcm9wZXJ0aWVzXG4gIHdoaXRlTGlzdFsnZ3JpZC1jb2x1bW4tZW5kJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ2dyaWQtY29sdW1uLXN0YXJ0J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ2dyaWQtcm93J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogZGVwZW5kaW5nIG9uIGluZGl2aWR1YWwgcHJvcGVydGllc1xuICB3aGl0ZUxpc3RbJ2dyaWQtcm93LWVuZCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WydncmlkLXJvdy1zdGFydCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WydncmlkLXRlbXBsYXRlJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogZGVwZW5kaW5nIG9uIGluZGl2aWR1YWwgcHJvcGVydGllc1xuICB3aGl0ZUxpc3RbJ2dyaWQtdGVtcGxhdGUtYXJlYXMnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsnZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2dyaWQtdGVtcGxhdGUtcm93cyddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0WydoYW5naW5nLXB1bmN0dWF0aW9uJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ2hlaWdodCddID0gdHJ1ZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ2h5cGhlbnMnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBtYW51YWxcbiAgd2hpdGVMaXN0WydpY29uJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ2ltYWdlLW9yaWVudGF0aW9uJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ2ltYWdlLXJlc29sdXRpb24nXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub3JtYWxcbiAgd2hpdGVMaXN0WydpbWUtbW9kZSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0Wydpbml0aWFsLWxldHRlcnMnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub3JtYWxcbiAgd2hpdGVMaXN0WydpbmxpbmUtYm94LWFsaWduJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbGFzdFxuICB3aGl0ZUxpc3RbJ2p1c3RpZnktY29udGVudCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WydqdXN0aWZ5LWl0ZW1zJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ2p1c3RpZnktc2VsZiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WydsZWZ0J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ2xldHRlci1zcGFjaW5nJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBub3JtYWxcbiAgd2hpdGVMaXN0WydsaWdodGluZy1jb2xvciddID0gdHJ1ZTsgLy8gZGVmYXVsdDogd2hpdGVcbiAgd2hpdGVMaXN0WydsaW5lLWJveC1jb250YWluJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYmxvY2sgaW5saW5lIHJlcGxhY2VkXG4gIHdoaXRlTGlzdFsnbGluZS1icmVhayddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WydsaW5lLWdyaWQnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBtYXRjaC1wYXJlbnRcbiAgd2hpdGVMaXN0WydsaW5lLWhlaWdodCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vcm1hbFxuICB3aGl0ZUxpc3RbJ2xpbmUtc25hcCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0WydsaW5lLXN0YWNraW5nJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogZGVwZW5kaW5nIG9uIGluZGl2aWR1YWwgcHJvcGVydGllc1xuICB3aGl0ZUxpc3RbJ2xpbmUtc3RhY2tpbmctcnVieSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGV4Y2x1ZGUtcnVieVxuICB3aGl0ZUxpc3RbJ2xpbmUtc3RhY2tpbmctc2hpZnQnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBjb25zaWRlci1zaGlmdHNcbiAgd2hpdGVMaXN0WydsaW5lLXN0YWNraW5nLXN0cmF0ZWd5J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogaW5saW5lLWxpbmUtaGVpZ2h0XG4gIHdoaXRlTGlzdFsnbGlzdC1zdHlsZSddID0gdHJ1ZTsgLy8gZGVmYXVsdDogZGVwZW5kaW5nIG9uIGluZGl2aWR1YWwgcHJvcGVydGllc1xuICB3aGl0ZUxpc3RbJ2xpc3Qtc3R5bGUtaW1hZ2UnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0WydsaXN0LXN0eWxlLXBvc2l0aW9uJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBvdXRzaWRlXG4gIHdoaXRlTGlzdFsnbGlzdC1zdHlsZS10eXBlJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBkaXNjXG4gIHdoaXRlTGlzdFsnbWFyZ2luJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBkZXBlbmRpbmcgb24gaW5kaXZpZHVhbCBwcm9wZXJ0aWVzXG4gIHdoaXRlTGlzdFsnbWFyZ2luLWJvdHRvbSddID0gdHJ1ZTsgLy8gZGVmYXVsdDogMFxuICB3aGl0ZUxpc3RbJ21hcmdpbi1sZWZ0J10gPSB0cnVlOyAvLyBkZWZhdWx0OiAwXG4gIHdoaXRlTGlzdFsnbWFyZ2luLXJpZ2h0J10gPSB0cnVlOyAvLyBkZWZhdWx0OiAwXG4gIHdoaXRlTGlzdFsnbWFyZ2luLXRvcCddID0gdHJ1ZTsgLy8gZGVmYXVsdDogMFxuICB3aGl0ZUxpc3RbJ21hcmtlci1vZmZzZXQnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnbWFya2VyLXNpZGUnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBsaXN0LWl0ZW1cbiAgd2hpdGVMaXN0WydtYXJrcyddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0WydtYXNrJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYm9yZGVyLWJveFxuICB3aGl0ZUxpc3RbJ21hc2stYm94J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogc2VlIGluZGl2aWR1YWwgcHJvcGVydGllc1xuICB3aGl0ZUxpc3RbJ21hc2stYm94LW91dHNldCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IDBcbiAgd2hpdGVMaXN0WydtYXNrLWJveC1yZXBlYXQnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBzdHJldGNoXG4gIHdoaXRlTGlzdFsnbWFzay1ib3gtc2xpY2UnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiAwIGZpbGxcbiAgd2hpdGVMaXN0WydtYXNrLWJveC1zb3VyY2UnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsnbWFzay1ib3gtd2lkdGgnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnbWFzay1jbGlwJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYm9yZGVyLWJveFxuICB3aGl0ZUxpc3RbJ21hc2staW1hZ2UnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsnbWFzay1vcmlnaW4nXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBib3JkZXItYm94XG4gIHdoaXRlTGlzdFsnbWFzay1wb3NpdGlvbiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGNlbnRlclxuICB3aGl0ZUxpc3RbJ21hc2stcmVwZWF0J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm8tcmVwZWF0XG4gIHdoaXRlTGlzdFsnbWFzay1zaXplJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYm9yZGVyLWJveFxuICB3aGl0ZUxpc3RbJ21hc2stc291cmNlLXR5cGUnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnbWFzay10eXBlJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbHVtaW5hbmNlXG4gIHdoaXRlTGlzdFsnbWF4LWhlaWdodCddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ21heC1saW5lcyddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0WydtYXgtd2lkdGgnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0WydtaW4taGVpZ2h0J10gPSB0cnVlOyAvLyBkZWZhdWx0OiAwXG4gIHdoaXRlTGlzdFsnbWluLXdpZHRoJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiAwXG4gIHdoaXRlTGlzdFsnbW92ZS10byddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vcm1hbFxuICB3aGl0ZUxpc3RbJ25hdi1kb3duJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ25hdi1pbmRleCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WyduYXYtbGVmdCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WyduYXYtcmlnaHQnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnbmF2LXVwJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ29iamVjdC1maXQnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBmaWxsXG4gIHdoaXRlTGlzdFsnb2JqZWN0LXBvc2l0aW9uJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogNTAlIDUwJVxuICB3aGl0ZUxpc3RbJ29wYWNpdHknXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiAxXG4gIHdoaXRlTGlzdFsnb3JkZXInXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiAwXG4gIHdoaXRlTGlzdFsnb3JwaGFucyddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IDJcbiAgd2hpdGVMaXN0WydvdXRsaW5lJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogZGVwZW5kaW5nIG9uIGluZGl2aWR1YWwgcHJvcGVydGllc1xuICB3aGl0ZUxpc3RbJ291dGxpbmUtY29sb3InXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBpbnZlcnRcbiAgd2hpdGVMaXN0WydvdXRsaW5lLW9mZnNldCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IDBcbiAgd2hpdGVMaXN0WydvdXRsaW5lLXN0eWxlJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ291dGxpbmUtd2lkdGgnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBtZWRpdW1cbiAgd2hpdGVMaXN0WydvdmVyZmxvdyddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGRlcGVuZGluZyBvbiBpbmRpdmlkdWFsIHByb3BlcnRpZXNcbiAgd2hpdGVMaXN0WydvdmVyZmxvdy13cmFwJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm9ybWFsXG4gIHdoaXRlTGlzdFsnb3ZlcmZsb3cteCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IHZpc2libGVcbiAgd2hpdGVMaXN0WydvdmVyZmxvdy15J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogdmlzaWJsZVxuICB3aGl0ZUxpc3RbJ3BhZGRpbmcnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IGRlcGVuZGluZyBvbiBpbmRpdmlkdWFsIHByb3BlcnRpZXNcbiAgd2hpdGVMaXN0WydwYWRkaW5nLWJvdHRvbSddID0gdHJ1ZTsgLy8gZGVmYXVsdDogMFxuICB3aGl0ZUxpc3RbJ3BhZGRpbmctbGVmdCddID0gdHJ1ZTsgLy8gZGVmYXVsdDogMFxuICB3aGl0ZUxpc3RbJ3BhZGRpbmctcmlnaHQnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IDBcbiAgd2hpdGVMaXN0WydwYWRkaW5nLXRvcCddID0gdHJ1ZTsgLy8gZGVmYXVsdDogMFxuICB3aGl0ZUxpc3RbJ3BhZ2UnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsncGFnZS1icmVhay1hZnRlciddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WydwYWdlLWJyZWFrLWJlZm9yZSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WydwYWdlLWJyZWFrLWluc2lkZSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0WydwYWdlLXBvbGljeSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IHN0YXJ0XG4gIHdoaXRlTGlzdFsncGF1c2UnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBpbXBsZW1lbnRhdGlvbiBkZXBlbmRlbnRcbiAgd2hpdGVMaXN0WydwYXVzZS1hZnRlciddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGltcGxlbWVudGF0aW9uIGRlcGVuZGVudFxuICB3aGl0ZUxpc3RbJ3BhdXNlLWJlZm9yZSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGltcGxlbWVudGF0aW9uIGRlcGVuZGVudFxuICB3aGl0ZUxpc3RbJ3BlcnNwZWN0aXZlJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ3BlcnNwZWN0aXZlLW9yaWdpbiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IDUwJSA1MCVcbiAgd2hpdGVMaXN0WydwaXRjaCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG1lZGl1bVxuICB3aGl0ZUxpc3RbJ3BpdGNoLXJhbmdlJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogNTBcbiAgd2hpdGVMaXN0WydwbGF5LWR1cmluZyddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0Wydwb3NpdGlvbiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IHN0YXRpY1xuICB3aGl0ZUxpc3RbJ3ByZXNlbnRhdGlvbi1sZXZlbCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IDBcbiAgd2hpdGVMaXN0WydxdW90ZXMnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiB0ZXh0XG4gIHdoaXRlTGlzdFsncmVnaW9uLWZyYWdtZW50J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ3Jlc2l6ZSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0WydyZXN0J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogZGVwZW5kaW5nIG9uIGluZGl2aWR1YWwgcHJvcGVydGllc1xuICB3aGl0ZUxpc3RbJ3Jlc3QtYWZ0ZXInXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsncmVzdC1iZWZvcmUnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsncmljaG5lc3MnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiA1MFxuICB3aGl0ZUxpc3RbJ3JpZ2h0J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ3JvdGF0aW9uJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogMFxuICB3aGl0ZUxpc3RbJ3JvdGF0aW9uLXBvaW50J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogNTAlIDUwJVxuICB3aGl0ZUxpc3RbJ3J1YnktYWxpZ24nXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsncnVieS1tZXJnZSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IHNlcGFyYXRlXG4gIHdoaXRlTGlzdFsncnVieS1wb3NpdGlvbiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGJlZm9yZVxuICB3aGl0ZUxpc3RbJ3NoYXBlLWltYWdlLXRocmVzaG9sZCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IDAuMFxuICB3aGl0ZUxpc3RbJ3NoYXBlLW91dHNpZGUnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsnc2hhcGUtbWFyZ2luJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogMFxuICB3aGl0ZUxpc3RbJ3NpemUnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnc3BlYWsnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnc3BlYWstYXMnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub3JtYWxcbiAgd2hpdGVMaXN0WydzcGVhay1oZWFkZXInXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBvbmNlXG4gIHdoaXRlTGlzdFsnc3BlYWstbnVtZXJhbCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGNvbnRpbnVvdXNcbiAgd2hpdGVMaXN0WydzcGVhay1wdW5jdHVhdGlvbiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0WydzcGVlY2gtcmF0ZSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG1lZGl1bVxuICB3aGl0ZUxpc3RbJ3N0cmVzcyddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IDUwXG4gIHdoaXRlTGlzdFsnc3RyaW5nLXNldCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0Wyd0YWItc2l6ZSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IDhcbiAgd2hpdGVMaXN0Wyd0YWJsZS1sYXlvdXQnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsndGV4dC1hbGlnbiddID0gdHJ1ZTsgLy8gZGVmYXVsdDogc3RhcnRcbiAgd2hpdGVMaXN0Wyd0ZXh0LWFsaWduLWxhc3QnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0Wyd0ZXh0LWNvbWJpbmUtdXByaWdodCddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ3RleHQtZGVjb3JhdGlvbiddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbm9uZVxuICB3aGl0ZUxpc3RbJ3RleHQtZGVjb3JhdGlvbi1jb2xvciddID0gdHJ1ZTsgLy8gZGVmYXVsdDogY3VycmVudENvbG9yXG4gIHdoaXRlTGlzdFsndGV4dC1kZWNvcmF0aW9uLWxpbmUnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0Wyd0ZXh0LWRlY29yYXRpb24tc2tpcCddID0gdHJ1ZTsgLy8gZGVmYXVsdDogb2JqZWN0c1xuICB3aGl0ZUxpc3RbJ3RleHQtZGVjb3JhdGlvbi1zdHlsZSddID0gdHJ1ZTsgLy8gZGVmYXVsdDogc29saWRcbiAgd2hpdGVMaXN0Wyd0ZXh0LWVtcGhhc2lzJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBkZXBlbmRpbmcgb24gaW5kaXZpZHVhbCBwcm9wZXJ0aWVzXG4gIHdoaXRlTGlzdFsndGV4dC1lbXBoYXNpcy1jb2xvciddID0gdHJ1ZTsgLy8gZGVmYXVsdDogY3VycmVudENvbG9yXG4gIHdoaXRlTGlzdFsndGV4dC1lbXBoYXNpcy1wb3NpdGlvbiddID0gdHJ1ZTsgLy8gZGVmYXVsdDogb3ZlciByaWdodFxuICB3aGl0ZUxpc3RbJ3RleHQtZW1waGFzaXMtc3R5bGUnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0Wyd0ZXh0LWhlaWdodCddID0gdHJ1ZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ3RleHQtaW5kZW50J10gPSB0cnVlOyAvLyBkZWZhdWx0OiAwXG4gIHdoaXRlTGlzdFsndGV4dC1qdXN0aWZ5J10gPSB0cnVlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsndGV4dC1vcmllbnRhdGlvbiddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbWl4ZWRcbiAgd2hpdGVMaXN0Wyd0ZXh0LW92ZXJmbG93J10gPSB0cnVlOyAvLyBkZWZhdWx0OiBjbGlwXG4gIHdoaXRlTGlzdFsndGV4dC1zaGFkb3cnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IG5vbmVcbiAgd2hpdGVMaXN0Wyd0ZXh0LXNwYWNlLWNvbGxhcHNlJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBjb2xsYXBzZVxuICB3aGl0ZUxpc3RbJ3RleHQtdHJhbnNmb3JtJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsndGV4dC11bmRlcmxpbmUtcG9zaXRpb24nXSA9IHRydWU7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0Wyd0ZXh0LXdyYXAnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IG5vcm1hbFxuICB3aGl0ZUxpc3RbJ3RvcCddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGF1dG9cbiAgd2hpdGVMaXN0Wyd0cmFuc2Zvcm0nXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub25lXG4gIHdoaXRlTGlzdFsndHJhbnNmb3JtLW9yaWdpbiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IDUwJSA1MCUgMFxuICB3aGl0ZUxpc3RbJ3RyYW5zZm9ybS1zdHlsZSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGZsYXRcbiAgd2hpdGVMaXN0Wyd0cmFuc2l0aW9uJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogZGVwZW5kaW5nIG9uIGluZGl2aWR1YWwgcHJvcGVydGllc1xuICB3aGl0ZUxpc3RbJ3RyYW5zaXRpb24tZGVsYXknXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiAwc1xuICB3aGl0ZUxpc3RbJ3RyYW5zaXRpb24tZHVyYXRpb24nXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiAwc1xuICB3aGl0ZUxpc3RbJ3RyYW5zaXRpb24tcHJvcGVydHknXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhbGxcbiAgd2hpdGVMaXN0Wyd0cmFuc2l0aW9uLXRpbWluZy1mdW5jdGlvbiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGVhc2VcbiAgd2hpdGVMaXN0Wyd1bmljb2RlLWJpZGknXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub3JtYWxcbiAgd2hpdGVMaXN0Wyd2ZXJ0aWNhbC1hbGlnbiddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGJhc2VsaW5lXG4gIHdoaXRlTGlzdFsndmlzaWJpbGl0eSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IHZpc2libGVcbiAgd2hpdGVMaXN0Wyd2b2ljZS1iYWxhbmNlJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogY2VudGVyXG4gIHdoaXRlTGlzdFsndm9pY2UtZHVyYXRpb24nXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsndm9pY2UtZmFtaWx5J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogaW1wbGVtZW50YXRpb24gZGVwZW5kZW50XG4gIHdoaXRlTGlzdFsndm9pY2UtcGl0Y2gnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBtZWRpdW1cbiAgd2hpdGVMaXN0Wyd2b2ljZS1yYW5nZSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG1lZGl1bVxuICB3aGl0ZUxpc3RbJ3ZvaWNlLXJhdGUnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub3JtYWxcbiAgd2hpdGVMaXN0Wyd2b2ljZS1zdHJlc3MnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBub3JtYWxcbiAgd2hpdGVMaXN0Wyd2b2ljZS12b2x1bWUnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBtZWRpdW1cbiAgd2hpdGVMaXN0Wyd2b2x1bWUnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBtZWRpdW1cbiAgd2hpdGVMaXN0Wyd3aGl0ZS1zcGFjZSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IG5vcm1hbFxuICB3aGl0ZUxpc3RbJ3dpZG93cyddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IDJcbiAgd2hpdGVMaXN0Wyd3aWR0aCddID0gdHJ1ZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ3dpbGwtY2hhbmdlJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYXV0b1xuICB3aGl0ZUxpc3RbJ3dvcmQtYnJlYWsnXSA9IHRydWU7IC8vIGRlZmF1bHQ6IG5vcm1hbFxuICB3aGl0ZUxpc3RbJ3dvcmQtc3BhY2luZyddID0gdHJ1ZTsgLy8gZGVmYXVsdDogbm9ybWFsXG4gIHdoaXRlTGlzdFsnd29yZC13cmFwJ10gPSB0cnVlOyAvLyBkZWZhdWx0OiBub3JtYWxcbiAgd2hpdGVMaXN0Wyd3cmFwLWZsb3cnXSA9IGZhbHNlOyAvLyBkZWZhdWx0OiBhdXRvXG4gIHdoaXRlTGlzdFsnd3JhcC10aHJvdWdoJ10gPSBmYWxzZTsgLy8gZGVmYXVsdDogd3JhcFxuICB3aGl0ZUxpc3RbJ3dyaXRpbmctbW9kZSddID0gZmFsc2U7IC8vIGRlZmF1bHQ6IGhvcml6b250YWwtdGJcbiAgd2hpdGVMaXN0Wyd6LWluZGV4J10gPSBmYWxzZTsgLy8gZGVmYXVsdDogYXV0b1xuXG4gIHJldHVybiB3aGl0ZUxpc3Q7XG59XG5cblxuLyoqXG4gKiDljLnphY3liLDnmb3lkI3ljZXkuIrnmoTkuIDkuKrlsZ7mgKfml7ZcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxuICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xuICogQHJldHVybiB7U3RyaW5nfVxuICovXG5mdW5jdGlvbiBvbkF0dHIgKG5hbWUsIHZhbHVlLCBvcHRpb25zKSB7XG4gIC8vIGRvIG5vdGhpbmdcbn1cblxuLyoqXG4gKiDljLnphY3liLDkuI3lnKjnmb3lkI3ljZXkuIrnmoTkuIDkuKrlsZ7mgKfml7ZcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxuICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xuICogQHJldHVybiB7U3RyaW5nfVxuICovXG5mdW5jdGlvbiBvbklnbm9yZUF0dHIgKG5hbWUsIHZhbHVlLCBvcHRpb25zKSB7XG4gIC8vIGRvIG5vdGhpbmdcbn1cblxudmFyIFJFR0VYUF9VUkxfSkFWQVNDUklQVCA9IC9qYXZhc2NyaXB0XFxzKlxcOi9pbWc7XG5cbi8qKlxuICog6L+H5ruk5bGe5oCn5YC8XG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWVcbiAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZVxuICogQHJldHVybiB7U3RyaW5nfVxuICovXG5mdW5jdGlvbiBzYWZlQXR0clZhbHVlKG5hbWUsIHZhbHVlKSB7XG4gIGlmIChSRUdFWFBfVVJMX0pBVkFTQ1JJUFQudGVzdCh2YWx1ZSkpIHJldHVybiAnJztcbiAgcmV0dXJuIHZhbHVlO1xufVxuXG5cbmV4cG9ydHMud2hpdGVMaXN0ID0gZ2V0RGVmYXVsdFdoaXRlTGlzdCgpO1xuZXhwb3J0cy5nZXREZWZhdWx0V2hpdGVMaXN0ID0gZ2V0RGVmYXVsdFdoaXRlTGlzdDtcbmV4cG9ydHMub25BdHRyID0gb25BdHRyO1xuZXhwb3J0cy5vbklnbm9yZUF0dHIgPSBvbklnbm9yZUF0dHI7XG5leHBvcnRzLnNhZmVBdHRyVmFsdWUgPSBzYWZlQXR0clZhbHVlO1xuIiwiLyoqXG4gKiBjc3NmaWx0ZXJcbiAqXG4gKiBAYXV0aG9yIOiAgembtzxsZWl6b25nbWluQGdtYWlsLmNvbT5cbiAqL1xuXG52YXIgREVGQVVMVCA9IHJlcXVpcmUoJy4vZGVmYXVsdCcpO1xudmFyIEZpbHRlckNTUyA9IHJlcXVpcmUoJy4vY3NzJyk7XG5cblxuLyoqXG4gKiBYU1Pov4fmu6RcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gY3NzIOimgei/h+a7pOeahENTU+S7o+eggVxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMg6YCJ6aG577yad2hpdGVMaXN0LCBvbkF0dHIsIG9uSWdub3JlQXR0clxuICogQHJldHVybiB7U3RyaW5nfVxuICovXG5mdW5jdGlvbiBmaWx0ZXJDU1MgKGh0bWwsIG9wdGlvbnMpIHtcbiAgdmFyIHhzcyA9IG5ldyBGaWx0ZXJDU1Mob3B0aW9ucyk7XG4gIHJldHVybiB4c3MucHJvY2VzcyhodG1sKTtcbn1cblxuXG4vLyDovpPlh7pcbmV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGZpbHRlckNTUztcbmV4cG9ydHMuRmlsdGVyQ1NTID0gRmlsdGVyQ1NTO1xuZm9yICh2YXIgaSBpbiBERUZBVUxUKSBleHBvcnRzW2ldID0gREVGQVVMVFtpXTtcblxuLy8g5Zyo5rWP6KeI5Zmo56uv5L2/55SoXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgd2luZG93LmZpbHRlckNTUyA9IG1vZHVsZS5leHBvcnRzO1xufVxuIiwiLyoqXG4gKiBjc3NmaWx0ZXJcbiAqXG4gKiBAYXV0aG9yIOiAgembtzxsZWl6b25nbWluQGdtYWlsLmNvbT5cbiAqL1xuXG52YXIgXyA9IHJlcXVpcmUoJy4vdXRpbCcpO1xuXG5cbi8qKlxuICog6Kej5p6Qc3R5bGVcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gY3NzXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkF0dHIg5aSE55CG5bGe5oCn55qE5Ye95pWwXG4gKiAgIOWPguaVsOagvOW8j++8miBmdW5jdGlvbiAoc291cmNlUG9zaXRpb24sIHBvc2l0aW9uLCBuYW1lLCB2YWx1ZSwgc291cmNlKVxuICogQHJldHVybiB7U3RyaW5nfVxuICovXG5mdW5jdGlvbiBwYXJzZVN0eWxlIChjc3MsIG9uQXR0cikge1xuICBjc3MgPSBfLnRyaW1SaWdodChjc3MpO1xuICBpZiAoY3NzW2Nzcy5sZW5ndGggLSAxXSAhPT0gJzsnKSBjc3MgKz0gJzsnO1xuICB2YXIgY3NzTGVuZ3RoID0gY3NzLmxlbmd0aDtcbiAgdmFyIGlzUGFyZW50aGVzaXNPcGVuID0gZmFsc2U7XG4gIHZhciBsYXN0UG9zID0gMDtcbiAgdmFyIGkgPSAwO1xuICB2YXIgcmV0Q1NTID0gJyc7XG5cbiAgZnVuY3Rpb24gYWRkTmV3QXR0ciAoKSB7XG4gICAgLy8g5aaC5p6c5rKh5pyJ5q2j5bi455qE6Zet5ZCI5ZyG5ous5Y+377yM5YiZ55u05o6l5b+955Wl5b2T5YmN5bGe5oCnXG4gICAgaWYgKCFpc1BhcmVudGhlc2lzT3Blbikge1xuICAgICAgdmFyIHNvdXJjZSA9IF8udHJpbShjc3Muc2xpY2UobGFzdFBvcywgaSkpO1xuICAgICAgdmFyIGogPSBzb3VyY2UuaW5kZXhPZignOicpO1xuICAgICAgaWYgKGogIT09IC0xKSB7XG4gICAgICAgIHZhciBuYW1lID0gXy50cmltKHNvdXJjZS5zbGljZSgwLCBqKSk7XG4gICAgICAgIHZhciB2YWx1ZSA9IF8udHJpbShzb3VyY2Uuc2xpY2UoaiArIDEpKTtcbiAgICAgICAgLy8g5b+F6aG75pyJ5bGe5oCn5ZCN56ewXG4gICAgICAgIGlmIChuYW1lKSB7XG4gICAgICAgICAgdmFyIHJldCA9IG9uQXR0cihsYXN0UG9zLCByZXRDU1MubGVuZ3RoLCBuYW1lLCB2YWx1ZSwgc291cmNlKTtcbiAgICAgICAgICBpZiAocmV0KSByZXRDU1MgKz0gcmV0ICsgJzsgJztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBsYXN0UG9zID0gaSArIDE7XG4gIH1cblxuICBmb3IgKDsgaSA8IGNzc0xlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGMgPSBjc3NbaV07XG4gICAgaWYgKGMgPT09ICcvJyAmJiBjc3NbaSArIDFdID09PSAnKicpIHtcbiAgICAgIC8vIOWkh+azqOW8gOWni1xuICAgICAgdmFyIGogPSBjc3MuaW5kZXhPZignKi8nLCBpICsgMik7XG4gICAgICAvLyDlpoLmnpzmsqHmnInmraPluLjnmoTlpIfms6jnu5PmnZ/vvIzliJnlkI7pnaLnmoTpg6jliIblhajpg6jot7Pov4dcbiAgICAgIGlmIChqID09PSAtMSkgYnJlYWs7XG4gICAgICAvLyDnm7TmjqXlsIblvZPliY3kvY3nva7osIPliLDlpIfms6jnu5PlsL7vvIzlubbkuJTliJ3lp4vljJbnirbmgIFcbiAgICAgIGkgPSBqICsgMTtcbiAgICAgIGxhc3RQb3MgPSBpICsgMTtcbiAgICAgIGlzUGFyZW50aGVzaXNPcGVuID0gZmFsc2U7XG4gICAgfSBlbHNlIGlmIChjID09PSAnKCcpIHtcbiAgICAgIGlzUGFyZW50aGVzaXNPcGVuID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKGMgPT09ICcpJykge1xuICAgICAgaXNQYXJlbnRoZXNpc09wZW4gPSBmYWxzZTtcbiAgICB9IGVsc2UgaWYgKGMgPT09ICc7Jykge1xuICAgICAgaWYgKGlzUGFyZW50aGVzaXNPcGVuKSB7XG4gICAgICAgIC8vIOWcqOWchuaLrOWPt+mHjOmdou+8jOW/veeVpVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWRkTmV3QXR0cigpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoYyA9PT0gJ1xcbicpIHtcbiAgICAgIGFkZE5ld0F0dHIoKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gXy50cmltKHJldENTUyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gcGFyc2VTdHlsZTtcbiIsIm1vZHVsZS5leHBvcnRzID0ge1xuICBpbmRleE9mOiBmdW5jdGlvbiAoYXJyLCBpdGVtKSB7XG4gICAgdmFyIGksIGo7XG4gICAgaWYgKEFycmF5LnByb3RvdHlwZS5pbmRleE9mKSB7XG4gICAgICByZXR1cm4gYXJyLmluZGV4T2YoaXRlbSk7XG4gICAgfVxuICAgIGZvciAoaSA9IDAsIGogPSBhcnIubGVuZ3RoOyBpIDwgajsgaSsrKSB7XG4gICAgICBpZiAoYXJyW2ldID09PSBpdGVtKSB7XG4gICAgICAgIHJldHVybiBpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gLTE7XG4gIH0sXG4gIGZvckVhY2g6IGZ1bmN0aW9uIChhcnIsIGZuLCBzY29wZSkge1xuICAgIHZhciBpLCBqO1xuICAgIGlmIChBcnJheS5wcm90b3R5cGUuZm9yRWFjaCkge1xuICAgICAgcmV0dXJuIGFyci5mb3JFYWNoKGZuLCBzY29wZSk7XG4gICAgfVxuICAgIGZvciAoaSA9IDAsIGogPSBhcnIubGVuZ3RoOyBpIDwgajsgaSsrKSB7XG4gICAgICBmbi5jYWxsKHNjb3BlLCBhcnJbaV0sIGksIGFycik7XG4gICAgfVxuICB9LFxuICB0cmltOiBmdW5jdGlvbiAoc3RyKSB7XG4gICAgaWYgKFN0cmluZy5wcm90b3R5cGUudHJpbSkge1xuICAgICAgcmV0dXJuIHN0ci50cmltKCk7XG4gICAgfVxuICAgIHJldHVybiBzdHIucmVwbGFjZSgvKF5cXHMqKXwoXFxzKiQpL2csICcnKTtcbiAgfSxcbiAgdHJpbVJpZ2h0OiBmdW5jdGlvbiAoc3RyKSB7XG4gICAgaWYgKFN0cmluZy5wcm90b3R5cGUudHJpbVJpZ2h0KSB7XG4gICAgICByZXR1cm4gc3RyLnRyaW1SaWdodCgpO1xuICAgIH1cbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoLyhcXHMqJCkvZywgJycpO1xuICB9XG59O1xuIiwiLyohIHdlYi1oaWdobGlnaHRlciB2MC43LjQgaHR0cHM6Ly9naXRodWIuY29tL2FsaWVuemhvdS93ZWItaGlnaGxpZ2h0ZXIgKi9cbiFmdW5jdGlvbihlLHQpe1wib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPXQoKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtdLHQpOlwib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzP2V4cG9ydHMuSGlnaGxpZ2h0ZXI9dCgpOmUuSGlnaGxpZ2h0ZXI9dCgpfSh3aW5kb3csKGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciB0PXt9O2Z1bmN0aW9uIG4ocil7aWYodFtyXSlyZXR1cm4gdFtyXS5leHBvcnRzO3ZhciBvPXRbcl09e2k6cixsOiExLGV4cG9ydHM6e319O3JldHVybiBlW3JdLmNhbGwoby5leHBvcnRzLG8sby5leHBvcnRzLG4pLG8ubD0hMCxvLmV4cG9ydHN9cmV0dXJuIG4ubT1lLG4uYz10LG4uZD1mdW5jdGlvbihlLHQscil7bi5vKGUsdCl8fE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse2VudW1lcmFibGU6ITAsZ2V0OnJ9KX0sbi5yPWZ1bmN0aW9uKGUpe1widW5kZWZpbmVkXCIhPXR5cGVvZiBTeW1ib2wmJlN5bWJvbC50b1N0cmluZ1RhZyYmT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsU3ltYm9sLnRvU3RyaW5nVGFnLHt2YWx1ZTpcIk1vZHVsZVwifSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSl9LG4udD1mdW5jdGlvbihlLHQpe2lmKDEmdCYmKGU9bihlKSksOCZ0KXJldHVybiBlO2lmKDQmdCYmXCJvYmplY3RcIj09dHlwZW9mIGUmJmUmJmUuX19lc01vZHVsZSlyZXR1cm4gZTt2YXIgcj1PYmplY3QuY3JlYXRlKG51bGwpO2lmKG4ucihyKSxPYmplY3QuZGVmaW5lUHJvcGVydHkocixcImRlZmF1bHRcIix7ZW51bWVyYWJsZTohMCx2YWx1ZTplfSksMiZ0JiZcInN0cmluZ1wiIT10eXBlb2YgZSlmb3IodmFyIG8gaW4gZSluLmQocixvLGZ1bmN0aW9uKHQpe3JldHVybiBlW3RdfS5iaW5kKG51bGwsbykpO3JldHVybiByfSxuLm49ZnVuY3Rpb24oZSl7dmFyIHQ9ZSYmZS5fX2VzTW9kdWxlP2Z1bmN0aW9uKCl7cmV0dXJuIGUuZGVmYXVsdH06ZnVuY3Rpb24oKXtyZXR1cm4gZX07cmV0dXJuIG4uZCh0LFwiYVwiLHQpLHR9LG4ubz1mdW5jdGlvbihlLHQpe3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSx0KX0sbi5wPVwiXCIsbihuLnM9Nyl9KFtmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7dmFyIHIsbz10aGlzJiZ0aGlzLl9fZXh0ZW5kc3x8KHI9ZnVuY3Rpb24oZSx0KXtyZXR1cm4ocj1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24oZSx0KXtlLl9fcHJvdG9fXz10fXx8ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG4gaW4gdClPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxuKSYmKGVbbl09dFtuXSl9KShlLHQpfSxmdW5jdGlvbihlLHQpe2Z1bmN0aW9uIG4oKXt0aGlzLmNvbnN0cnVjdG9yPWV9cihlLHQpLGUucHJvdG90eXBlPW51bGw9PT10P09iamVjdC5jcmVhdGUodCk6KG4ucHJvdG90eXBlPXQucHJvdG90eXBlLG5ldyBuKX0pLGk9dGhpcyYmdGhpcy5fX2ltcG9ydERlZmF1bHR8fGZ1bmN0aW9uKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX07T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksdC5ldmVudEVtaXR0ZXI9dC5JTlRFUk5BTF9FUlJPUl9FVkVOVD10LlVOS05PV05fSURYPXQuUk9PVF9JRFg9dC5nZXRTdHlsZXNoZWV0PXQuZ2V0RGVmYXVsdE9wdGlvbnM9dC5DQU1FTF9EQVRBU0VUX1NQTElUX1RZUEU9dC5DQU1FTF9EQVRBU0VUX0lERU5USUZJRVJfRVhUUkE9dC5DQU1FTF9EQVRBU0VUX0lERU5USUZJRVI9dC5EQVRBU0VUX1NQTElUX1RZUEU9dC5EQVRBU0VUX0lERU5USUZJRVJfRVhUUkE9dC5EQVRBU0VUX0lERU5USUZJRVI9dC5TVFlMRVNIRUVUX0lEPXQuTE9DQUxfU1RPUkVfS0VZPXQuSURfRElWSVNJT049dm9pZCAwO3ZhciBhPWkobigxMCkpLGw9aShuKDIpKTt0LklEX0RJVklTSU9OPVwiO1wiLHQuTE9DQUxfU1RPUkVfS0VZPVwiaGlnaGxpZ2h0LW1lbmdzaG91XCIsdC5TVFlMRVNIRUVUX0lEPVwiaGlnaGxpZ2h0LW1lbmdzaG91LXN0eWxlXCIsdC5EQVRBU0VUX0lERU5USUZJRVI9XCJoaWdobGlnaHQtaWRcIix0LkRBVEFTRVRfSURFTlRJRklFUl9FWFRSQT1cImhpZ2hsaWdodC1pZC1leHRyYVwiLHQuREFUQVNFVF9TUExJVF9UWVBFPVwiaGlnaGxpZ2h0LXNwbGl0LXR5cGVcIix0LkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUj1hLmRlZmF1bHQodC5EQVRBU0VUX0lERU5USUZJRVIpLHQuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSX0VYVFJBPWEuZGVmYXVsdCh0LkRBVEFTRVRfSURFTlRJRklFUl9FWFRSQSksdC5DQU1FTF9EQVRBU0VUX1NQTElUX1RZUEU9YS5kZWZhdWx0KHQuREFUQVNFVF9TUExJVF9UWVBFKTt0LmdldERlZmF1bHRPcHRpb25zPWZ1bmN0aW9uKCl7cmV0dXJueyRyb290OmRvY3VtZW50fHxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsZXhjZXB0U2VsZWN0b3JzOm51bGwsd3JhcFRhZzpcInNwYW5cIix2ZXJib3NlOiExLHN0eWxlOntjbGFzc05hbWU6XCJoaWdobGlnaHQtbWVuZ3Nob3Utd3JhcFwifX19O3QuZ2V0U3R5bGVzaGVldD1mdW5jdGlvbigpe3JldHVyblwiXFxuICAgIC5cIit0LmdldERlZmF1bHRPcHRpb25zKCkuc3R5bGUuY2xhc3NOYW1lK1wiIHtcXG4gICAgICAgIGJhY2tncm91bmQ6ICNmZjk7XFxuICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XFxuICAgIH1cXG4gICAgLlwiK3QuZ2V0RGVmYXVsdE9wdGlvbnMoKS5zdHlsZS5jbGFzc05hbWUrXCIuYWN0aXZlIHtcXG4gICAgICAgIGJhY2tncm91bmQ6ICNmZmI7XFxuICAgIH1cXG5cIn0sdC5ST09UX0lEWD0tMix0LlVOS05PV05fSURYPS0xLHQuSU5URVJOQUxfRVJST1JfRVZFTlQ9XCJlcnJvclwiO3ZhciB1PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoKXtyZXR1cm4gbnVsbCE9PWUmJmUuYXBwbHkodGhpcyxhcmd1bWVudHMpfHx0aGlzfXJldHVybiBvKHQsZSksdH0obC5kZWZhdWx0KTt0LmV2ZW50RW1pdHRlcj1uZXcgdX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuVXNlcklucHV0RXZlbnQ9dC5TZWxlY3RlZE5vZGVUeXBlPXQuQ3JlYXRlRnJvbT10LkV2ZW50VHlwZT10LkVSUk9SPXQuU3BsaXRUeXBlPXZvaWQgMCxmdW5jdGlvbihlKXtlLm5vbmU9XCJub25lXCIsZS5oZWFkPVwiaGVhZFwiLGUudGFpbD1cInRhaWxcIixlLmJvdGg9XCJib3RoXCJ9KHQuU3BsaXRUeXBlfHwodC5TcGxpdFR5cGU9e30pKSxmdW5jdGlvbihlKXtlLkRPTV9UWVBFX0VSUk9SPVwiW0RPTV0gUmVjZWl2ZSB3cm9uZyBub2RlIHR5cGUuXCIsZS5ET01fU0VMRUNUSU9OX0VNUFRZPVwiW0RPTV0gVGhlIHNlbGVjdGlvbiBjb250YWlucyBubyBkb20gbm9kZSwgbWF5IGJlIHlvdSBleGNlcHQgdGhlbS5cIixlLlJBTkdFX0lOVkFMSUQ9XCJbUkFOR0VdIEdvdCBpbnZhbGlkIGRvbSByYW5nZSwgY2FuJ3QgY29udmVydCB0byBhIHZhbGlkIGhpZ2hsaWdodCByYW5nZS5cIixlLlJBTkdFX05PREVfSU5WQUxJRD1cIltSQU5HRV0gU3RhcnQgb3IgZW5kIG5vZGUgaXNuJ3QgYSB0ZXh0IG5vZGUsIGl0IG1heSBvY2N1ciBhbiBlcnJvci5cIixlLkRCX0lEX0RVUExJQ0FURV9FUlJPUj1cIltTVE9SRV0gVW5pcXVlIGlkIGNvbmZsaWN0LlwiLGUuQ0FDSEVfU0VUX0VSUk9SPVwiW0NBQ0hFXSBDYWNoZS5kYXRhIGNhbid0IGJlIHNldCBtYW51YWxseSwgcGxlYXNlIHVzZSAuc2F2ZSgpLlwiLGUuU09VUkNFX1RZUEVfRVJST1I9XCJbU09VUkNFXSBPYmplY3QgaXNuJ3QgYSBoaWdobGlnaHQgc291cmNlIGluc3RhbmNlLlwiLGUuSElHSExJR0hUX1JBTkdFX0ZST1pFTj1cIltISUdITElHSFRfUkFOR0VdIEEgaGlnaGxpZ2h0IHJhbmdlIG11c3QgYmUgZnJvemVuIGJlZm9yZSByZW5kZXIuXCIsZS5ISUdITElHSFRfU09VUkNFX1JFQ1JFQVRFPVwiW0hJR0hMSUdIVF9TT1VSQ0VdIFJlY3JlYXRlIGhpZ2hsaWdodHMgZnJvbSBzb3VyY2VzIGVycm9yLlwiLGUuSElHSExJR0hUX1NPVVJDRV9OT05FX1JFTkRFUj1cIltISUdITElHSFRfU09VUkNFXSBUaGlzIGhpZ2hsaWdodCBzb3VyY2UgaXNuJ3QgcmVuZGVyZWQuIE1heSBiZSB0aGUgZXhjZXB0aW9uIHNraXBzIGl0IG9yIHRoZSBkb20gc3RydWN0dXJlIGhhcyBjaGFuZ2VkLlwifSh0LkVSUk9SfHwodC5FUlJPUj17fSkpLGZ1bmN0aW9uKGUpe2UuQ1JFQVRFPVwic2VsZWN0aW9uOmNyZWF0ZVwiLGUuUkVNT1ZFPVwic2VsZWN0aW9uOnJlbW92ZVwiLGUuTU9ESUZZPVwic2VsZWN0aW9uOm1vZGlmeVwiLGUuSE9WRVI9XCJzZWxlY3Rpb246aG92ZXJcIixlLkhPVkVSX09VVD1cInNlbGVjdGlvbjpob3Zlci1vdXRcIixlLkNMSUNLPVwic2VsZWN0aW9uOmNsaWNrXCJ9KHQuRXZlbnRUeXBlfHwodC5FdmVudFR5cGU9e30pKSxmdW5jdGlvbihlKXtlLlNUT1JFPVwiZnJvbS1zdG9yZVwiLGUuSU5QVVQ9XCJmcm9tLWlucHV0XCJ9KHQuQ3JlYXRlRnJvbXx8KHQuQ3JlYXRlRnJvbT17fSkpLGZ1bmN0aW9uKGUpe2UudGV4dD1cInRleHRcIixlLnNwYW49XCJzcGFuXCJ9KHQuU2VsZWN0ZWROb2RlVHlwZXx8KHQuU2VsZWN0ZWROb2RlVHlwZT17fSkpLGZ1bmN0aW9uKGUpe2UudG91Y2hlbmQ9XCJ0b3VjaGVuZFwiLGUubW91c2V1cD1cIm1vdXNldXBcIixlLnRvdWNoc3RhcnQ9XCJ0b3VjaHN0YXJ0XCIsZS5jbGljaz1cImNsaWNrXCIsZS5tb3VzZW92ZXI9XCJtb3VzZW92ZXJcIn0odC5Vc2VySW5wdXRFdmVudHx8KHQuVXNlcklucHV0RXZlbnQ9e30pKX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO3ZhciByPXRoaXMmJnRoaXMuX19yZWFkfHxmdW5jdGlvbihlLHQpe3ZhciBuPVwiZnVuY3Rpb25cIj09dHlwZW9mIFN5bWJvbCYmZVtTeW1ib2wuaXRlcmF0b3JdO2lmKCFuKXJldHVybiBlO3ZhciByLG8saT1uLmNhbGwoZSksYT1bXTt0cnl7Zm9yKDsodm9pZCAwPT09dHx8dC0tID4wKSYmIShyPWkubmV4dCgpKS5kb25lOylhLnB1c2goci52YWx1ZSl9Y2F0Y2goZSl7bz17ZXJyb3I6ZX19ZmluYWxseXt0cnl7ciYmIXIuZG9uZSYmKG49aS5yZXR1cm4pJiZuLmNhbGwoaSl9ZmluYWxseXtpZihvKXRocm93IG8uZXJyb3J9fXJldHVybiBhfSxvPXRoaXMmJnRoaXMuX19zcHJlYWR8fGZ1bmN0aW9uKCl7Zm9yKHZhciBlPVtdLHQ9MDt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKWU9ZS5jb25jYXQocihhcmd1bWVudHNbdF0pKTtyZXR1cm4gZX07T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7dGhpcy5oYW5kbGVyc01hcD1PYmplY3QuY3JlYXRlKG51bGwpfXJldHVybiBlLnByb3RvdHlwZS5vbj1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmhhbmRsZXJzTWFwW2VdfHwodGhpcy5oYW5kbGVyc01hcFtlXT1bXSksdGhpcy5oYW5kbGVyc01hcFtlXS5wdXNoKHQpLHRoaXN9LGUucHJvdG90eXBlLm9mZj1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmhhbmRsZXJzTWFwW2VdJiZ0aGlzLmhhbmRsZXJzTWFwW2VdLnNwbGljZSh0aGlzLmhhbmRsZXJzTWFwW2VdLmluZGV4T2YodCk+Pj4wLDEpLHRoaXN9LGUucHJvdG90eXBlLmVtaXQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PVtdLG49MTtuPGFyZ3VtZW50cy5sZW5ndGg7bisrKXRbbi0xXT1hcmd1bWVudHNbbl07cmV0dXJuIHRoaXMuaGFuZGxlcnNNYXBbZV0mJnRoaXMuaGFuZGxlcnNNYXBbZV0uc2xpY2UoKS5mb3JFYWNoKChmdW5jdGlvbihlKXtlLmFwcGx5KHZvaWQgMCxvKHQpKX0pKSx0aGlzfSxlfSgpO3QuZGVmYXVsdD1pfSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7dmFyIHI9dGhpcyYmdGhpcy5fX2ltcG9ydERlZmF1bHR8fGZ1bmN0aW9uKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX07T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIG89cihuKDUpKSxpPW4oOSksYT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0LG4scixvKXt0aGlzLnN0YXJ0TWV0YT1lLHRoaXMuZW5kTWV0YT10LHRoaXMudGV4dD1uLHRoaXMuaWQ9cix0aGlzLl9faXNIaWdobGlnaHRTb3VyY2U9e30sbyYmKHRoaXMuZXh0cmE9byl9cmV0dXJuIGUucHJvdG90eXBlLmRlU2VyaWFsaXplPWZ1bmN0aW9uKGUsdCl7dmFyIG49aS5xdWVyeUVsZW1lbnROb2RlKHRoaXMsZSkscj1uLnN0YXJ0LGE9bi5lbmQsbD1pLmdldFRleHRDaGlsZEJ5T2Zmc2V0KHIsdGhpcy5zdGFydE1ldGEudGV4dE9mZnNldCksdT1pLmdldFRleHRDaGlsZEJ5T2Zmc2V0KGEsdGhpcy5lbmRNZXRhLnRleHRPZmZzZXQpO2lmKCF0LlNlcmlhbGl6ZS5SZXN0b3JlLmlzRW1wdHkoKSl7dmFyIHM9dC5TZXJpYWxpemUuUmVzdG9yZS5jYWxsKHRoaXMsbCx1KXx8W107bD1zWzBdfHxsLHU9c1sxXXx8dX1yZXR1cm4gbmV3IG8uZGVmYXVsdChsLHUsdGhpcy50ZXh0LHRoaXMuaWQsITApfSxlfSgpO3QuZGVmYXVsdD1hfSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7dmFyIHI9dGhpcyYmdGhpcy5fX3ZhbHVlc3x8ZnVuY3Rpb24oZSl7dmFyIHQ9XCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sJiZTeW1ib2wuaXRlcmF0b3Isbj10JiZlW3RdLHI9MDtpZihuKXJldHVybiBuLmNhbGwoZSk7aWYoZSYmXCJudW1iZXJcIj09dHlwZW9mIGUubGVuZ3RoKXJldHVybntuZXh0OmZ1bmN0aW9uKCl7cmV0dXJuIGUmJnI+PWUubGVuZ3RoJiYoZT12b2lkIDApLHt2YWx1ZTplJiZlW3IrK10sZG9uZTohZX19fTt0aHJvdyBuZXcgVHlwZUVycm9yKHQ/XCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiOlwiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKX0sbz10aGlzJiZ0aGlzLl9fcmVhZHx8ZnVuY3Rpb24oZSx0KXt2YXIgbj1cImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJmVbU3ltYm9sLml0ZXJhdG9yXTtpZighbilyZXR1cm4gZTt2YXIgcixvLGk9bi5jYWxsKGUpLGE9W107dHJ5e2Zvcig7KHZvaWQgMD09PXR8fHQtLSA+MCkmJiEocj1pLm5leHQoKSkuZG9uZTspYS5wdXNoKHIudmFsdWUpfWNhdGNoKGUpe289e2Vycm9yOmV9fWZpbmFsbHl7dHJ5e3ImJiFyLmRvbmUmJihuPWkucmV0dXJuKSYmbi5jYWxsKGkpfWZpbmFsbHl7aWYobyl0aHJvdyBvLmVycm9yfX1yZXR1cm4gYX0saT10aGlzJiZ0aGlzLl9fc3ByZWFkfHxmdW5jdGlvbigpe2Zvcih2YXIgZT1bXSx0PTA7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyllPWUuY29uY2F0KG8oYXJndW1lbnRzW3RdKSk7cmV0dXJuIGV9O09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuaGFzQ2xhc3M9dC5yZW1vdmVBbGxDbGFzcz10LnJlbW92ZUNsYXNzPXQuYWRkQ2xhc3M9dC5hZGRFdmVudExpc3RlbmVyPXQucmVtb3ZlRXZlbnRMaXN0ZW5lcj10LmZvckVhY2g9dC5nZXRIaWdobGlnaHRCeUlkPXQuZ2V0SGlnaGxpZ2h0c0J5Um9vdD10LmdldEV4dHJhSGlnaGxpZ2h0SWQ9dC5nZXRIaWdobGlnaHRJZD10LmlzSGlnaGxpZ2h0V3JhcE5vZGU9dm9pZCAwO3ZhciBhPW4oMCk7dC5pc0hpZ2hsaWdodFdyYXBOb2RlPWZ1bmN0aW9uKGUpe3JldHVybiEhZS5kYXRhc2V0JiYhIWUuZGF0YXNldFthLkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUl19O3ZhciBsPWZ1bmN0aW9uKGUsbil7Zm9yKHZhciByPSExLG89bnVsbDtlOyl7aWYodC5pc0hpZ2hsaWdodFdyYXBOb2RlKGUpJiYobz1lKSxlPT09bil7cj0hMDticmVha31lPWUucGFyZW50Tm9kZX1yZXR1cm4gcj9vOm51bGx9O3QuZ2V0SGlnaGxpZ2h0SWQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4oZT1sKGUsdCkpP2UuZGF0YXNldFthLkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUl06XCJcIn07dC5nZXRFeHRyYUhpZ2hsaWdodElkPWZ1bmN0aW9uKGUsdCl7cmV0dXJuKGU9bChlLHQpKT9lLmRhdGFzZXRbYS5DQU1FTF9EQVRBU0VUX0lERU5USUZJRVJfRVhUUkFdLnNwbGl0KGEuSURfRElWSVNJT04pLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIGV9KSk6W119O3QuZ2V0SGlnaGxpZ2h0c0J5Um9vdD1mdW5jdGlvbihlLHQpe3ZhciBuLG87QXJyYXkuaXNBcnJheShlKXx8KGU9W2VdKTt2YXIgaT1bXTt0cnl7Zm9yKHZhciBsPXIoZSksdT1sLm5leHQoKTshdS5kb25lO3U9bC5uZXh0KCkpe3ZhciBzPXUudmFsdWUucXVlcnlTZWxlY3RvckFsbCh0K1wiW2RhdGEtXCIrYS5EQVRBU0VUX0lERU5USUZJRVIrXCJdXCIpO2kucHVzaC5hcHBseShpLHMpfX1jYXRjaChlKXtuPXtlcnJvcjplfX1maW5hbGx5e3RyeXt1JiYhdS5kb25lJiYobz1sLnJldHVybikmJm8uY2FsbChsKX1maW5hbGx5e2lmKG4pdGhyb3cgbi5lcnJvcn19cmV0dXJuIGl9O3QuZ2V0SGlnaGxpZ2h0QnlJZD1mdW5jdGlvbihlLHQsbil7dmFyIG8saSxsPVtdLHU9bmV3IFJlZ0V4cChcIihcIit0K1wiXFxcXFwiK2EuSURfRElWSVNJT04rXCJ8XFxcXFwiK2EuSURfRElWSVNJT04rXCI/XCIrdCtcIiQpXCIpLHM9ZS5xdWVyeVNlbGVjdG9yQWxsKG4rXCJbZGF0YS1cIithLkRBVEFTRVRfSURFTlRJRklFUitcIl1cIik7dHJ5e2Zvcih2YXIgZD1yKHMpLGM9ZC5uZXh0KCk7IWMuZG9uZTtjPWQubmV4dCgpKXt2YXIgZj1jLnZhbHVlO2lmKGYuZGF0YXNldFthLkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUl0hPT10KXt2YXIgaD1mLmRhdGFzZXRbYS5DQU1FTF9EQVRBU0VUX0lERU5USUZJRVJfRVhUUkFdO3UudGVzdChoKSYmbC5wdXNoKGYpfWVsc2UgbC5wdXNoKGYpfX1jYXRjaChlKXtvPXtlcnJvcjplfX1maW5hbGx5e3RyeXtjJiYhYy5kb25lJiYoaT1kLnJldHVybikmJmkuY2FsbChkKX1maW5hbGx5e2lmKG8pdGhyb3cgby5lcnJvcn19cmV0dXJuIGx9O3QuZm9yRWFjaD1mdW5jdGlvbihlLHQpe2Zvcih2YXIgbj0wO248ZS5sZW5ndGg7bisrKXQoZVtuXSxuLGUpfTt0LnJlbW92ZUV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oZSx0LG4pe2UucmVtb3ZlRXZlbnRMaXN0ZW5lcih0LG4pfTt0LmFkZEV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oZSxuLHIpe3JldHVybiBlLmFkZEV2ZW50TGlzdGVuZXIobixyKSxmdW5jdGlvbigpe3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLG4scil9fTt0LmFkZENsYXNzPWZ1bmN0aW9uKGUsdCl7dmFyIG47QXJyYXkuaXNBcnJheSh0KXx8KHQ9W3RdKSwobj1lLmNsYXNzTGlzdCkuYWRkLmFwcGx5KG4saSh0KSl9O3QucmVtb3ZlQ2xhc3M9ZnVuY3Rpb24oZSx0KXtlLmNsYXNzTGlzdC5yZW1vdmUodCl9O3QucmVtb3ZlQWxsQ2xhc3M9ZnVuY3Rpb24oZSl7ZS5jbGFzc05hbWU9XCJcIn07dC5oYXNDbGFzcz1mdW5jdGlvbihlLHQpe3JldHVybiBlLmNsYXNzTGlzdC5jb250YWlucyh0KX19LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjt2YXIgcj10aGlzJiZ0aGlzLl9faW1wb3J0RGVmYXVsdHx8ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fTtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgbz1yKG4oMykpLGk9bigxKSxhPW4oMTEpLGw9cihuKDYpKSx1PW4oMTIpLHM9bigwKSxkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQsbixyLG8pe3ZvaWQgMD09PW8mJihvPSExKSwzPT09ZS4kbm9kZS5ub2RlVHlwZSYmMz09PXQuJG5vZGUubm9kZVR5cGV8fHMuZXZlbnRFbWl0dGVyLmVtaXQocy5JTlRFUk5BTF9FUlJPUl9FVkVOVCx7dHlwZTppLkVSUk9SLlJBTkdFX05PREVfSU5WQUxJRH0pLHRoaXMuc3RhcnQ9dS5mb3JtYXREb21Ob2RlKGUpLHRoaXMuZW5kPXUuZm9ybWF0RG9tTm9kZSh0KSx0aGlzLnRleHQ9bix0aGlzLmZyb3plbj1vLHRoaXMuaWQ9cn1yZXR1cm4gZS5mcm9tU2VsZWN0aW9uPWZ1bmN0aW9uKHQpe3ZhciBuPWEuZ2V0RG9tUmFuZ2UoKTtpZighbilyZXR1cm4gbnVsbDt2YXIgcj17JG5vZGU6bi5zdGFydENvbnRhaW5lcixvZmZzZXQ6bi5zdGFydE9mZnNldH0sbz17JG5vZGU6bi5lbmRDb250YWluZXIsb2Zmc2V0Om4uZW5kT2Zmc2V0fSxpPW4udG9TdHJpbmcoKSx1PXQuY2FsbChyLG8saSk7cmV0dXJuIG5ldyBlKHIsbyxpLHU9bnVsbCE9dT91OmwuZGVmYXVsdCgpKX0sZS5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKGUsdCl7dmFyIG4scj11LmdldERvbU1ldGEodGhpcy5zdGFydC4kbm9kZSx0aGlzLnN0YXJ0Lm9mZnNldCxlKSxpPXUuZ2V0RG9tTWV0YSh0aGlzLmVuZC4kbm9kZSx0aGlzLmVuZC5vZmZzZXQsZSk7cmV0dXJuIHQuU2VyaWFsaXplLlJlY29yZEluZm8uaXNFbXB0eSgpfHwobj10LlNlcmlhbGl6ZS5SZWNvcmRJbmZvLmNhbGwodGhpcy5zdGFydCx0aGlzLmVuZCxlKSksdGhpcy5mcm96ZW49ITAsbmV3IG8uZGVmYXVsdChyLGksdGhpcy50ZXh0LHRoaXMuaWQsbil9LGUucmVtb3ZlRG9tUmFuZ2U9YS5yZW1vdmVTZWxlY3Rpb24sZX0oKTt0LmRlZmF1bHQ9ZH0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuZGVmYXVsdD1mdW5jdGlvbiBlKHQpe3JldHVybiB0Pyh0XjE2Kk1hdGgucmFuZG9tKCk+PnQvNCkudG9TdHJpbmcoMTYpOihbMWU3XSstMWUzKy00ZTMrLThlMystMWUxMSkucmVwbGFjZSgvWzAxOF0vZyxlKX19LGZ1bmN0aW9uKGUsdCxuKXtlLmV4cG9ydHM9big4KX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO3ZhciByLG89dGhpcyYmdGhpcy5fX2V4dGVuZHN8fChyPWZ1bmN0aW9uKGUsdCl7cmV0dXJuKHI9T2JqZWN0LnNldFByb3RvdHlwZU9mfHx7X19wcm90b19fOltdfWluc3RhbmNlb2YgQXJyYXkmJmZ1bmN0aW9uKGUsdCl7ZS5fX3Byb3RvX189dH18fGZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuIGluIHQpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsbikmJihlW25dPXRbbl0pfSkoZSx0KX0sZnVuY3Rpb24oZSx0KXtmdW5jdGlvbiBuKCl7dGhpcy5jb25zdHJ1Y3Rvcj1lfXIoZSx0KSxlLnByb3RvdHlwZT1udWxsPT09dD9PYmplY3QuY3JlYXRlKHQpOihuLnByb3RvdHlwZT10LnByb3RvdHlwZSxuZXcgbil9KSxpPXRoaXMmJnRoaXMuX19hc3NpZ258fGZ1bmN0aW9uKCl7cmV0dXJuKGk9T2JqZWN0LmFzc2lnbnx8ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG49MSxyPWFyZ3VtZW50cy5sZW5ndGg7bjxyO24rKylmb3IodmFyIG8gaW4gdD1hcmd1bWVudHNbbl0pT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsbykmJihlW29dPXRbb10pO3JldHVybiBlfSkuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxhPXRoaXMmJnRoaXMuX19pbXBvcnREZWZhdWx0fHxmdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19O09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBsPWEobigyKSksdT1hKG4oNSkpLHM9YShuKDMpKSxkPWEobig2KSksYz1hKG4oMTMpKSxmPWEobigxNCkpLGg9YShuKDE2KSkscD1hKG4oMTcpKSxFPW4oMCksXz1uKDEpLHY9big0KSxUPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCl7dmFyIG49ZS5jYWxsKHRoaXMpfHx0aGlzO24uZXZlbnQ9Zi5kZWZhdWx0KCksbi5ydW49ZnVuY3Rpb24oKXtyZXR1cm4gdi5hZGRFdmVudExpc3RlbmVyKG4ub3B0aW9ucy4kcm9vdCxuLmV2ZW50LlBvaW50ZXJFbmQsbi5faGFuZGxlU2VsZWN0aW9uKX0sbi5zdG9wPWZ1bmN0aW9uKCl7di5yZW1vdmVFdmVudExpc3RlbmVyKG4ub3B0aW9ucy4kcm9vdCxuLmV2ZW50LlBvaW50ZXJFbmQsbi5faGFuZGxlU2VsZWN0aW9uKX0sbi5hZGRDbGFzcz1mdW5jdGlvbihlLHQpe24uZ2V0RG9tcyh0KS5mb3JFYWNoKChmdW5jdGlvbih0KXt2LmFkZENsYXNzKHQsZSl9KSl9LG4ucmVtb3ZlQ2xhc3M9ZnVuY3Rpb24oZSx0KXtuLmdldERvbXModCkuZm9yRWFjaCgoZnVuY3Rpb24odCl7di5yZW1vdmVDbGFzcyh0LGUpfSkpfSxuLmdldElkQnlEb209ZnVuY3Rpb24oZSl7cmV0dXJuIHYuZ2V0SGlnaGxpZ2h0SWQoZSxuLm9wdGlvbnMuJHJvb3QpfSxuLmdldEV4dHJhSWRCeURvbT1mdW5jdGlvbihlKXtyZXR1cm4gdi5nZXRFeHRyYUhpZ2hsaWdodElkKGUsbi5vcHRpb25zLiRyb290KX0sbi5nZXREb21zPWZ1bmN0aW9uKGUpe3JldHVybiBlP3YuZ2V0SGlnaGxpZ2h0QnlJZChuLm9wdGlvbnMuJHJvb3QsZSxuLm9wdGlvbnMud3JhcFRhZyk6di5nZXRIaWdobGlnaHRzQnlSb290KG4ub3B0aW9ucy4kcm9vdCxuLm9wdGlvbnMud3JhcFRhZyl9LG4uZGlzcG9zZT1mdW5jdGlvbigpe3ZhciBlPW4ub3B0aW9ucy4kcm9vdDt2LnJlbW92ZUV2ZW50TGlzdGVuZXIoZSxuLmV2ZW50LlBvaW50ZXJPdmVyLG4uX2hhbmRsZUhpZ2hsaWdodEhvdmVyKSx2LnJlbW92ZUV2ZW50TGlzdGVuZXIoZSxuLmV2ZW50LlBvaW50ZXJFbmQsbi5faGFuZGxlU2VsZWN0aW9uKSx2LnJlbW92ZUV2ZW50TGlzdGVuZXIoZSxuLmV2ZW50LlBvaW50ZXJUYXAsbi5faGFuZGxlSGlnaGxpZ2h0Q2xpY2spLG4ucmVtb3ZlQWxsKCl9LG4uc2V0T3B0aW9uPWZ1bmN0aW9uKGUpe24ub3B0aW9ucz1pKGkoe30sbi5vcHRpb25zKSxlKSxuLnBhaW50ZXI9bmV3IHAuZGVmYXVsdCh7JHJvb3Q6bi5vcHRpb25zLiRyb290LHdyYXBUYWc6bi5vcHRpb25zLndyYXBUYWcsY2xhc3NOYW1lOm4ub3B0aW9ucy5zdHlsZS5jbGFzc05hbWUsZXhjZXB0U2VsZWN0b3JzOm4ub3B0aW9ucy5leGNlcHRTZWxlY3RvcnN9LG4uaG9va3MpfSxuLmZyb21SYW5nZT1mdW5jdGlvbihlKXt2YXIgdD17JG5vZGU6ZS5zdGFydENvbnRhaW5lcixvZmZzZXQ6ZS5zdGFydE9mZnNldH0scj17JG5vZGU6ZS5lbmRDb250YWluZXIsb2Zmc2V0OmUuZW5kT2Zmc2V0fSxvPWUudG9TdHJpbmcoKSxpPW4uaG9va3MuUmVuZGVyLlVVSUQuY2FsbCh0LHIsbyk7aT1udWxsIT1pP2k6ZC5kZWZhdWx0KCk7dmFyIGE9bmV3IHUuZGVmYXVsdCh0LHIsbyxpKTtyZXR1cm4gYT9uLl9oaWdobGlnaHRGcm9tSFJhbmdlKGEpOihFLmV2ZW50RW1pdHRlci5lbWl0KEUuSU5URVJOQUxfRVJST1JfRVZFTlQse3R5cGU6Xy5FUlJPUi5SQU5HRV9JTlZBTElEfSksbnVsbCl9LG4uZnJvbVN0b3JlPWZ1bmN0aW9uKGUsdCxyLG8saSl7dmFyIGE9bmV3IHMuZGVmYXVsdChlLHQscixvLGkpO3RyeXtyZXR1cm4gbi5faGlnaGxpZ2h0RnJvbUhTb3VyY2UoYSksYX1jYXRjaChlKXtyZXR1cm4gRS5ldmVudEVtaXR0ZXIuZW1pdChFLklOVEVSTkFMX0VSUk9SX0VWRU5ULHt0eXBlOl8uRVJST1IuSElHSExJR0hUX1NPVVJDRV9SRUNSRUFURSxlcnJvcjplLGRldGFpbDphfSksbnVsbH19LG4uX2dldEhvb2tzPWZ1bmN0aW9uKCl7cmV0dXJue1JlbmRlcjp7VVVJRDpuZXcgYy5kZWZhdWx0KFwiUmVuZGVyLlVVSURcIiksU2VsZWN0ZWROb2RlczpuZXcgYy5kZWZhdWx0KFwiUmVuZGVyLlNlbGVjdGVkTm9kZXNcIiksV3JhcE5vZGU6bmV3IGMuZGVmYXVsdChcIlJlbmRlci5XcmFwTm9kZVwiKX0sU2VyaWFsaXplOntSZXN0b3JlOm5ldyBjLmRlZmF1bHQoXCJTZXJpYWxpemUuUmVzdG9yZVwiKSxSZWNvcmRJbmZvOm5ldyBjLmRlZmF1bHQoXCJTZXJpYWxpemUuUmVjb3JkSW5mb1wiKX0sUmVtb3ZlOntVcGRhdGVOb2RlczpuZXcgYy5kZWZhdWx0KFwiUmVtb3ZlLlVwZGF0ZU5vZGVzXCIpfX19LG4uX2hpZ2hsaWdodEZyb21IUmFuZ2U9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5zZXJpYWxpemUobi5vcHRpb25zLiRyb290LG4uaG9va3MpO3JldHVybiAwPT09bi5wYWludGVyLmhpZ2hsaWdodFJhbmdlKGUpLmxlbmd0aD8oRS5ldmVudEVtaXR0ZXIuZW1pdChFLklOVEVSTkFMX0VSUk9SX0VWRU5ULHt0eXBlOl8uRVJST1IuRE9NX1NFTEVDVElPTl9FTVBUWX0pLG51bGwpOihuLmNhY2hlLnNhdmUodCksbi5lbWl0KF8uRXZlbnRUeXBlLkNSRUFURSx7c291cmNlczpbdF0sdHlwZTpfLkNyZWF0ZUZyb20uSU5QVVR9LG4pLHQpfSxuLl9oYW5kbGVTZWxlY3Rpb249ZnVuY3Rpb24oKXt2YXIgZT11LmRlZmF1bHQuZnJvbVNlbGVjdGlvbihuLmhvb2tzLlJlbmRlci5VVUlEKTtlJiYobi5faGlnaGxpZ2h0RnJvbUhSYW5nZShlKSx1LmRlZmF1bHQucmVtb3ZlRG9tUmFuZ2UoKSl9LG4uX2hhbmRsZUhpZ2hsaWdodEhvdmVyPWZ1bmN0aW9uKGUpe3ZhciB0PWUudGFyZ2V0O2lmKCF2LmlzSGlnaGxpZ2h0V3JhcE5vZGUodCkpcmV0dXJuIG4uX2hvdmVySWQmJm4uZW1pdChfLkV2ZW50VHlwZS5IT1ZFUl9PVVQse2lkOm4uX2hvdmVySWR9LG4sZSksdm9pZChuLl9ob3ZlcklkPW51bGwpO3ZhciByPXYuZ2V0SGlnaGxpZ2h0SWQodCxuLm9wdGlvbnMuJHJvb3QpO24uX2hvdmVySWQhPT1yJiYobi5faG92ZXJJZCYmbi5lbWl0KF8uRXZlbnRUeXBlLkhPVkVSX09VVCx7aWQ6bi5faG92ZXJJZH0sbixlKSxuLl9ob3ZlcklkPXIsbi5lbWl0KF8uRXZlbnRUeXBlLkhPVkVSLHtpZDpuLl9ob3ZlcklkfSxuLGUpKX0sbi5faGFuZGxlRXJyb3I9ZnVuY3Rpb24oZSl7bi5vcHRpb25zLnZlcmJvc2UmJmNvbnNvbGUud2FybihlKX0sbi5faGFuZGxlSGlnaGxpZ2h0Q2xpY2s9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS50YXJnZXQ7aWYodi5pc0hpZ2hsaWdodFdyYXBOb2RlKHQpKXt2YXIgcj12LmdldEhpZ2hsaWdodElkKHQsbi5vcHRpb25zLiRyb290KTtuLmVtaXQoXy5FdmVudFR5cGUuQ0xJQ0sse2lkOnJ9LG4sZSl9fSxuLm9wdGlvbnM9RS5nZXREZWZhdWx0T3B0aW9ucygpLG4uaG9va3M9bi5fZ2V0SG9va3MoKSxuLnNldE9wdGlvbih0KSxuLmNhY2hlPW5ldyBoLmRlZmF1bHQ7dmFyIHI9bi5vcHRpb25zLiRyb290O3JldHVybiB2LmFkZEV2ZW50TGlzdGVuZXIocixuLmV2ZW50LlBvaW50ZXJPdmVyLG4uX2hhbmRsZUhpZ2hsaWdodEhvdmVyKSx2LmFkZEV2ZW50TGlzdGVuZXIocixuLmV2ZW50LlBvaW50ZXJUYXAsbi5faGFuZGxlSGlnaGxpZ2h0Q2xpY2spLEUuZXZlbnRFbWl0dGVyLm9uKEUuSU5URVJOQUxfRVJST1JfRVZFTlQsbi5faGFuZGxlRXJyb3IpLG59cmV0dXJuIG8odCxlKSx0LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oZSl7aWYoZSl7dmFyIHQ9dGhpcy5wYWludGVyLnJlbW92ZUhpZ2hsaWdodChlKTt0aGlzLmNhY2hlLnJlbW92ZShlKSx0JiZ0aGlzLmVtaXQoXy5FdmVudFR5cGUuUkVNT1ZFLHtpZHM6W2VdfSx0aGlzKX19LHQucHJvdG90eXBlLnJlbW92ZUFsbD1mdW5jdGlvbigpe3RoaXMucGFpbnRlci5yZW1vdmVBbGxIaWdobGlnaHQoKTt2YXIgZT10aGlzLmNhY2hlLnJlbW92ZUFsbCgpO3RoaXMuZW1pdChfLkV2ZW50VHlwZS5SRU1PVkUse2lkczplfSx0aGlzKX0sdC5wcm90b3R5cGUuX2hpZ2hsaWdodEZyb21IU291cmNlPWZ1bmN0aW9uKGUpe3ZvaWQgMD09PWUmJihlPVtdKTt2YXIgdD10aGlzLnBhaW50ZXIuaGlnaGxpZ2h0U291cmNlKGUpO3RoaXMuZW1pdChfLkV2ZW50VHlwZS5DUkVBVEUse3NvdXJjZXM6dCx0eXBlOl8uQ3JlYXRlRnJvbS5TVE9SRX0sdGhpcyksdGhpcy5jYWNoZS5zYXZlKGUpfSx0LmV2ZW50PV8uRXZlbnRUeXBlLHQuaXNIaWdobGlnaHRXcmFwTm9kZT12LmlzSGlnaGxpZ2h0V3JhcE5vZGUsdC5pc0hpZ2hsaWdodFNvdXJjZT1mdW5jdGlvbihlKXtyZXR1cm4hIWUuX19pc0hpZ2hsaWdodFNvdXJjZX0sdH0obC5kZWZhdWx0KTt0LmRlZmF1bHQ9VH0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQucXVlcnlFbGVtZW50Tm9kZT10LmdldFRleHRDaGlsZEJ5T2Zmc2V0PXZvaWQgMDt2YXIgcj1uKDApO3QuZ2V0VGV4dENoaWxkQnlPZmZzZXQ9ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49W2VdLHI9bnVsbCxvPTAsaT0wO3I9bi5wb3AoKTspe2Zvcih2YXIgYT1yLmNoaWxkTm9kZXMsbD1hLmxlbmd0aC0xO2w+PTA7bC0tKW4ucHVzaChhW2xdKTtpZigzPT09ci5ub2RlVHlwZSYmKGk9dC1vLChvKz1yLnRleHRDb250ZW50Lmxlbmd0aCk+PXQpKWJyZWFrfXJldHVybiByfHwocj1lKSx7JG5vZGU6cixvZmZzZXQ6aX19O3QucXVlcnlFbGVtZW50Tm9kZT1mdW5jdGlvbihlLHQpe3JldHVybntzdGFydDplLnN0YXJ0TWV0YS5wYXJlbnRJbmRleD09PXIuUk9PVF9JRFg/dDp0LmdldEVsZW1lbnRzQnlUYWdOYW1lKGUuc3RhcnRNZXRhLnBhcmVudFRhZ05hbWUpW2Uuc3RhcnRNZXRhLnBhcmVudEluZGV4XSxlbmQ6ZS5lbmRNZXRhLnBhcmVudEluZGV4PT09ci5ST09UX0lEWD90OnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoZS5lbmRNZXRhLnBhcmVudFRhZ05hbWUpW2UuZW5kTWV0YS5wYXJlbnRJbmRleF19fX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuZGVmYXVsdD1mdW5jdGlvbihlKXtyZXR1cm4gZS5zcGxpdChcIi1cIikucmVkdWNlKChmdW5jdGlvbihlLHQsbil7cmV0dXJuIGUrKDA9PT1uP3Q6dFswXS50b1VwcGVyQ2FzZSgpK3Quc2xpY2UoMSkpfSksXCJcIil9fSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksdC5yZW1vdmVTZWxlY3Rpb249dC5nZXREb21SYW5nZT12b2lkIDA7dC5nZXREb21SYW5nZT1mdW5jdGlvbigpe3ZhciBlPXdpbmRvdy5nZXRTZWxlY3Rpb24oKTtyZXR1cm4gZS5pc0NvbGxhcHNlZD8oY29uc29sZS5kZWJ1ZyhcIm5vIHRleHQgc2VsZWN0ZWRcIiksbnVsbCk6ZS5nZXRSYW5nZUF0KDApfTt0LnJlbW92ZVNlbGVjdGlvbj1mdW5jdGlvbigpe3dpbmRvdy5nZXRTZWxlY3Rpb24oKS5yZW1vdmVBbGxSYW5nZXMoKX19LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LmZvcm1hdERvbU5vZGU9dC5nZXREb21NZXRhPXZvaWQgMDt2YXIgcj1uKDApO3QuZ2V0RG9tTWV0YT1mdW5jdGlvbihlLHQsbil7dmFyIG89ZnVuY3Rpb24oZSl7aWYoZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50JiYoIWUuZGF0YXNldHx8IWUuZGF0YXNldFtyLkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUl0pKXJldHVybiBlO2Zvcih2YXIgdD1lLnBhcmVudE5vZGU7bnVsbD09dD92b2lkIDA6dC5kYXRhc2V0W3IuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSXTspdD10LnBhcmVudE5vZGU7cmV0dXJuIHR9KGUpLGk9bz09PW4/ci5ST09UX0lEWDpmdW5jdGlvbihlLHQpe2Zvcih2YXIgbj1lLnRhZ05hbWUsbz10LmdldEVsZW1lbnRzQnlUYWdOYW1lKG4pLGk9MDtpPG8ubGVuZ3RoO2krKylpZihlPT09b1tpXSlyZXR1cm4gaTtyZXR1cm4gci5VTktOT1dOX0lEWH0obyxuKSxhPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPVtlXSxyPW51bGwsbz0wO3I9bi5wb3AoKTspe2Zvcih2YXIgaT1yLmNoaWxkTm9kZXMsYT1pLmxlbmd0aC0xO2E+PTA7YS0tKW4ucHVzaChpW2FdKTtpZigzPT09ci5ub2RlVHlwZSYmciE9PXQpbys9ci50ZXh0Q29udGVudC5sZW5ndGg7ZWxzZSBpZigzPT09ci5ub2RlVHlwZSlicmVha31yZXR1cm4gb30obyxlKTtyZXR1cm57cGFyZW50VGFnTmFtZTpvLnRhZ05hbWUscGFyZW50SW5kZXg6aSx0ZXh0T2Zmc2V0OmErdH19O3QuZm9ybWF0RG9tTm9kZT1mdW5jdGlvbihlKXtyZXR1cm4gMz09PWUuJG5vZGUubm9kZVR5cGV8fDQ9PT1lLiRub2RlLm5vZGVUeXBlfHw4PT09ZS4kbm9kZS5ub2RlVHlwZT9lOnskbm9kZTplLiRub2RlLmNoaWxkTm9kZXNbZS5vZmZzZXRdLG9mZnNldDowfX19LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjt2YXIgcj10aGlzJiZ0aGlzLl9fcmVhZHx8ZnVuY3Rpb24oZSx0KXt2YXIgbj1cImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJmVbU3ltYm9sLml0ZXJhdG9yXTtpZighbilyZXR1cm4gZTt2YXIgcixvLGk9bi5jYWxsKGUpLGE9W107dHJ5e2Zvcig7KHZvaWQgMD09PXR8fHQtLSA+MCkmJiEocj1pLm5leHQoKSkuZG9uZTspYS5wdXNoKHIudmFsdWUpfWNhdGNoKGUpe289e2Vycm9yOmV9fWZpbmFsbHl7dHJ5e3ImJiFyLmRvbmUmJihuPWkucmV0dXJuKSYmbi5jYWxsKGkpfWZpbmFsbHl7aWYobyl0aHJvdyBvLmVycm9yfX1yZXR1cm4gYX0sbz10aGlzJiZ0aGlzLl9fc3ByZWFkfHxmdW5jdGlvbigpe2Zvcih2YXIgZT1bXSx0PTA7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyllPWUuY29uY2F0KHIoYXJndW1lbnRzW3RdKSk7cmV0dXJuIGV9O09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXt0aGlzLm5hbWU9XCJcIix0aGlzLm9wcz1bXSx0aGlzLm5hbWU9ZX1yZXR1cm4gZS5wcm90b3R5cGUudGFwPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7cmV0dXJuLTE9PT10aGlzLm9wcy5pbmRleE9mKGUpJiZ0aGlzLm9wcy5wdXNoKGUpLGZ1bmN0aW9uKCl7dC5yZW1vdmUoZSl9fSxlLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5vcHMuaW5kZXhPZihlKTt0PDB8fHRoaXMub3BzLnNwbGljZSh0LDEpfSxlLnByb3RvdHlwZS5pc0VtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLm9wcy5sZW5ndGh9LGUucHJvdG90eXBlLmNhbGw9ZnVuY3Rpb24oKXtmb3IodmFyIGUsdD1bXSxuPTA7bjxhcmd1bWVudHMubGVuZ3RoO24rKyl0W25dPWFyZ3VtZW50c1tuXTtyZXR1cm4gdGhpcy5vcHMuZm9yRWFjaCgoZnVuY3Rpb24obil7ZT1uLmFwcGx5KHZvaWQgMCxvKHQpKX0pKSxlfSxlfSgpO3QuZGVmYXVsdD1pfSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7dmFyIHI9dGhpcyYmdGhpcy5fX2ltcG9ydERlZmF1bHR8fGZ1bmN0aW9uKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX07T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIG89bigxKSxpPXIobigxNSkpO3QuZGVmYXVsdD1mdW5jdGlvbigpe3ZhciBlPWkuZGVmYXVsdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk7cmV0dXJue1BvaW50ZXJFbmQ6ZT9vLlVzZXJJbnB1dEV2ZW50LnRvdWNoZW5kOm8uVXNlcklucHV0RXZlbnQubW91c2V1cCxQb2ludGVyVGFwOmU/by5Vc2VySW5wdXRFdmVudC50b3VjaHN0YXJ0Om8uVXNlcklucHV0RXZlbnQuY2xpY2ssUG9pbnRlck92ZXI6ZT9vLlVzZXJJbnB1dEV2ZW50LnRvdWNoc3RhcnQ6by5Vc2VySW5wdXRFdmVudC5tb3VzZW92ZXJ9fX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciByPS9BbmRyb2lkfGlQaG9uZXxCbGFja0JlcnJ5fEJCMTB8T3BlcmEgTWluaXxQaG9uZXxNb2JpbGV8U2lsa3xXaW5kb3dzIFBob25lfE1vYmlsZSg/Oi4rKUZpcmVmb3hcXGIvaTt0LmRlZmF1bHQ9ZnVuY3Rpb24oZSl7cmV0dXJuIHIudGVzdChlKX19LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjt2YXIgcixvPXRoaXMmJnRoaXMuX19leHRlbmRzfHwocj1mdW5jdGlvbihlLHQpe3JldHVybihyPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihlLHQpe2UuX19wcm90b19fPXR9fHxmdW5jdGlvbihlLHQpe2Zvcih2YXIgbiBpbiB0KU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LG4pJiYoZVtuXT10W25dKX0pKGUsdCl9LGZ1bmN0aW9uKGUsdCl7ZnVuY3Rpb24gbigpe3RoaXMuY29uc3RydWN0b3I9ZX1yKGUsdCksZS5wcm90b3R5cGU9bnVsbD09PXQ/T2JqZWN0LmNyZWF0ZSh0KToobi5wcm90b3R5cGU9dC5wcm90b3R5cGUsbmV3IG4pfSksaT10aGlzJiZ0aGlzLl9fdmFsdWVzfHxmdW5jdGlvbihlKXt2YXIgdD1cImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJlN5bWJvbC5pdGVyYXRvcixuPXQmJmVbdF0scj0wO2lmKG4pcmV0dXJuIG4uY2FsbChlKTtpZihlJiZcIm51bWJlclwiPT10eXBlb2YgZS5sZW5ndGgpcmV0dXJue25leHQ6ZnVuY3Rpb24oKXtyZXR1cm4gZSYmcj49ZS5sZW5ndGgmJihlPXZvaWQgMCkse3ZhbHVlOmUmJmVbcisrXSxkb25lOiFlfX19O3Rocm93IG5ldyBUeXBlRXJyb3IodD9cIk9iamVjdCBpcyBub3QgaXRlcmFibGUuXCI6XCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpfSxhPXRoaXMmJnRoaXMuX19pbXBvcnREZWZhdWx0fHxmdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19O09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBsPWEobigyKSksdT1uKDEpLHM9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe3ZhciB0PW51bGwhPT1lJiZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpcztyZXR1cm4gdC5fZGF0YT1uZXcgTWFwLHR9cmV0dXJuIG8odCxlKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJkYXRhXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldEFsbCgpfSxzZXQ6ZnVuY3Rpb24oZSl7dGhyb3cgdS5FUlJPUi5DQUNIRV9TRVRfRVJST1J9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuc2F2ZT1mdW5jdGlvbihlKXt2YXIgdD10aGlzO0FycmF5LmlzQXJyYXkoZSk/ZS5mb3JFYWNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5fZGF0YS5zZXQoZS5pZCxlKX0pKTp0aGlzLl9kYXRhLnNldChlLmlkLGUpfSx0LnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2RhdGEuZ2V0KGUpfSx0LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oZSl7dGhpcy5fZGF0YS5kZWxldGUoZSl9LHQucHJvdG90eXBlLmdldEFsbD1mdW5jdGlvbigpe3ZhciBlLHQsbj1bXTt0cnl7Zm9yKHZhciByPWkodGhpcy5fZGF0YSksbz1yLm5leHQoKTshby5kb25lO289ci5uZXh0KCkpe3ZhciBhPW8udmFsdWU7bi5wdXNoKGFbMV0pfX1jYXRjaCh0KXtlPXtlcnJvcjp0fX1maW5hbGx5e3RyeXtvJiYhby5kb25lJiYodD1yLnJldHVybikmJnQuY2FsbChyKX1maW5hbGx5e2lmKGUpdGhyb3cgZS5lcnJvcn19cmV0dXJuIG59LHQucHJvdG90eXBlLnJlbW92ZUFsbD1mdW5jdGlvbigpe3ZhciBlLHQsbj1bXTt0cnl7Zm9yKHZhciByPWkodGhpcy5fZGF0YSksbz1yLm5leHQoKTshby5kb25lO289ci5uZXh0KCkpe3ZhciBhPW8udmFsdWU7bi5wdXNoKGFbMF0pfX1jYXRjaCh0KXtlPXtlcnJvcjp0fX1maW5hbGx5e3RyeXtvJiYhby5kb25lJiYodD1yLnJldHVybikmJnQuY2FsbChyKX1maW5hbGx5e2lmKGUpdGhyb3cgZS5lcnJvcn19cmV0dXJuIHRoaXMuX2RhdGE9bmV3IE1hcCxufSx0fShsLmRlZmF1bHQpO3QuZGVmYXVsdD1zfSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7dmFyIHI9dGhpcyYmdGhpcy5fX3ZhbHVlc3x8ZnVuY3Rpb24oZSl7dmFyIHQ9XCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sJiZTeW1ib2wuaXRlcmF0b3Isbj10JiZlW3RdLHI9MDtpZihuKXJldHVybiBuLmNhbGwoZSk7aWYoZSYmXCJudW1iZXJcIj09dHlwZW9mIGUubGVuZ3RoKXJldHVybntuZXh0OmZ1bmN0aW9uKCl7cmV0dXJuIGUmJnI+PWUubGVuZ3RoJiYoZT12b2lkIDApLHt2YWx1ZTplJiZlW3IrK10sZG9uZTohZX19fTt0aHJvdyBuZXcgVHlwZUVycm9yKHQ/XCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiOlwiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKX0sbz10aGlzJiZ0aGlzLl9fcmVhZHx8ZnVuY3Rpb24oZSx0KXt2YXIgbj1cImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJmVbU3ltYm9sLml0ZXJhdG9yXTtpZighbilyZXR1cm4gZTt2YXIgcixvLGk9bi5jYWxsKGUpLGE9W107dHJ5e2Zvcig7KHZvaWQgMD09PXR8fHQtLSA+MCkmJiEocj1pLm5leHQoKSkuZG9uZTspYS5wdXNoKHIudmFsdWUpfWNhdGNoKGUpe289e2Vycm9yOmV9fWZpbmFsbHl7dHJ5e3ImJiFyLmRvbmUmJihuPWkucmV0dXJuKSYmbi5jYWxsKGkpfWZpbmFsbHl7aWYobyl0aHJvdyBvLmVycm9yfX1yZXR1cm4gYX0saT10aGlzJiZ0aGlzLl9fc3ByZWFkfHxmdW5jdGlvbigpe2Zvcih2YXIgZT1bXSx0PTA7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyllPWUuY29uY2F0KG8oYXJndW1lbnRzW3RdKSk7cmV0dXJuIGV9LGE9dGhpcyYmdGhpcy5fX2ltcG9ydERlZmF1bHR8fGZ1bmN0aW9uKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX07T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIGw9YShuKDMpKSx1PW4oMTgpLHM9big0KSxkPW4oMSksYz1uKDIwKSxmPW4oMCksaD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXt0aGlzLm9wdGlvbnM9eyRyb290OmUuJHJvb3Qsd3JhcFRhZzplLndyYXBUYWcsZXhjZXB0U2VsZWN0b3JzOmUuZXhjZXB0U2VsZWN0b3JzLGNsYXNzTmFtZTplLmNsYXNzTmFtZX0sdGhpcy5ob29rcz10LGMuaW5pdERlZmF1bHRTdHlsZXNoZWV0KCl9cmV0dXJuIGUucHJvdG90eXBlLmhpZ2hsaWdodFJhbmdlPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7aWYoIWUuZnJvemVuKXRocm93IGQuRVJST1IuSElHSExJR0hUX1JBTkdFX0ZST1pFTjt2YXIgbj10aGlzLm9wdGlvbnMscj1uLiRyb290LG89bi5jbGFzc05hbWUsaT1uLmV4Y2VwdFNlbGVjdG9ycyxhPXRoaXMuaG9va3MsbD11LmdldFNlbGVjdGVkTm9kZXMocixlLnN0YXJ0LGUuZW5kLGkpO3JldHVybiBhLlJlbmRlci5TZWxlY3RlZE5vZGVzLmlzRW1wdHkoKXx8KGw9YS5SZW5kZXIuU2VsZWN0ZWROb2Rlcy5jYWxsKGUuaWQsbCl8fFtdKSxsLm1hcCgoZnVuY3Rpb24obil7dmFyIHI9dS53cmFwSGlnaGxpZ2h0KG4sZSxvLHQub3B0aW9ucy53cmFwVGFnKTtyZXR1cm4gYS5SZW5kZXIuV3JhcE5vZGUuaXNFbXB0eSgpfHwocj1hLlJlbmRlci5XcmFwTm9kZS5jYWxsKGUuaWQscikpLHJ9KSl9LGUucHJvdG90eXBlLmhpZ2hsaWdodFNvdXJjZT1mdW5jdGlvbihlKXt2YXIgdD10aGlzLG49QXJyYXkuaXNBcnJheShlKT9lOltlXSxyPVtdO3JldHVybiBuLmZvckVhY2goKGZ1bmN0aW9uKGUpe2lmKGUgaW5zdGFuY2VvZiBsLmRlZmF1bHQpe3ZhciBuPWUuZGVTZXJpYWxpemUodC5vcHRpb25zLiRyb290LHQuaG9va3MpO3QuaGlnaGxpZ2h0UmFuZ2UobikubGVuZ3RoPjA/ci5wdXNoKGUpOmYuZXZlbnRFbWl0dGVyLmVtaXQoZi5JTlRFUk5BTF9FUlJPUl9FVkVOVCx7dHlwZTpkLkVSUk9SLkhJR0hMSUdIVF9TT1VSQ0VfTk9ORV9SRU5ERVIsZGV0YWlsOmV9KX1lbHNlIGYuZXZlbnRFbWl0dGVyLmVtaXQoZi5JTlRFUk5BTF9FUlJPUl9FVkVOVCx7dHlwZTpkLkVSUk9SLlNPVVJDRV9UWVBFX0VSUk9SfSl9KSkscn0sZS5wcm90b3R5cGUucmVtb3ZlSGlnaGxpZ2h0PWZ1bmN0aW9uKGUpe3ZhciB0LG4sbz1uZXcgUmVnRXhwKFwiKFwiK2UrXCJcXFxcXCIrZi5JRF9ESVZJU0lPTitcInxcXFxcXCIrZi5JRF9ESVZJU0lPTitcIj9cIitlK1wiJClcIiksYT10aGlzLmhvb2tzLGw9dGhpcy5vcHRpb25zLndyYXBUYWcsZD1kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGwrXCJbZGF0YS1cIitmLkRBVEFTRVRfSURFTlRJRklFUitcIl1cIiksYz1bXSxoPVtdLHA9W107dHJ5e2Zvcih2YXIgRT1yKGQpLF89RS5uZXh0KCk7IV8uZG9uZTtfPUUubmV4dCgpKXt2YXIgdj1fLnZhbHVlLFQ9di5kYXRhc2V0W2YuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSXSx5PXYuZGF0YXNldFtmLkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUl9FWFRSQV07VCE9PWV8fHk/VD09PWU/aC5wdXNoKHYpOlQhPT1lJiZvLnRlc3QoeSkmJnAucHVzaCh2KTpjLnB1c2godil9fWNhdGNoKGUpe3Q9e2Vycm9yOmV9fWZpbmFsbHl7dHJ5e18mJiFfLmRvbmUmJihuPUUucmV0dXJuKSYmbi5jYWxsKEUpfWZpbmFsbHl7aWYodCl0aHJvdyB0LmVycm9yfX1yZXR1cm4gYy5mb3JFYWNoKChmdW5jdGlvbih0KXt2YXIgbj10LnBhcmVudE5vZGUscj1kb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7cy5mb3JFYWNoKHQuY2hpbGROb2RlcywoZnVuY3Rpb24oZSl7cmV0dXJuIHIuYXBwZW5kQ2hpbGQoZS5jbG9uZU5vZGUoITEpKX0pKTt2YXIgbz10LnByZXZpb3VzU2libGluZyxpPXQubmV4dFNpYmxpbmc7bi5yZXBsYWNlQ2hpbGQocix0KSx1Lm5vcm1hbGl6ZVNpYmxpbmdUZXh0KG8sITApLHUubm9ybWFsaXplU2libGluZ1RleHQoaSwhMSksYS5SZW1vdmUuVXBkYXRlTm9kZXMuY2FsbChlLHQsXCJyZW1vdmVcIil9KSksaC5mb3JFYWNoKChmdW5jdGlvbih0KXt2YXIgbj10LmRhdGFzZXQscj1uW2YuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSX0VYVFJBXS5zcGxpdChmLklEX0RJVklTSU9OKSxvPXIuc2hpZnQoKSx1PWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobCtcIltkYXRhLVwiK2YuREFUQVNFVF9JREVOVElGSUVSKyc9XCInK28rJ1wiXScpO3UmJihzLnJlbW92ZUFsbENsYXNzKHQpLHMuYWRkQ2xhc3ModCxpKHUuY2xhc3NMaXN0KSkpLG5bZi5DQU1FTF9EQVRBU0VUX0lERU5USUZJRVJdPW8sbltmLkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUl9FWFRSQV09ci5qb2luKGYuSURfRElWSVNJT04pLGEuUmVtb3ZlLlVwZGF0ZU5vZGVzLmNhbGwoZSx0LFwiaWQtdXBkYXRlXCIpfSkpLHAuZm9yRWFjaCgoZnVuY3Rpb24odCl7dmFyIG49dC5kYXRhc2V0W2YuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSX0VYVFJBXTt0LmRhdGFzZXRbZi5DQU1FTF9EQVRBU0VUX0lERU5USUZJRVJfRVhUUkFdPW4ucmVwbGFjZShvLFwiXCIpLGEuUmVtb3ZlLlVwZGF0ZU5vZGVzLmNhbGwoZSx0LFwiZXh0cmEtdXBkYXRlXCIpfSkpLGMubGVuZ3RoK2gubGVuZ3RoK3AubGVuZ3RoIT09MH0sZS5wcm90b3R5cGUucmVtb3ZlQWxsSGlnaGxpZ2h0PWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcHRpb25zLHQ9ZS53cmFwVGFnLG49ZS4kcm9vdDtzLmdldEhpZ2hsaWdodHNCeVJvb3Qobix0KS5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgdD1lLnBhcmVudE5vZGUsbj1kb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7cy5mb3JFYWNoKGUuY2hpbGROb2RlcywoZnVuY3Rpb24oZSl7cmV0dXJuIG4uYXBwZW5kQ2hpbGQoZS5jbG9uZU5vZGUoITEpKX0pKSx0LnJlcGxhY2VDaGlsZChuLGUpfSkpfSxlfSgpO3QuZGVmYXVsdD1ofSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7dmFyIHI9dGhpcyYmdGhpcy5fX3JlYWR8fGZ1bmN0aW9uKGUsdCl7dmFyIG49XCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sJiZlW1N5bWJvbC5pdGVyYXRvcl07aWYoIW4pcmV0dXJuIGU7dmFyIHIsbyxpPW4uY2FsbChlKSxhPVtdO3RyeXtmb3IoOyh2b2lkIDA9PT10fHx0LS0gPjApJiYhKHI9aS5uZXh0KCkpLmRvbmU7KWEucHVzaChyLnZhbHVlKX1jYXRjaChlKXtvPXtlcnJvcjplfX1maW5hbGx5e3RyeXtyJiYhci5kb25lJiYobj1pLnJldHVybikmJm4uY2FsbChpKX1maW5hbGx5e2lmKG8pdGhyb3cgby5lcnJvcn19cmV0dXJuIGF9LG89dGhpcyYmdGhpcy5fX3NwcmVhZHx8ZnVuY3Rpb24oKXtmb3IodmFyIGU9W10sdD0wO3Q8YXJndW1lbnRzLmxlbmd0aDt0KyspZT1lLmNvbmNhdChyKGFyZ3VtZW50c1t0XSkpO3JldHVybiBlfTtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0Lm5vcm1hbGl6ZVNpYmxpbmdUZXh0PXQud3JhcEhpZ2hsaWdodD10LmdldFNlbGVjdGVkTm9kZXM9dm9pZCAwO3ZhciBpPW4oMSksYT1uKDQpLGw9bigwKSx1PW4oMTkpLHM9ZnVuY3Rpb24oZSx0KXtpZighZSlyZXR1cm4hMTtpZigvXlxcLi8udGVzdCh0KSl7dmFyIG49dC5yZXBsYWNlKC9eXFwuLyxcIlwiKTtyZXR1cm4gZSYmYS5oYXNDbGFzcyhlLG4pfWlmKC9eIy8udGVzdCh0KSl7dmFyIHI9dC5yZXBsYWNlKC9eIy8sXCJcIik7cmV0dXJuIGUmJmUuaWQ9PT1yfXZhciBvPXQudG9VcHBlckNhc2UoKTtyZXR1cm4gZSYmZS50YWdOYW1lPT09b307dC5nZXRTZWxlY3RlZE5vZGVzPWZ1bmN0aW9uKGUsdCxuLHIpe3ZhciBvPXQuJG5vZGUsYT1uLiRub2RlLGw9dC5vZmZzZXQsdT1uLm9mZnNldDtpZihvPT09YSYmbyBpbnN0YW5jZW9mIFRleHQpcmV0dXJuIGZ1bmN0aW9uKGUsdCxuLHIpe2Zvcih2YXIgbz1lLGE9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PXI/dm9pZCAwOnIuc29tZSgoZnVuY3Rpb24odCl7cmV0dXJuIHMoZSx0KX0pKX07bzspe2lmKDE9PT1vLm5vZGVUeXBlJiZhKG8pKXJldHVybltdO289by5wYXJlbnROb2RlfWUuc3BsaXRUZXh0KHQpO3ZhciBsPWUubmV4dFNpYmxpbmc7cmV0dXJuIGwuc3BsaXRUZXh0KG4tdCksW3skbm9kZTpsLHR5cGU6aS5TZWxlY3RlZE5vZGVUeXBlLnRleHQsc3BsaXRUeXBlOmkuU3BsaXRUeXBlLmJvdGh9XX0obyxsLHUscik7Zm9yKHZhciBkPVtlXSxjPVtdLGY9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PXI/dm9pZCAwOnIuc29tZSgoZnVuY3Rpb24odCl7cmV0dXJuIHMoZSx0KX0pKX0saD0hMSxwPW51bGw7cD1kLnBvcCgpOylpZigxIT09cC5ub2RlVHlwZXx8IWYocCkpe2Zvcih2YXIgRT1wLmNoaWxkTm9kZXMsXz1FLmxlbmd0aC0xO18+PTA7Xy0tKWQucHVzaChFW19dKTtpZihwPT09byl7aWYoMz09PXAubm9kZVR5cGUpe3Auc3BsaXRUZXh0KGwpO3ZhciB2PXAubmV4dFNpYmxpbmc7Yy5wdXNoKHskbm9kZTp2LHR5cGU6aS5TZWxlY3RlZE5vZGVUeXBlLnRleHQsc3BsaXRUeXBlOmkuU3BsaXRUeXBlLmhlYWR9KX1oPSEwfWVsc2V7aWYocD09PWEpe2lmKDM9PT1wLm5vZGVUeXBlKSh2PXApLnNwbGl0VGV4dCh1KSxjLnB1c2goeyRub2RlOnYsdHlwZTppLlNlbGVjdGVkTm9kZVR5cGUudGV4dCxzcGxpdFR5cGU6aS5TcGxpdFR5cGUudGFpbH0pO2JyZWFrfWgmJjM9PT1wLm5vZGVUeXBlJiZjLnB1c2goeyRub2RlOnAsdHlwZTppLlNlbGVjdGVkTm9kZVR5cGUudGV4dCxzcGxpdFR5cGU6aS5TcGxpdFR5cGUubm9uZX0pfX1yZXR1cm4gY307dmFyIGQ9ZnVuY3Rpb24oZSx0KXt2YXIgbj1BcnJheS5pc0FycmF5KHQpP3Q6W3RdO3JldHVybihuPTA9PT1uLmxlbmd0aD9bbC5nZXREZWZhdWx0T3B0aW9ucygpLnN0eWxlLmNsYXNzTmFtZV06bikuZm9yRWFjaCgoZnVuY3Rpb24odCl7YS5hZGRDbGFzcyhlLHQpfSkpLGV9LGM9ZnVuY3Rpb24oZSl7cmV0dXJuIWV8fCFlLnRleHRDb250ZW50fTt0LndyYXBIaWdobGlnaHQ9ZnVuY3Rpb24oZSx0LG4scil7dmFyIHM9ZS4kbm9kZS5wYXJlbnROb2RlLGY9ZS4kbm9kZS5wcmV2aW91c1NpYmxpbmcsaD1lLiRub2RlLm5leHRTaWJsaW5nO3JldHVybiBhLmlzSGlnaGxpZ2h0V3JhcE5vZGUocyk/IWEuaXNIaWdobGlnaHRXcmFwTm9kZShzKXx8YyhmKSYmYyhoKT9mdW5jdGlvbihlLHQsbil7dmFyIHI9ZS4kbm9kZS5wYXJlbnROb2RlLG89cjthLnJlbW92ZUFsbENsYXNzKG8pLGQobyxuKTt2YXIgaT1yLmRhdGFzZXQsdT1pW2wuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSXTtyZXR1cm4gaVtsLkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUl09dC5pZCxpW2wuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSX0VYVFJBXT1pW2wuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSX0VYVFJBXT91K2wuSURfRElWSVNJT04raVtsLkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUl9FWFRSQV06dSxvfShlLHQsbik6ZnVuY3Rpb24oZSx0LG4scil7dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChyKSxzPWUuJG5vZGUucGFyZW50Tm9kZSxjPWUuJG5vZGUucHJldmlvdXNTaWJsaW5nLGY9ZS4kbm9kZS5uZXh0U2libGluZyxoPWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxwPXMuZGF0YXNldFtsLkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUl0sRT1zLmRhdGFzZXRbbC5DQU1FTF9EQVRBU0VUX0lERU5USUZJRVJfRVhUUkFdLF89RT9wK2wuSURfRElWSVNJT04rRTpwO2Euc2V0QXR0cmlidXRlKFwiZGF0YS1cIitsLkRBVEFTRVRfSURFTlRJRklFUix0LmlkKSxhLnNldEF0dHJpYnV0ZShcImRhdGEtXCIrbC5EQVRBU0VUX0lERU5USUZJRVJfRVhUUkEsXyksYS5hcHBlbmRDaGlsZChlLiRub2RlLmNsb25lTm9kZSghMSkpO3ZhciB2LFQ9ITEseT0hMTtjJiYoKGc9cy5jbG9uZU5vZGUoITEpKS50ZXh0Q29udGVudD1jLnRleHRDb250ZW50LGguYXBwZW5kQ2hpbGQoZyksVD0hMCk7dmFyIGcsST1bXTsoQXJyYXkuaXNBcnJheShuKT9JLnB1c2guYXBwbHkoSSxvKG4pKTpJLnB1c2gobiksZChhLHUudW5pcXVlKEkpKSxoLmFwcGVuZENoaWxkKGEpLGYpJiYoKGc9cy5jbG9uZU5vZGUoITEpKS50ZXh0Q29udGVudD1mLnRleHRDb250ZW50LGguYXBwZW5kQ2hpbGQoZykseT0hMCk7cmV0dXJuIHY9VCYmeT9pLlNwbGl0VHlwZS5ib3RoOlQ/aS5TcGxpdFR5cGUuaGVhZDp5P2kuU3BsaXRUeXBlLnRhaWw6aS5TcGxpdFR5cGUubm9uZSxhLnNldEF0dHJpYnV0ZShcImRhdGEtXCIrbC5EQVRBU0VUX1NQTElUX1RZUEUsdikscy5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChoLHMpLGF9KGUsdCxuLHIpOmZ1bmN0aW9uKGUsdCxuLHIpe3ZhciBvPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQocik7cmV0dXJuIGQobyxuKSxvLmFwcGVuZENoaWxkKGUuJG5vZGUuY2xvbmVOb2RlKCExKSksZS4kbm9kZS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChvLGUuJG5vZGUpLG8uc2V0QXR0cmlidXRlKFwiZGF0YS1cIitsLkRBVEFTRVRfSURFTlRJRklFUix0LmlkKSxvLnNldEF0dHJpYnV0ZShcImRhdGEtXCIrbC5EQVRBU0VUX1NQTElUX1RZUEUsZS5zcGxpdFR5cGUpLG8uc2V0QXR0cmlidXRlKFwiZGF0YS1cIitsLkRBVEFTRVRfSURFTlRJRklFUl9FWFRSQSxcIlwiKSxvfShlLHQsbixyKX07dC5ub3JtYWxpemVTaWJsaW5nVGV4dD1mdW5jdGlvbihlLHQpe2lmKHZvaWQgMD09PXQmJih0PSEwKSxlJiYzPT09ZS5ub2RlVHlwZSl7dmFyIG49dD9lLm5leHRTaWJsaW5nOmUucHJldmlvdXNTaWJsaW5nO2lmKDM9PT1uLm5vZGVUeXBlKXt2YXIgcj1uLm5vZGVWYWx1ZTtlLm5vZGVWYWx1ZT10P2Uubm9kZVZhbHVlK3I6citlLm5vZGVWYWx1ZSxuLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobil9fX19LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjt2YXIgcj10aGlzJiZ0aGlzLl9fdmFsdWVzfHxmdW5jdGlvbihlKXt2YXIgdD1cImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJlN5bWJvbC5pdGVyYXRvcixuPXQmJmVbdF0scj0wO2lmKG4pcmV0dXJuIG4uY2FsbChlKTtpZihlJiZcIm51bWJlclwiPT10eXBlb2YgZS5sZW5ndGgpcmV0dXJue25leHQ6ZnVuY3Rpb24oKXtyZXR1cm4gZSYmcj49ZS5sZW5ndGgmJihlPXZvaWQgMCkse3ZhbHVlOmUmJmVbcisrXSxkb25lOiFlfX19O3Rocm93IG5ldyBUeXBlRXJyb3IodD9cIk9iamVjdCBpcyBub3QgaXRlcmFibGUuXCI6XCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpfTtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LnVuaXF1ZT12b2lkIDA7dC51bmlxdWU9ZnVuY3Rpb24oZSl7dmFyIHQsbixvPVtdO3RyeXtmb3IodmFyIGk9cihlKSxhPWkubmV4dCgpOyFhLmRvbmU7YT1pLm5leHQoKSl7dmFyIGw9YS52YWx1ZTstMT09PW8uaW5kZXhPZihsKSYmby5wdXNoKGwpfX1jYXRjaChlKXt0PXtlcnJvcjplfX1maW5hbGx5e3RyeXthJiYhYS5kb25lJiYobj1pLnJldHVybikmJm4uY2FsbChpKX1maW5hbGx5e2lmKHQpdGhyb3cgdC5lcnJvcn19cmV0dXJuIG99fSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksdC5pbml0RGVmYXVsdFN0eWxlc2hlZXQ9dm9pZCAwO3ZhciByPW4oMCk7dC5pbml0RGVmYXVsdFN0eWxlc2hlZXQ9ZnVuY3Rpb24oKXt2YXIgZT1yLlNUWUxFU0hFRVRfSUQsdD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChlKTtpZighdCl7dmFyIG49ZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoci5nZXRTdHlsZXNoZWV0KCkpOyh0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKSkuaWQ9ZSx0LmFwcGVuZENoaWxkKG4pLGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQodCl9cmV0dXJuIHR9fV0pLmRlZmF1bHR9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD13ZWItaGlnaGxpZ2h0ZXIubWluLmpzLm1hcCIsIi8qKlxuICogZGVmYXVsdCBzZXR0aW5nc1xuICpcbiAqIEBhdXRob3IgWm9uZ21pbiBMZWk8bGVpem9uZ21pbkBnbWFpbC5jb20+XG4gKi9cblxudmFyIEZpbHRlckNTUyA9IHJlcXVpcmUoXCJjc3NmaWx0ZXJcIikuRmlsdGVyQ1NTO1xudmFyIGdldERlZmF1bHRDU1NXaGl0ZUxpc3QgPSByZXF1aXJlKFwiY3NzZmlsdGVyXCIpLmdldERlZmF1bHRXaGl0ZUxpc3Q7XG52YXIgXyA9IHJlcXVpcmUoXCIuL3V0aWxcIik7XG5cbmZ1bmN0aW9uIGdldERlZmF1bHRXaGl0ZUxpc3QoKSB7XG4gIHJldHVybiB7XG4gICAgYTogW1widGFyZ2V0XCIsIFwiaHJlZlwiLCBcInRpdGxlXCJdLFxuICAgIGFiYnI6IFtcInRpdGxlXCJdLFxuICAgIGFkZHJlc3M6IFtdLFxuICAgIGFyZWE6IFtcInNoYXBlXCIsIFwiY29vcmRzXCIsIFwiaHJlZlwiLCBcImFsdFwiXSxcbiAgICBhcnRpY2xlOiBbXSxcbiAgICBhc2lkZTogW10sXG4gICAgYXVkaW86IFtcbiAgICAgIFwiYXV0b3BsYXlcIixcbiAgICAgIFwiY29udHJvbHNcIixcbiAgICAgIFwiY3Jvc3NvcmlnaW5cIixcbiAgICAgIFwibG9vcFwiLFxuICAgICAgXCJtdXRlZFwiLFxuICAgICAgXCJwcmVsb2FkXCIsXG4gICAgICBcInNyY1wiLFxuICAgIF0sXG4gICAgYjogW10sXG4gICAgYmRpOiBbXCJkaXJcIl0sXG4gICAgYmRvOiBbXCJkaXJcIl0sXG4gICAgYmlnOiBbXSxcbiAgICBibG9ja3F1b3RlOiBbXCJjaXRlXCJdLFxuICAgIGJyOiBbXSxcbiAgICBjYXB0aW9uOiBbXSxcbiAgICBjZW50ZXI6IFtdLFxuICAgIGNpdGU6IFtdLFxuICAgIGNvZGU6IFtdLFxuICAgIGNvbDogW1wiYWxpZ25cIiwgXCJ2YWxpZ25cIiwgXCJzcGFuXCIsIFwid2lkdGhcIl0sXG4gICAgY29sZ3JvdXA6IFtcImFsaWduXCIsIFwidmFsaWduXCIsIFwic3BhblwiLCBcIndpZHRoXCJdLFxuICAgIGRkOiBbXSxcbiAgICBkZWw6IFtcImRhdGV0aW1lXCJdLFxuICAgIGRldGFpbHM6IFtcIm9wZW5cIl0sXG4gICAgZGl2OiBbXSxcbiAgICBkbDogW10sXG4gICAgZHQ6IFtdLFxuICAgIGVtOiBbXSxcbiAgICBmaWdjYXB0aW9uOiBbXSxcbiAgICBmaWd1cmU6IFtdLFxuICAgIGZvbnQ6IFtcImNvbG9yXCIsIFwic2l6ZVwiLCBcImZhY2VcIl0sXG4gICAgZm9vdGVyOiBbXSxcbiAgICBoMTogW10sXG4gICAgaDI6IFtdLFxuICAgIGgzOiBbXSxcbiAgICBoNDogW10sXG4gICAgaDU6IFtdLFxuICAgIGg2OiBbXSxcbiAgICBoZWFkZXI6IFtdLFxuICAgIGhyOiBbXSxcbiAgICBpOiBbXSxcbiAgICBpbWc6IFtcInNyY1wiLCBcImFsdFwiLCBcInRpdGxlXCIsIFwid2lkdGhcIiwgXCJoZWlnaHRcIl0sXG4gICAgaW5zOiBbXCJkYXRldGltZVwiXSxcbiAgICBsaTogW10sXG4gICAgbWFyazogW10sXG4gICAgbmF2OiBbXSxcbiAgICBvbDogW10sXG4gICAgcDogW10sXG4gICAgcHJlOiBbXSxcbiAgICBzOiBbXSxcbiAgICBzZWN0aW9uOiBbXSxcbiAgICBzbWFsbDogW10sXG4gICAgc3BhbjogW10sXG4gICAgc3ViOiBbXSxcbiAgICBzdW1tYXJ5OiBbXSxcbiAgICBzdXA6IFtdLFxuICAgIHN0cm9uZzogW10sXG4gICAgc3RyaWtlOiBbXSxcbiAgICB0YWJsZTogW1wid2lkdGhcIiwgXCJib3JkZXJcIiwgXCJhbGlnblwiLCBcInZhbGlnblwiXSxcbiAgICB0Ym9keTogW1wiYWxpZ25cIiwgXCJ2YWxpZ25cIl0sXG4gICAgdGQ6IFtcIndpZHRoXCIsIFwicm93c3BhblwiLCBcImNvbHNwYW5cIiwgXCJhbGlnblwiLCBcInZhbGlnblwiXSxcbiAgICB0Zm9vdDogW1wiYWxpZ25cIiwgXCJ2YWxpZ25cIl0sXG4gICAgdGg6IFtcIndpZHRoXCIsIFwicm93c3BhblwiLCBcImNvbHNwYW5cIiwgXCJhbGlnblwiLCBcInZhbGlnblwiXSxcbiAgICB0aGVhZDogW1wiYWxpZ25cIiwgXCJ2YWxpZ25cIl0sXG4gICAgdHI6IFtcInJvd3NwYW5cIiwgXCJhbGlnblwiLCBcInZhbGlnblwiXSxcbiAgICB0dDogW10sXG4gICAgdTogW10sXG4gICAgdWw6IFtdLFxuICAgIHZpZGVvOiBbXG4gICAgICBcImF1dG9wbGF5XCIsXG4gICAgICBcImNvbnRyb2xzXCIsXG4gICAgICBcImNyb3Nzb3JpZ2luXCIsXG4gICAgICBcImxvb3BcIixcbiAgICAgIFwibXV0ZWRcIixcbiAgICAgIFwicGxheXNpbmxpbmVcIixcbiAgICAgIFwicG9zdGVyXCIsXG4gICAgICBcInByZWxvYWRcIixcbiAgICAgIFwic3JjXCIsXG4gICAgICBcImhlaWdodFwiLFxuICAgICAgXCJ3aWR0aFwiLFxuICAgIF0sXG4gIH07XG59XG5cbnZhciBkZWZhdWx0Q1NTRmlsdGVyID0gbmV3IEZpbHRlckNTUygpO1xuXG4vKipcbiAqIGRlZmF1bHQgb25UYWcgZnVuY3Rpb25cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gdGFnXG4gKiBAcGFyYW0ge1N0cmluZ30gaHRtbFxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcbiAqIEByZXR1cm4ge1N0cmluZ31cbiAqL1xuZnVuY3Rpb24gb25UYWcodGFnLCBodG1sLCBvcHRpb25zKSB7XG4gIC8vIGRvIG5vdGhpbmdcbn1cblxuLyoqXG4gKiBkZWZhdWx0IG9uSWdub3JlVGFnIGZ1bmN0aW9uXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IHRhZ1xuICogQHBhcmFtIHtTdHJpbmd9IGh0bWxcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIG9uSWdub3JlVGFnKHRhZywgaHRtbCwgb3B0aW9ucykge1xuICAvLyBkbyBub3RoaW5nXG59XG5cbi8qKlxuICogZGVmYXVsdCBvblRhZ0F0dHIgZnVuY3Rpb25cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gdGFnXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxuICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIG9uVGFnQXR0cih0YWcsIG5hbWUsIHZhbHVlKSB7XG4gIC8vIGRvIG5vdGhpbmdcbn1cblxuLyoqXG4gKiBkZWZhdWx0IG9uSWdub3JlVGFnQXR0ciBmdW5jdGlvblxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSB0YWdcbiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gKiBAcGFyYW0ge1N0cmluZ30gdmFsdWVcbiAqIEByZXR1cm4ge1N0cmluZ31cbiAqL1xuZnVuY3Rpb24gb25JZ25vcmVUYWdBdHRyKHRhZywgbmFtZSwgdmFsdWUpIHtcbiAgLy8gZG8gbm90aGluZ1xufVxuXG4vKipcbiAqIGRlZmF1bHQgZXNjYXBlSHRtbCBmdW5jdGlvblxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBodG1sXG4gKi9cbmZ1bmN0aW9uIGVzY2FwZUh0bWwoaHRtbCkge1xuICByZXR1cm4gaHRtbC5yZXBsYWNlKFJFR0VYUF9MVCwgXCImbHQ7XCIpLnJlcGxhY2UoUkVHRVhQX0dULCBcIiZndDtcIik7XG59XG5cbi8qKlxuICogZGVmYXVsdCBzYWZlQXR0clZhbHVlIGZ1bmN0aW9uXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IHRhZ1xuICogQHBhcmFtIHtTdHJpbmd9IG5hbWVcbiAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZVxuICogQHBhcmFtIHtPYmplY3R9IGNzc0ZpbHRlclxuICogQHJldHVybiB7U3RyaW5nfVxuICovXG5mdW5jdGlvbiBzYWZlQXR0clZhbHVlKHRhZywgbmFtZSwgdmFsdWUsIGNzc0ZpbHRlcikge1xuICAvLyB1bmVzY2FwZSBhdHRyaWJ1dGUgdmFsdWUgZmlyc3RseVxuICB2YWx1ZSA9IGZyaWVuZGx5QXR0clZhbHVlKHZhbHVlKTtcblxuICBpZiAobmFtZSA9PT0gXCJocmVmXCIgfHwgbmFtZSA9PT0gXCJzcmNcIikge1xuICAgIC8vIGZpbHRlciBgaHJlZmAgYW5kIGBzcmNgIGF0dHJpYnV0ZVxuICAgIC8vIG9ubHkgYWxsb3cgdGhlIHZhbHVlIHRoYXQgc3RhcnRzIHdpdGggYGh0dHA6Ly9gIHwgYGh0dHBzOi8vYCB8IGBtYWlsdG86YCB8IGAvYCB8IGAjYFxuICAgIHZhbHVlID0gXy50cmltKHZhbHVlKTtcbiAgICBpZiAodmFsdWUgPT09IFwiI1wiKSByZXR1cm4gXCIjXCI7XG4gICAgaWYgKFxuICAgICAgIShcbiAgICAgICAgdmFsdWUuc3Vic3RyKDAsIDcpID09PSBcImh0dHA6Ly9cIiB8fFxuICAgICAgICB2YWx1ZS5zdWJzdHIoMCwgOCkgPT09IFwiaHR0cHM6Ly9cIiB8fFxuICAgICAgICB2YWx1ZS5zdWJzdHIoMCwgNykgPT09IFwibWFpbHRvOlwiIHx8XG4gICAgICAgIHZhbHVlLnN1YnN0cigwLCA0KSA9PT0gXCJ0ZWw6XCIgfHxcbiAgICAgICAgdmFsdWUuc3Vic3RyKDAsIDExKSA9PT0gXCJkYXRhOmltYWdlL1wiIHx8XG4gICAgICAgIHZhbHVlLnN1YnN0cigwLCA2KSA9PT0gXCJmdHA6Ly9cIiB8fFxuICAgICAgICB2YWx1ZS5zdWJzdHIoMCwgMikgPT09IFwiLi9cIiB8fFxuICAgICAgICB2YWx1ZS5zdWJzdHIoMCwgMykgPT09IFwiLi4vXCIgfHxcbiAgICAgICAgdmFsdWVbMF0gPT09IFwiI1wiIHx8XG4gICAgICAgIHZhbHVlWzBdID09PSBcIi9cIlxuICAgICAgKVxuICAgICkge1xuICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfVxuICB9IGVsc2UgaWYgKG5hbWUgPT09IFwiYmFja2dyb3VuZFwiKSB7XG4gICAgLy8gZmlsdGVyIGBiYWNrZ3JvdW5kYCBhdHRyaWJ1dGUgKG1heWJlIG5vIHVzZSlcbiAgICAvLyBgamF2YXNjcmlwdDpgXG4gICAgUkVHRVhQX0RFRkFVTFRfT05fVEFHX0FUVFJfNC5sYXN0SW5kZXggPSAwO1xuICAgIGlmIChSRUdFWFBfREVGQVVMVF9PTl9UQUdfQVRUUl80LnRlc3QodmFsdWUpKSB7XG4gICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG4gIH0gZWxzZSBpZiAobmFtZSA9PT0gXCJzdHlsZVwiKSB7XG4gICAgLy8gYGV4cHJlc3Npb24oKWBcbiAgICBSRUdFWFBfREVGQVVMVF9PTl9UQUdfQVRUUl83Lmxhc3RJbmRleCA9IDA7XG4gICAgaWYgKFJFR0VYUF9ERUZBVUxUX09OX1RBR19BVFRSXzcudGVzdCh2YWx1ZSkpIHtcbiAgICAgIHJldHVybiBcIlwiO1xuICAgIH1cbiAgICAvLyBgdXJsKClgXG4gICAgUkVHRVhQX0RFRkFVTFRfT05fVEFHX0FUVFJfOC5sYXN0SW5kZXggPSAwO1xuICAgIGlmIChSRUdFWFBfREVGQVVMVF9PTl9UQUdfQVRUUl84LnRlc3QodmFsdWUpKSB7XG4gICAgICBSRUdFWFBfREVGQVVMVF9PTl9UQUdfQVRUUl80Lmxhc3RJbmRleCA9IDA7XG4gICAgICBpZiAoUkVHRVhQX0RFRkFVTFRfT05fVEFHX0FUVFJfNC50ZXN0KHZhbHVlKSkge1xuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGNzc0ZpbHRlciAhPT0gZmFsc2UpIHtcbiAgICAgIGNzc0ZpbHRlciA9IGNzc0ZpbHRlciB8fCBkZWZhdWx0Q1NTRmlsdGVyO1xuICAgICAgdmFsdWUgPSBjc3NGaWx0ZXIucHJvY2Vzcyh2YWx1ZSk7XG4gICAgfVxuICB9XG5cbiAgLy8gZXNjYXBlIGA8PlwiYCBiZWZvcmUgcmV0dXJuc1xuICB2YWx1ZSA9IGVzY2FwZUF0dHJWYWx1ZSh2YWx1ZSk7XG4gIHJldHVybiB2YWx1ZTtcbn1cblxuLy8gUmVnRXhwIGxpc3RcbnZhciBSRUdFWFBfTFQgPSAvPC9nO1xudmFyIFJFR0VYUF9HVCA9IC8+L2c7XG52YXIgUkVHRVhQX1FVT1RFID0gL1wiL2c7XG52YXIgUkVHRVhQX1FVT1RFXzIgPSAvJnF1b3Q7L2c7XG52YXIgUkVHRVhQX0FUVFJfVkFMVUVfMSA9IC8mIyhbYS16QS1aMC05XSopOz8vZ2ltO1xudmFyIFJFR0VYUF9BVFRSX1ZBTFVFX0NPTE9OID0gLyZjb2xvbjs/L2dpbTtcbnZhciBSRUdFWFBfQVRUUl9WQUxVRV9ORVdMSU5FID0gLyZuZXdsaW5lOz8vZ2ltO1xuLy8gdmFyIFJFR0VYUF9ERUZBVUxUX09OX1RBR19BVFRSXzMgPSAvXFwvXFwqfFxcKlxcLy9nbTtcbnZhciBSRUdFWFBfREVGQVVMVF9PTl9UQUdfQVRUUl80ID1cbiAgLygoalxccyphXFxzKnZcXHMqYXx2XFxzKmJ8bFxccyppXFxzKnZcXHMqZSlcXHMqc1xccypjXFxzKnJcXHMqaVxccypwXFxzKnRcXHMqfG1cXHMqb1xccypjXFxzKmhcXHMqYSk6L2dpO1xuLy8gdmFyIFJFR0VYUF9ERUZBVUxUX09OX1RBR19BVFRSXzUgPSAvXltcXHNcIidgXSooZFxccyphXFxzKnRcXHMqYVxccyopXFw6L2dpO1xuLy8gdmFyIFJFR0VYUF9ERUZBVUxUX09OX1RBR19BVFRSXzYgPSAvXltcXHNcIidgXSooZFxccyphXFxzKnRcXHMqYVxccyopXFw6XFxzKmltYWdlXFwvL2dpO1xudmFyIFJFR0VYUF9ERUZBVUxUX09OX1RBR19BVFRSXzcgPVxuICAvZVxccyp4XFxzKnBcXHMqclxccyplXFxzKnNcXHMqc1xccyppXFxzKm9cXHMqblxccypcXCguKi9naTtcbnZhciBSRUdFWFBfREVGQVVMVF9PTl9UQUdfQVRUUl84ID0gL3VcXHMqclxccypsXFxzKlxcKC4qL2dpO1xuXG4vKipcbiAqIGVzY2FwZSBkb3VibGUgcXVvdGVcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gc3RyXG4gKiBAcmV0dXJuIHtTdHJpbmd9IHN0clxuICovXG5mdW5jdGlvbiBlc2NhcGVRdW90ZShzdHIpIHtcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKFJFR0VYUF9RVU9URSwgXCImcXVvdDtcIik7XG59XG5cbi8qKlxuICogdW5lc2NhcGUgZG91YmxlIHF1b3RlXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IHN0clxuICogQHJldHVybiB7U3RyaW5nfSBzdHJcbiAqL1xuZnVuY3Rpb24gdW5lc2NhcGVRdW90ZShzdHIpIHtcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKFJFR0VYUF9RVU9URV8yLCAnXCInKTtcbn1cblxuLyoqXG4gKiBlc2NhcGUgaHRtbCBlbnRpdGllc1xuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBzdHJcbiAqIEByZXR1cm4ge1N0cmluZ31cbiAqL1xuZnVuY3Rpb24gZXNjYXBlSHRtbEVudGl0aWVzKHN0cikge1xuICByZXR1cm4gc3RyLnJlcGxhY2UoUkVHRVhQX0FUVFJfVkFMVUVfMSwgZnVuY3Rpb24gcmVwbGFjZVVuaWNvZGUoc3RyLCBjb2RlKSB7XG4gICAgcmV0dXJuIGNvZGVbMF0gPT09IFwieFwiIHx8IGNvZGVbMF0gPT09IFwiWFwiXG4gICAgICA/IFN0cmluZy5mcm9tQ2hhckNvZGUocGFyc2VJbnQoY29kZS5zdWJzdHIoMSksIDE2KSlcbiAgICAgIDogU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChjb2RlLCAxMCkpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBlc2NhcGUgaHRtbDUgbmV3IGRhbmdlciBlbnRpdGllc1xuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBzdHJcbiAqIEByZXR1cm4ge1N0cmluZ31cbiAqL1xuZnVuY3Rpb24gZXNjYXBlRGFuZ2VySHRtbDVFbnRpdGllcyhzdHIpIHtcbiAgcmV0dXJuIHN0clxuICAgIC5yZXBsYWNlKFJFR0VYUF9BVFRSX1ZBTFVFX0NPTE9OLCBcIjpcIilcbiAgICAucmVwbGFjZShSRUdFWFBfQVRUUl9WQUxVRV9ORVdMSU5FLCBcIiBcIik7XG59XG5cbi8qKlxuICogY2xlYXIgbm9ucHJpbnRhYmxlIGNoYXJhY3RlcnNcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gc3RyXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIGNsZWFyTm9uUHJpbnRhYmxlQ2hhcmFjdGVyKHN0cikge1xuICB2YXIgc3RyMiA9IFwiXCI7XG4gIGZvciAodmFyIGkgPSAwLCBsZW4gPSBzdHIubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICBzdHIyICs9IHN0ci5jaGFyQ29kZUF0KGkpIDwgMzIgPyBcIiBcIiA6IHN0ci5jaGFyQXQoaSk7XG4gIH1cbiAgcmV0dXJuIF8udHJpbShzdHIyKTtcbn1cblxuLyoqXG4gKiBnZXQgZnJpZW5kbHkgYXR0cmlidXRlIHZhbHVlXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IHN0clxuICogQHJldHVybiB7U3RyaW5nfVxuICovXG5mdW5jdGlvbiBmcmllbmRseUF0dHJWYWx1ZShzdHIpIHtcbiAgc3RyID0gdW5lc2NhcGVRdW90ZShzdHIpO1xuICBzdHIgPSBlc2NhcGVIdG1sRW50aXRpZXMoc3RyKTtcbiAgc3RyID0gZXNjYXBlRGFuZ2VySHRtbDVFbnRpdGllcyhzdHIpO1xuICBzdHIgPSBjbGVhck5vblByaW50YWJsZUNoYXJhY3RlcihzdHIpO1xuICByZXR1cm4gc3RyO1xufVxuXG4vKipcbiAqIHVuZXNjYXBlIGF0dHJpYnV0ZSB2YWx1ZVxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBzdHJcbiAqIEByZXR1cm4ge1N0cmluZ31cbiAqL1xuZnVuY3Rpb24gZXNjYXBlQXR0clZhbHVlKHN0cikge1xuICBzdHIgPSBlc2NhcGVRdW90ZShzdHIpO1xuICBzdHIgPSBlc2NhcGVIdG1sKHN0cik7XG4gIHJldHVybiBzdHI7XG59XG5cbi8qKlxuICogYG9uSWdub3JlVGFnYCBmdW5jdGlvbiBmb3IgcmVtb3ZpbmcgYWxsIHRoZSB0YWdzIHRoYXQgYXJlIG5vdCBpbiB3aGl0ZWxpc3RcbiAqL1xuZnVuY3Rpb24gb25JZ25vcmVUYWdTdHJpcEFsbCgpIHtcbiAgcmV0dXJuIFwiXCI7XG59XG5cbi8qKlxuICogcmVtb3ZlIHRhZyBib2R5XG4gKiBzcGVjaWZ5IGEgYHRhZ3NgIGxpc3QsIGlmIHRoZSB0YWcgaXMgbm90IGluIHRoZSBgdGFnc2AgbGlzdCB0aGVuIHByb2Nlc3MgYnkgdGhlIHNwZWNpZnkgZnVuY3Rpb24gKG9wdGlvbmFsKVxuICpcbiAqIEBwYXJhbSB7YXJyYXl9IHRhZ3NcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IG5leHRcbiAqL1xuZnVuY3Rpb24gU3RyaXBUYWdCb2R5KHRhZ3MsIG5leHQpIHtcbiAgaWYgKHR5cGVvZiBuZXh0ICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICBuZXh0ID0gZnVuY3Rpb24gKCkge307XG4gIH1cblxuICB2YXIgaXNSZW1vdmVBbGxUYWcgPSAhQXJyYXkuaXNBcnJheSh0YWdzKTtcbiAgZnVuY3Rpb24gaXNSZW1vdmVUYWcodGFnKSB7XG4gICAgaWYgKGlzUmVtb3ZlQWxsVGFnKSByZXR1cm4gdHJ1ZTtcbiAgICByZXR1cm4gXy5pbmRleE9mKHRhZ3MsIHRhZykgIT09IC0xO1xuICB9XG5cbiAgdmFyIHJlbW92ZUxpc3QgPSBbXTtcbiAgdmFyIHBvc1N0YXJ0ID0gZmFsc2U7XG5cbiAgcmV0dXJuIHtcbiAgICBvbklnbm9yZVRhZzogZnVuY3Rpb24gKHRhZywgaHRtbCwgb3B0aW9ucykge1xuICAgICAgaWYgKGlzUmVtb3ZlVGFnKHRhZykpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuaXNDbG9zaW5nKSB7XG4gICAgICAgICAgdmFyIHJldCA9IFwiWy9yZW1vdmVkXVwiO1xuICAgICAgICAgIHZhciBlbmQgPSBvcHRpb25zLnBvc2l0aW9uICsgcmV0Lmxlbmd0aDtcbiAgICAgICAgICByZW1vdmVMaXN0LnB1c2goW1xuICAgICAgICAgICAgcG9zU3RhcnQgIT09IGZhbHNlID8gcG9zU3RhcnQgOiBvcHRpb25zLnBvc2l0aW9uLFxuICAgICAgICAgICAgZW5kLFxuICAgICAgICAgIF0pO1xuICAgICAgICAgIHBvc1N0YXJ0ID0gZmFsc2U7XG4gICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoIXBvc1N0YXJ0KSB7XG4gICAgICAgICAgICBwb3NTdGFydCA9IG9wdGlvbnMucG9zaXRpb247XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBcIltyZW1vdmVkXVwiO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gbmV4dCh0YWcsIGh0bWwsIG9wdGlvbnMpO1xuICAgICAgfVxuICAgIH0sXG4gICAgcmVtb3ZlOiBmdW5jdGlvbiAoaHRtbCkge1xuICAgICAgdmFyIHJldGh0bWwgPSBcIlwiO1xuICAgICAgdmFyIGxhc3RQb3MgPSAwO1xuICAgICAgXy5mb3JFYWNoKHJlbW92ZUxpc3QsIGZ1bmN0aW9uIChwb3MpIHtcbiAgICAgICAgcmV0aHRtbCArPSBodG1sLnNsaWNlKGxhc3RQb3MsIHBvc1swXSk7XG4gICAgICAgIGxhc3RQb3MgPSBwb3NbMV07XG4gICAgICB9KTtcbiAgICAgIHJldGh0bWwgKz0gaHRtbC5zbGljZShsYXN0UG9zKTtcbiAgICAgIHJldHVybiByZXRodG1sO1xuICAgIH0sXG4gIH07XG59XG5cbi8qKlxuICogcmVtb3ZlIGh0bWwgY29tbWVudHNcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gaHRtbFxuICogQHJldHVybiB7U3RyaW5nfVxuICovXG5mdW5jdGlvbiBzdHJpcENvbW1lbnRUYWcoaHRtbCkge1xuICB2YXIgcmV0SHRtbCA9IFwiXCI7XG4gIHZhciBsYXN0UG9zID0gMDtcbiAgd2hpbGUgKGxhc3RQb3MgPCBodG1sLmxlbmd0aCkge1xuICAgIHZhciBpID0gaHRtbC5pbmRleE9mKFwiPCEtLVwiLCBsYXN0UG9zKTtcbiAgICBpZiAoaSA9PT0gLTEpIHtcbiAgICAgIHJldEh0bWwgKz0gaHRtbC5zbGljZShsYXN0UG9zKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICByZXRIdG1sICs9IGh0bWwuc2xpY2UobGFzdFBvcywgaSk7XG4gICAgdmFyIGogPSBodG1sLmluZGV4T2YoXCItLT5cIiwgaSk7XG4gICAgaWYgKGogPT09IC0xKSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgbGFzdFBvcyA9IGogKyAzO1xuICB9XG4gIHJldHVybiByZXRIdG1sO1xufVxuXG4vKipcbiAqIHJlbW92ZSBpbnZpc2libGUgY2hhcmFjdGVyc1xuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBodG1sXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHN0cmlwQmxhbmtDaGFyKGh0bWwpIHtcbiAgdmFyIGNoYXJzID0gaHRtbC5zcGxpdChcIlwiKTtcbiAgY2hhcnMgPSBjaGFycy5maWx0ZXIoZnVuY3Rpb24gKGNoYXIpIHtcbiAgICB2YXIgYyA9IGNoYXIuY2hhckNvZGVBdCgwKTtcbiAgICBpZiAoYyA9PT0gMTI3KSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKGMgPD0gMzEpIHtcbiAgICAgIGlmIChjID09PSAxMCB8fCBjID09PSAxMykgcmV0dXJuIHRydWU7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9KTtcbiAgcmV0dXJuIGNoYXJzLmpvaW4oXCJcIik7XG59XG5cbmV4cG9ydHMud2hpdGVMaXN0ID0gZ2V0RGVmYXVsdFdoaXRlTGlzdCgpO1xuZXhwb3J0cy5nZXREZWZhdWx0V2hpdGVMaXN0ID0gZ2V0RGVmYXVsdFdoaXRlTGlzdDtcbmV4cG9ydHMub25UYWcgPSBvblRhZztcbmV4cG9ydHMub25JZ25vcmVUYWcgPSBvbklnbm9yZVRhZztcbmV4cG9ydHMub25UYWdBdHRyID0gb25UYWdBdHRyO1xuZXhwb3J0cy5vbklnbm9yZVRhZ0F0dHIgPSBvbklnbm9yZVRhZ0F0dHI7XG5leHBvcnRzLnNhZmVBdHRyVmFsdWUgPSBzYWZlQXR0clZhbHVlO1xuZXhwb3J0cy5lc2NhcGVIdG1sID0gZXNjYXBlSHRtbDtcbmV4cG9ydHMuZXNjYXBlUXVvdGUgPSBlc2NhcGVRdW90ZTtcbmV4cG9ydHMudW5lc2NhcGVRdW90ZSA9IHVuZXNjYXBlUXVvdGU7XG5leHBvcnRzLmVzY2FwZUh0bWxFbnRpdGllcyA9IGVzY2FwZUh0bWxFbnRpdGllcztcbmV4cG9ydHMuZXNjYXBlRGFuZ2VySHRtbDVFbnRpdGllcyA9IGVzY2FwZURhbmdlckh0bWw1RW50aXRpZXM7XG5leHBvcnRzLmNsZWFyTm9uUHJpbnRhYmxlQ2hhcmFjdGVyID0gY2xlYXJOb25QcmludGFibGVDaGFyYWN0ZXI7XG5leHBvcnRzLmZyaWVuZGx5QXR0clZhbHVlID0gZnJpZW5kbHlBdHRyVmFsdWU7XG5leHBvcnRzLmVzY2FwZUF0dHJWYWx1ZSA9IGVzY2FwZUF0dHJWYWx1ZTtcbmV4cG9ydHMub25JZ25vcmVUYWdTdHJpcEFsbCA9IG9uSWdub3JlVGFnU3RyaXBBbGw7XG5leHBvcnRzLlN0cmlwVGFnQm9keSA9IFN0cmlwVGFnQm9keTtcbmV4cG9ydHMuc3RyaXBDb21tZW50VGFnID0gc3RyaXBDb21tZW50VGFnO1xuZXhwb3J0cy5zdHJpcEJsYW5rQ2hhciA9IHN0cmlwQmxhbmtDaGFyO1xuZXhwb3J0cy5jc3NGaWx0ZXIgPSBkZWZhdWx0Q1NTRmlsdGVyO1xuZXhwb3J0cy5nZXREZWZhdWx0Q1NTV2hpdGVMaXN0ID0gZ2V0RGVmYXVsdENTU1doaXRlTGlzdDtcbiIsIi8qKlxuICogeHNzXG4gKlxuICogQGF1dGhvciBab25nbWluIExlaTxsZWl6b25nbWluQGdtYWlsLmNvbT5cbiAqL1xuXG52YXIgREVGQVVMVCA9IHJlcXVpcmUoXCIuL2RlZmF1bHRcIik7XG52YXIgcGFyc2VyID0gcmVxdWlyZShcIi4vcGFyc2VyXCIpO1xudmFyIEZpbHRlclhTUyA9IHJlcXVpcmUoXCIuL3hzc1wiKTtcblxuLyoqXG4gKiBmaWx0ZXIgeHNzIGZ1bmN0aW9uXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IGh0bWxcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIHsgd2hpdGVMaXN0LCBvblRhZywgb25UYWdBdHRyLCBvbklnbm9yZVRhZywgb25JZ25vcmVUYWdBdHRyLCBzYWZlQXR0clZhbHVlLCBlc2NhcGVIdG1sIH1cbiAqIEByZXR1cm4ge1N0cmluZ31cbiAqL1xuZnVuY3Rpb24gZmlsdGVyWFNTKGh0bWwsIG9wdGlvbnMpIHtcbiAgdmFyIHhzcyA9IG5ldyBGaWx0ZXJYU1Mob3B0aW9ucyk7XG4gIHJldHVybiB4c3MucHJvY2VzcyhodG1sKTtcbn1cblxuZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZmlsdGVyWFNTO1xuZXhwb3J0cy5maWx0ZXJYU1MgPSBmaWx0ZXJYU1M7XG5leHBvcnRzLkZpbHRlclhTUyA9IEZpbHRlclhTUztcblxuKGZ1bmN0aW9uICgpIHtcbiAgZm9yICh2YXIgaSBpbiBERUZBVUxUKSB7XG4gICAgZXhwb3J0c1tpXSA9IERFRkFVTFRbaV07XG4gIH1cbiAgZm9yICh2YXIgaiBpbiBwYXJzZXIpIHtcbiAgICBleHBvcnRzW2pdID0gcGFyc2VyW2pdO1xuICB9XG59KSgpO1xuXG4vLyB1c2luZyBgeHNzYCBvbiB0aGUgYnJvd3Nlciwgb3V0cHV0IGBmaWx0ZXJYU1NgIHRvIHRoZSBnbG9iYWxzXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICB3aW5kb3cuZmlsdGVyWFNTID0gbW9kdWxlLmV4cG9ydHM7XG59XG5cbi8vIHVzaW5nIGB4c3NgIG9uIHRoZSBXZWJXb3JrZXIsIG91dHB1dCBgZmlsdGVyWFNTYCB0byB0aGUgZ2xvYmFsc1xuZnVuY3Rpb24gaXNXb3JrZXJFbnYoKSB7XG4gIHJldHVybiAoXG4gICAgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgJiZcbiAgICB0eXBlb2YgRGVkaWNhdGVkV29ya2VyR2xvYmFsU2NvcGUgIT09IFwidW5kZWZpbmVkXCIgJiZcbiAgICBzZWxmIGluc3RhbmNlb2YgRGVkaWNhdGVkV29ya2VyR2xvYmFsU2NvcGVcbiAgKTtcbn1cbmlmIChpc1dvcmtlckVudigpKSB7XG4gIHNlbGYuZmlsdGVyWFNTID0gbW9kdWxlLmV4cG9ydHM7XG59XG4iLCIvKipcbiAqIFNpbXBsZSBIVE1MIFBhcnNlclxuICpcbiAqIEBhdXRob3IgWm9uZ21pbiBMZWk8bGVpem9uZ21pbkBnbWFpbC5jb20+XG4gKi9cblxudmFyIF8gPSByZXF1aXJlKFwiLi91dGlsXCIpO1xuXG4vKipcbiAqIGdldCB0YWcgbmFtZVxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBodG1sIGUuZy4gJzxhIGhlZj1cIiNcIj4nXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIGdldFRhZ05hbWUoaHRtbCkge1xuICB2YXIgaSA9IF8uc3BhY2VJbmRleChodG1sKTtcbiAgdmFyIHRhZ05hbWU7XG4gIGlmIChpID09PSAtMSkge1xuICAgIHRhZ05hbWUgPSBodG1sLnNsaWNlKDEsIC0xKTtcbiAgfSBlbHNlIHtcbiAgICB0YWdOYW1lID0gaHRtbC5zbGljZSgxLCBpICsgMSk7XG4gIH1cbiAgdGFnTmFtZSA9IF8udHJpbSh0YWdOYW1lKS50b0xvd2VyQ2FzZSgpO1xuICBpZiAodGFnTmFtZS5zbGljZSgwLCAxKSA9PT0gXCIvXCIpIHRhZ05hbWUgPSB0YWdOYW1lLnNsaWNlKDEpO1xuICBpZiAodGFnTmFtZS5zbGljZSgtMSkgPT09IFwiL1wiKSB0YWdOYW1lID0gdGFnTmFtZS5zbGljZSgwLCAtMSk7XG4gIHJldHVybiB0YWdOYW1lO1xufVxuXG4vKipcbiAqIGlzIGNsb3NlIHRhZz9cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gaHRtbCDlpoLvvJonPGEgaGVmPVwiI1wiPidcbiAqIEByZXR1cm4ge0Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzQ2xvc2luZyhodG1sKSB7XG4gIHJldHVybiBodG1sLnNsaWNlKDAsIDIpID09PSBcIjwvXCI7XG59XG5cbi8qKlxuICogcGFyc2UgaW5wdXQgaHRtbCBhbmQgcmV0dXJucyBwcm9jZXNzZWQgaHRtbFxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBodG1sXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBvblRhZyBlLmcuIGZ1bmN0aW9uIChzb3VyY2VQb3NpdGlvbiwgcG9zaXRpb24sIHRhZywgaHRtbCwgaXNDbG9zaW5nKVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZXNjYXBlSHRtbFxuICogQHJldHVybiB7U3RyaW5nfVxuICovXG5mdW5jdGlvbiBwYXJzZVRhZyhodG1sLCBvblRhZywgZXNjYXBlSHRtbCkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgcmV0aHRtbCA9IFwiXCI7XG4gIHZhciBsYXN0UG9zID0gMDtcbiAgdmFyIHRhZ1N0YXJ0ID0gZmFsc2U7XG4gIHZhciBxdW90ZVN0YXJ0ID0gZmFsc2U7XG4gIHZhciBjdXJyZW50UG9zID0gMDtcbiAgdmFyIGxlbiA9IGh0bWwubGVuZ3RoO1xuICB2YXIgY3VycmVudFRhZ05hbWUgPSBcIlwiO1xuICB2YXIgY3VycmVudEh0bWwgPSBcIlwiO1xuXG4gIGNoYXJpdGVyYXRvcjogZm9yIChjdXJyZW50UG9zID0gMDsgY3VycmVudFBvcyA8IGxlbjsgY3VycmVudFBvcysrKSB7XG4gICAgdmFyIGMgPSBodG1sLmNoYXJBdChjdXJyZW50UG9zKTtcbiAgICBpZiAodGFnU3RhcnQgPT09IGZhbHNlKSB7XG4gICAgICBpZiAoYyA9PT0gXCI8XCIpIHtcbiAgICAgICAgdGFnU3RhcnQgPSBjdXJyZW50UG9zO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHF1b3RlU3RhcnQgPT09IGZhbHNlKSB7XG4gICAgICAgIGlmIChjID09PSBcIjxcIikge1xuICAgICAgICAgIHJldGh0bWwgKz0gZXNjYXBlSHRtbChodG1sLnNsaWNlKGxhc3RQb3MsIGN1cnJlbnRQb3MpKTtcbiAgICAgICAgICB0YWdTdGFydCA9IGN1cnJlbnRQb3M7XG4gICAgICAgICAgbGFzdFBvcyA9IGN1cnJlbnRQb3M7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGMgPT09IFwiPlwiIHx8IGN1cnJlbnRQb3MgPT09IGxlbiAtIDEpIHtcbiAgICAgICAgICByZXRodG1sICs9IGVzY2FwZUh0bWwoaHRtbC5zbGljZShsYXN0UG9zLCB0YWdTdGFydCkpO1xuICAgICAgICAgIGN1cnJlbnRIdG1sID0gaHRtbC5zbGljZSh0YWdTdGFydCwgY3VycmVudFBvcyArIDEpO1xuICAgICAgICAgIGN1cnJlbnRUYWdOYW1lID0gZ2V0VGFnTmFtZShjdXJyZW50SHRtbCk7XG4gICAgICAgICAgcmV0aHRtbCArPSBvblRhZyhcbiAgICAgICAgICAgIHRhZ1N0YXJ0LFxuICAgICAgICAgICAgcmV0aHRtbC5sZW5ndGgsXG4gICAgICAgICAgICBjdXJyZW50VGFnTmFtZSxcbiAgICAgICAgICAgIGN1cnJlbnRIdG1sLFxuICAgICAgICAgICAgaXNDbG9zaW5nKGN1cnJlbnRIdG1sKVxuICAgICAgICAgICk7XG4gICAgICAgICAgbGFzdFBvcyA9IGN1cnJlbnRQb3MgKyAxO1xuICAgICAgICAgIHRhZ1N0YXJ0ID0gZmFsc2U7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGMgPT09ICdcIicgfHwgYyA9PT0gXCInXCIpIHtcbiAgICAgICAgICB2YXIgaSA9IDE7XG4gICAgICAgICAgdmFyIGljID0gaHRtbC5jaGFyQXQoY3VycmVudFBvcyAtIGkpO1xuXG4gICAgICAgICAgd2hpbGUgKGljLnRyaW0oKSA9PT0gXCJcIiB8fCBpYyA9PT0gXCI9XCIpIHtcbiAgICAgICAgICAgIGlmIChpYyA9PT0gXCI9XCIpIHtcbiAgICAgICAgICAgICAgcXVvdGVTdGFydCA9IGM7XG4gICAgICAgICAgICAgIGNvbnRpbnVlIGNoYXJpdGVyYXRvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGljID0gaHRtbC5jaGFyQXQoY3VycmVudFBvcyAtICsraSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoYyA9PT0gcXVvdGVTdGFydCkge1xuICAgICAgICAgIHF1b3RlU3RhcnQgPSBmYWxzZTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBpZiAobGFzdFBvcyA8IGxlbikge1xuICAgIHJldGh0bWwgKz0gZXNjYXBlSHRtbChodG1sLnN1YnN0cihsYXN0UG9zKSk7XG4gIH1cblxuICByZXR1cm4gcmV0aHRtbDtcbn1cblxudmFyIFJFR0VYUF9JTExFR0FMX0FUVFJfTkFNRSA9IC9bXmEtekEtWjAtOVxcXFxfOi4tXS9naW07XG5cbi8qKlxuICogcGFyc2UgaW5wdXQgYXR0cmlidXRlcyBhbmQgcmV0dXJucyBwcm9jZXNzZWQgYXR0cmlidXRlc1xuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBodG1sIGUuZy4gYGhyZWY9XCIjXCIgdGFyZ2V0PVwiX2JsYW5rXCJgXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkF0dHIgZS5nLiBgZnVuY3Rpb24gKG5hbWUsIHZhbHVlKWBcbiAqIEByZXR1cm4ge1N0cmluZ31cbiAqL1xuZnVuY3Rpb24gcGFyc2VBdHRyKGh0bWwsIG9uQXR0cikge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgbGFzdFBvcyA9IDA7XG4gIHZhciBsYXN0TWFya1BvcyA9IDA7XG4gIHZhciByZXRBdHRycyA9IFtdO1xuICB2YXIgdG1wTmFtZSA9IGZhbHNlO1xuICB2YXIgbGVuID0gaHRtbC5sZW5ndGg7XG5cbiAgZnVuY3Rpb24gYWRkQXR0cihuYW1lLCB2YWx1ZSkge1xuICAgIG5hbWUgPSBfLnRyaW0obmFtZSk7XG4gICAgbmFtZSA9IG5hbWUucmVwbGFjZShSRUdFWFBfSUxMRUdBTF9BVFRSX05BTUUsIFwiXCIpLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKG5hbWUubGVuZ3RoIDwgMSkgcmV0dXJuO1xuICAgIHZhciByZXQgPSBvbkF0dHIobmFtZSwgdmFsdWUgfHwgXCJcIik7XG4gICAgaWYgKHJldCkgcmV0QXR0cnMucHVzaChyZXQpO1xuICB9XG5cbiAgLy8g6YCQ5Liq5YiG5p6Q5a2X56ymXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICB2YXIgYyA9IGh0bWwuY2hhckF0KGkpO1xuICAgIHZhciB2LCBqO1xuICAgIGlmICh0bXBOYW1lID09PSBmYWxzZSAmJiBjID09PSBcIj1cIikge1xuICAgICAgdG1wTmFtZSA9IGh0bWwuc2xpY2UobGFzdFBvcywgaSk7XG4gICAgICBsYXN0UG9zID0gaSArIDE7XG4gICAgICBsYXN0TWFya1BvcyA9IGh0bWwuY2hhckF0KGxhc3RQb3MpID09PSAnXCInIHx8IGh0bWwuY2hhckF0KGxhc3RQb3MpID09PSBcIidcIiA/IGxhc3RQb3MgOiBmaW5kTmV4dFF1b3RhdGlvbk1hcmsoaHRtbCwgaSArIDEpO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmICh0bXBOYW1lICE9PSBmYWxzZSkge1xuICAgICAgaWYgKFxuICAgICAgICBpID09PSBsYXN0TWFya1Bvc1xuICAgICAgKSB7XG4gICAgICAgIGogPSBodG1sLmluZGV4T2YoYywgaSArIDEpO1xuICAgICAgICBpZiAoaiA9PT0gLTEpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2ID0gXy50cmltKGh0bWwuc2xpY2UobGFzdE1hcmtQb3MgKyAxLCBqKSk7XG4gICAgICAgICAgYWRkQXR0cih0bXBOYW1lLCB2KTtcbiAgICAgICAgICB0bXBOYW1lID0gZmFsc2U7XG4gICAgICAgICAgaSA9IGo7XG4gICAgICAgICAgbGFzdFBvcyA9IGkgKyAxO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmICgvXFxzfFxcbnxcXHQvLnRlc3QoYykpIHtcbiAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoL1xcc3xcXG58XFx0L2csIFwiIFwiKTtcbiAgICAgIGlmICh0bXBOYW1lID09PSBmYWxzZSkge1xuICAgICAgICBqID0gZmluZE5leHRFcXVhbChodG1sLCBpKTtcbiAgICAgICAgaWYgKGogPT09IC0xKSB7XG4gICAgICAgICAgdiA9IF8udHJpbShodG1sLnNsaWNlKGxhc3RQb3MsIGkpKTtcbiAgICAgICAgICBhZGRBdHRyKHYpO1xuICAgICAgICAgIHRtcE5hbWUgPSBmYWxzZTtcbiAgICAgICAgICBsYXN0UG9zID0gaSArIDE7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaSA9IGogLSAxO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBqID0gZmluZEJlZm9yZUVxdWFsKGh0bWwsIGkgLSAxKTtcbiAgICAgICAgaWYgKGogPT09IC0xKSB7XG4gICAgICAgICAgdiA9IF8udHJpbShodG1sLnNsaWNlKGxhc3RQb3MsIGkpKTtcbiAgICAgICAgICB2ID0gc3RyaXBRdW90ZVdyYXAodik7XG4gICAgICAgICAgYWRkQXR0cih0bXBOYW1lLCB2KTtcbiAgICAgICAgICB0bXBOYW1lID0gZmFsc2U7XG4gICAgICAgICAgbGFzdFBvcyA9IGkgKyAxO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYgKGxhc3RQb3MgPCBodG1sLmxlbmd0aCkge1xuICAgIGlmICh0bXBOYW1lID09PSBmYWxzZSkge1xuICAgICAgYWRkQXR0cihodG1sLnNsaWNlKGxhc3RQb3MpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYWRkQXR0cih0bXBOYW1lLCBzdHJpcFF1b3RlV3JhcChfLnRyaW0oaHRtbC5zbGljZShsYXN0UG9zKSkpKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gXy50cmltKHJldEF0dHJzLmpvaW4oXCIgXCIpKTtcbn1cblxuZnVuY3Rpb24gZmluZE5leHRFcXVhbChzdHIsIGkpIHtcbiAgZm9yICg7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgYyA9IHN0cltpXTtcbiAgICBpZiAoYyA9PT0gXCIgXCIpIGNvbnRpbnVlO1xuICAgIGlmIChjID09PSBcIj1cIikgcmV0dXJuIGk7XG4gICAgcmV0dXJuIC0xO1xuICB9XG59XG5cbmZ1bmN0aW9uIGZpbmROZXh0UXVvdGF0aW9uTWFyayhzdHIsIGkpIHtcbiAgZm9yICg7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgYyA9IHN0cltpXTtcbiAgICBpZiAoYyA9PT0gXCIgXCIpIGNvbnRpbnVlO1xuICAgIGlmIChjID09PSBcIidcIiB8fCBjID09PSAnXCInKSByZXR1cm4gaTtcbiAgICByZXR1cm4gLTE7XG4gIH1cbn1cblxuZnVuY3Rpb24gZmluZEJlZm9yZUVxdWFsKHN0ciwgaSkge1xuICBmb3IgKDsgaSA+IDA7IGktLSkge1xuICAgIHZhciBjID0gc3RyW2ldO1xuICAgIGlmIChjID09PSBcIiBcIikgY29udGludWU7XG4gICAgaWYgKGMgPT09IFwiPVwiKSByZXR1cm4gaTtcbiAgICByZXR1cm4gLTE7XG4gIH1cbn1cblxuZnVuY3Rpb24gaXNRdW90ZVdyYXBTdHJpbmcodGV4dCkge1xuICBpZiAoXG4gICAgKHRleHRbMF0gPT09ICdcIicgJiYgdGV4dFt0ZXh0Lmxlbmd0aCAtIDFdID09PSAnXCInKSB8fFxuICAgICh0ZXh0WzBdID09PSBcIidcIiAmJiB0ZXh0W3RleHQubGVuZ3RoIC0gMV0gPT09IFwiJ1wiKVxuICApIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuZnVuY3Rpb24gc3RyaXBRdW90ZVdyYXAodGV4dCkge1xuICBpZiAoaXNRdW90ZVdyYXBTdHJpbmcodGV4dCkpIHtcbiAgICByZXR1cm4gdGV4dC5zdWJzdHIoMSwgdGV4dC5sZW5ndGggLSAyKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdGV4dDtcbiAgfVxufVxuXG5leHBvcnRzLnBhcnNlVGFnID0gcGFyc2VUYWc7XG5leHBvcnRzLnBhcnNlQXR0ciA9IHBhcnNlQXR0cjtcbiIsIm1vZHVsZS5leHBvcnRzID0ge1xuICBpbmRleE9mOiBmdW5jdGlvbiAoYXJyLCBpdGVtKSB7XG4gICAgdmFyIGksIGo7XG4gICAgaWYgKEFycmF5LnByb3RvdHlwZS5pbmRleE9mKSB7XG4gICAgICByZXR1cm4gYXJyLmluZGV4T2YoaXRlbSk7XG4gICAgfVxuICAgIGZvciAoaSA9IDAsIGogPSBhcnIubGVuZ3RoOyBpIDwgajsgaSsrKSB7XG4gICAgICBpZiAoYXJyW2ldID09PSBpdGVtKSB7XG4gICAgICAgIHJldHVybiBpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gLTE7XG4gIH0sXG4gIGZvckVhY2g6IGZ1bmN0aW9uIChhcnIsIGZuLCBzY29wZSkge1xuICAgIHZhciBpLCBqO1xuICAgIGlmIChBcnJheS5wcm90b3R5cGUuZm9yRWFjaCkge1xuICAgICAgcmV0dXJuIGFyci5mb3JFYWNoKGZuLCBzY29wZSk7XG4gICAgfVxuICAgIGZvciAoaSA9IDAsIGogPSBhcnIubGVuZ3RoOyBpIDwgajsgaSsrKSB7XG4gICAgICBmbi5jYWxsKHNjb3BlLCBhcnJbaV0sIGksIGFycik7XG4gICAgfVxuICB9LFxuICB0cmltOiBmdW5jdGlvbiAoc3RyKSB7XG4gICAgaWYgKFN0cmluZy5wcm90b3R5cGUudHJpbSkge1xuICAgICAgcmV0dXJuIHN0ci50cmltKCk7XG4gICAgfVxuICAgIHJldHVybiBzdHIucmVwbGFjZSgvKF5cXHMqKXwoXFxzKiQpL2csIFwiXCIpO1xuICB9LFxuICBzcGFjZUluZGV4OiBmdW5jdGlvbiAoc3RyKSB7XG4gICAgdmFyIHJlZyA9IC9cXHN8XFxufFxcdC87XG4gICAgdmFyIG1hdGNoID0gcmVnLmV4ZWMoc3RyKTtcbiAgICByZXR1cm4gbWF0Y2ggPyBtYXRjaC5pbmRleCA6IC0xO1xuICB9LFxufTtcbiIsIi8qKlxuICogZmlsdGVyIHhzc1xuICpcbiAqIEBhdXRob3IgWm9uZ21pbiBMZWk8bGVpem9uZ21pbkBnbWFpbC5jb20+XG4gKi9cblxudmFyIEZpbHRlckNTUyA9IHJlcXVpcmUoXCJjc3NmaWx0ZXJcIikuRmlsdGVyQ1NTO1xudmFyIERFRkFVTFQgPSByZXF1aXJlKFwiLi9kZWZhdWx0XCIpO1xudmFyIHBhcnNlciA9IHJlcXVpcmUoXCIuL3BhcnNlclwiKTtcbnZhciBwYXJzZVRhZyA9IHBhcnNlci5wYXJzZVRhZztcbnZhciBwYXJzZUF0dHIgPSBwYXJzZXIucGFyc2VBdHRyO1xudmFyIF8gPSByZXF1aXJlKFwiLi91dGlsXCIpO1xuXG4vKipcbiAqIHJldHVybnMgYHRydWVgIGlmIHRoZSBpbnB1dCB2YWx1ZSBpcyBgdW5kZWZpbmVkYCBvciBgbnVsbGBcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqXG4gKiBAcmV0dXJuIHtCb29sZWFufVxuICovXG5mdW5jdGlvbiBpc051bGwob2JqKSB7XG4gIHJldHVybiBvYmogPT09IHVuZGVmaW5lZCB8fCBvYmogPT09IG51bGw7XG59XG5cbi8qKlxuICogZ2V0IGF0dHJpYnV0ZXMgZm9yIGEgdGFnXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IGh0bWxcbiAqIEByZXR1cm4ge09iamVjdH1cbiAqICAgLSB7U3RyaW5nfSBodG1sXG4gKiAgIC0ge0Jvb2xlYW59IGNsb3NpbmdcbiAqL1xuZnVuY3Rpb24gZ2V0QXR0cnMoaHRtbCkge1xuICB2YXIgaSA9IF8uc3BhY2VJbmRleChodG1sKTtcbiAgaWYgKGkgPT09IC0xKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGh0bWw6IFwiXCIsXG4gICAgICBjbG9zaW5nOiBodG1sW2h0bWwubGVuZ3RoIC0gMl0gPT09IFwiL1wiLFxuICAgIH07XG4gIH1cbiAgaHRtbCA9IF8udHJpbShodG1sLnNsaWNlKGkgKyAxLCAtMSkpO1xuICB2YXIgaXNDbG9zaW5nID0gaHRtbFtodG1sLmxlbmd0aCAtIDFdID09PSBcIi9cIjtcbiAgaWYgKGlzQ2xvc2luZykgaHRtbCA9IF8udHJpbShodG1sLnNsaWNlKDAsIC0xKSk7XG4gIHJldHVybiB7XG4gICAgaHRtbDogaHRtbCxcbiAgICBjbG9zaW5nOiBpc0Nsb3NpbmcsXG4gIH07XG59XG5cbi8qKlxuICogc2hhbGxvdyBjb3B5XG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9ialxuICogQHJldHVybiB7T2JqZWN0fVxuICovXG5mdW5jdGlvbiBzaGFsbG93Q29weU9iamVjdChvYmopIHtcbiAgdmFyIHJldCA9IHt9O1xuICBmb3IgKHZhciBpIGluIG9iaikge1xuICAgIHJldFtpXSA9IG9ialtpXTtcbiAgfVxuICByZXR1cm4gcmV0O1xufVxuXG5mdW5jdGlvbiBrZXlzVG9Mb3dlckNhc2Uob2JqKSB7XG4gIHZhciByZXQgPSB7fTtcbiAgZm9yICh2YXIgaSBpbiBvYmopIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShvYmpbaV0pKSB7XG4gICAgICByZXRbaS50b0xvd2VyQ2FzZSgpXSA9IG9ialtpXS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIGl0ZW0udG9Mb3dlckNhc2UoKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXRbaS50b0xvd2VyQ2FzZSgpXSA9IG9ialtpXTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJldDtcbn1cblxuLyoqXG4gKiBGaWx0ZXJYU1MgY2xhc3NcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xuICogICAgICAgIHdoaXRlTGlzdCAob3IgYWxsb3dMaXN0KSwgb25UYWcsIG9uVGFnQXR0ciwgb25JZ25vcmVUYWcsXG4gKiAgICAgICAgb25JZ25vcmVUYWdBdHRyLCBzYWZlQXR0clZhbHVlLCBlc2NhcGVIdG1sXG4gKiAgICAgICAgc3RyaXBJZ25vcmVUYWdCb2R5LCBhbGxvd0NvbW1lbnRUYWcsIHN0cmlwQmxhbmtDaGFyXG4gKiAgICAgICAgY3Nze3doaXRlTGlzdCwgb25BdHRyLCBvbklnbm9yZUF0dHJ9IGBjc3M9ZmFsc2VgIG1lYW5zIGRvbid0IHVzZSBgY3NzZmlsdGVyYFxuICovXG5mdW5jdGlvbiBGaWx0ZXJYU1Mob3B0aW9ucykge1xuICBvcHRpb25zID0gc2hhbGxvd0NvcHlPYmplY3Qob3B0aW9ucyB8fCB7fSk7XG5cbiAgaWYgKG9wdGlvbnMuc3RyaXBJZ25vcmVUYWcpIHtcbiAgICBpZiAob3B0aW9ucy5vbklnbm9yZVRhZykge1xuICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgJ05vdGVzOiBjYW5ub3QgdXNlIHRoZXNlIHR3byBvcHRpb25zIFwic3RyaXBJZ25vcmVUYWdcIiBhbmQgXCJvbklnbm9yZVRhZ1wiIGF0IHRoZSBzYW1lIHRpbWUnXG4gICAgICApO1xuICAgIH1cbiAgICBvcHRpb25zLm9uSWdub3JlVGFnID0gREVGQVVMVC5vbklnbm9yZVRhZ1N0cmlwQWxsO1xuICB9XG4gIGlmIChvcHRpb25zLndoaXRlTGlzdCB8fCBvcHRpb25zLmFsbG93TGlzdCkge1xuICAgIG9wdGlvbnMud2hpdGVMaXN0ID0ga2V5c1RvTG93ZXJDYXNlKG9wdGlvbnMud2hpdGVMaXN0IHx8IG9wdGlvbnMuYWxsb3dMaXN0KTtcbiAgfSBlbHNlIHtcbiAgICBvcHRpb25zLndoaXRlTGlzdCA9IERFRkFVTFQud2hpdGVMaXN0O1xuICB9XG5cbiAgb3B0aW9ucy5vblRhZyA9IG9wdGlvbnMub25UYWcgfHwgREVGQVVMVC5vblRhZztcbiAgb3B0aW9ucy5vblRhZ0F0dHIgPSBvcHRpb25zLm9uVGFnQXR0ciB8fCBERUZBVUxULm9uVGFnQXR0cjtcbiAgb3B0aW9ucy5vbklnbm9yZVRhZyA9IG9wdGlvbnMub25JZ25vcmVUYWcgfHwgREVGQVVMVC5vbklnbm9yZVRhZztcbiAgb3B0aW9ucy5vbklnbm9yZVRhZ0F0dHIgPSBvcHRpb25zLm9uSWdub3JlVGFnQXR0ciB8fCBERUZBVUxULm9uSWdub3JlVGFnQXR0cjtcbiAgb3B0aW9ucy5zYWZlQXR0clZhbHVlID0gb3B0aW9ucy5zYWZlQXR0clZhbHVlIHx8IERFRkFVTFQuc2FmZUF0dHJWYWx1ZTtcbiAgb3B0aW9ucy5lc2NhcGVIdG1sID0gb3B0aW9ucy5lc2NhcGVIdG1sIHx8IERFRkFVTFQuZXNjYXBlSHRtbDtcbiAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcblxuICBpZiAob3B0aW9ucy5jc3MgPT09IGZhbHNlKSB7XG4gICAgdGhpcy5jc3NGaWx0ZXIgPSBmYWxzZTtcbiAgfSBlbHNlIHtcbiAgICBvcHRpb25zLmNzcyA9IG9wdGlvbnMuY3NzIHx8IHt9O1xuICAgIHRoaXMuY3NzRmlsdGVyID0gbmV3IEZpbHRlckNTUyhvcHRpb25zLmNzcyk7XG4gIH1cbn1cblxuLyoqXG4gKiBzdGFydCBwcm9jZXNzIGFuZCByZXR1cm5zIHJlc3VsdFxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBodG1sXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKi9cbkZpbHRlclhTUy5wcm90b3R5cGUucHJvY2VzcyA9IGZ1bmN0aW9uIChodG1sKSB7XG4gIC8vIGNvbXBhdGlibGUgd2l0aCB0aGUgaW5wdXRcbiAgaHRtbCA9IGh0bWwgfHwgXCJcIjtcbiAgaHRtbCA9IGh0bWwudG9TdHJpbmcoKTtcbiAgaWYgKCFodG1sKSByZXR1cm4gXCJcIjtcblxuICB2YXIgbWUgPSB0aGlzO1xuICB2YXIgb3B0aW9ucyA9IG1lLm9wdGlvbnM7XG4gIHZhciB3aGl0ZUxpc3QgPSBvcHRpb25zLndoaXRlTGlzdDtcbiAgdmFyIG9uVGFnID0gb3B0aW9ucy5vblRhZztcbiAgdmFyIG9uSWdub3JlVGFnID0gb3B0aW9ucy5vbklnbm9yZVRhZztcbiAgdmFyIG9uVGFnQXR0ciA9IG9wdGlvbnMub25UYWdBdHRyO1xuICB2YXIgb25JZ25vcmVUYWdBdHRyID0gb3B0aW9ucy5vbklnbm9yZVRhZ0F0dHI7XG4gIHZhciBzYWZlQXR0clZhbHVlID0gb3B0aW9ucy5zYWZlQXR0clZhbHVlO1xuICB2YXIgZXNjYXBlSHRtbCA9IG9wdGlvbnMuZXNjYXBlSHRtbDtcbiAgdmFyIGNzc0ZpbHRlciA9IG1lLmNzc0ZpbHRlcjtcblxuICAvLyByZW1vdmUgaW52aXNpYmxlIGNoYXJhY3RlcnNcbiAgaWYgKG9wdGlvbnMuc3RyaXBCbGFua0NoYXIpIHtcbiAgICBodG1sID0gREVGQVVMVC5zdHJpcEJsYW5rQ2hhcihodG1sKTtcbiAgfVxuXG4gIC8vIHJlbW92ZSBodG1sIGNvbW1lbnRzXG4gIGlmICghb3B0aW9ucy5hbGxvd0NvbW1lbnRUYWcpIHtcbiAgICBodG1sID0gREVGQVVMVC5zdHJpcENvbW1lbnRUYWcoaHRtbCk7XG4gIH1cblxuICAvLyBpZiBlbmFibGUgc3RyaXBJZ25vcmVUYWdCb2R5XG4gIHZhciBzdHJpcElnbm9yZVRhZ0JvZHkgPSBmYWxzZTtcbiAgaWYgKG9wdGlvbnMuc3RyaXBJZ25vcmVUYWdCb2R5KSB7XG4gICAgc3RyaXBJZ25vcmVUYWdCb2R5ID0gREVGQVVMVC5TdHJpcFRhZ0JvZHkoXG4gICAgICBvcHRpb25zLnN0cmlwSWdub3JlVGFnQm9keSxcbiAgICAgIG9uSWdub3JlVGFnXG4gICAgKTtcbiAgICBvbklnbm9yZVRhZyA9IHN0cmlwSWdub3JlVGFnQm9keS5vbklnbm9yZVRhZztcbiAgfVxuXG4gIHZhciByZXRIdG1sID0gcGFyc2VUYWcoXG4gICAgaHRtbCxcbiAgICBmdW5jdGlvbiAoc291cmNlUG9zaXRpb24sIHBvc2l0aW9uLCB0YWcsIGh0bWwsIGlzQ2xvc2luZykge1xuICAgICAgdmFyIGluZm8gPSB7XG4gICAgICAgIHNvdXJjZVBvc2l0aW9uOiBzb3VyY2VQb3NpdGlvbixcbiAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uLFxuICAgICAgICBpc0Nsb3Npbmc6IGlzQ2xvc2luZyxcbiAgICAgICAgaXNXaGl0ZTogT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHdoaXRlTGlzdCwgdGFnKSxcbiAgICAgIH07XG5cbiAgICAgIC8vIGNhbGwgYG9uVGFnKClgXG4gICAgICB2YXIgcmV0ID0gb25UYWcodGFnLCBodG1sLCBpbmZvKTtcbiAgICAgIGlmICghaXNOdWxsKHJldCkpIHJldHVybiByZXQ7XG5cbiAgICAgIGlmIChpbmZvLmlzV2hpdGUpIHtcbiAgICAgICAgaWYgKGluZm8uaXNDbG9zaW5nKSB7XG4gICAgICAgICAgcmV0dXJuIFwiPC9cIiArIHRhZyArIFwiPlwiO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGF0dHJzID0gZ2V0QXR0cnMoaHRtbCk7XG4gICAgICAgIHZhciB3aGl0ZUF0dHJMaXN0ID0gd2hpdGVMaXN0W3RhZ107XG4gICAgICAgIHZhciBhdHRyc0h0bWwgPSBwYXJzZUF0dHIoYXR0cnMuaHRtbCwgZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgICAgLy8gY2FsbCBgb25UYWdBdHRyKClgXG4gICAgICAgICAgdmFyIGlzV2hpdGVBdHRyID0gXy5pbmRleE9mKHdoaXRlQXR0ckxpc3QsIG5hbWUpICE9PSAtMTtcbiAgICAgICAgICB2YXIgcmV0ID0gb25UYWdBdHRyKHRhZywgbmFtZSwgdmFsdWUsIGlzV2hpdGVBdHRyKTtcbiAgICAgICAgICBpZiAoIWlzTnVsbChyZXQpKSByZXR1cm4gcmV0O1xuXG4gICAgICAgICAgaWYgKGlzV2hpdGVBdHRyKSB7XG4gICAgICAgICAgICAvLyBjYWxsIGBzYWZlQXR0clZhbHVlKClgXG4gICAgICAgICAgICB2YWx1ZSA9IHNhZmVBdHRyVmFsdWUodGFnLCBuYW1lLCB2YWx1ZSwgY3NzRmlsdGVyKTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICByZXR1cm4gbmFtZSArICc9XCInICsgdmFsdWUgKyAnXCInO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGNhbGwgYG9uSWdub3JlVGFnQXR0cigpYFxuICAgICAgICAgICAgcmV0ID0gb25JZ25vcmVUYWdBdHRyKHRhZywgbmFtZSwgdmFsdWUsIGlzV2hpdGVBdHRyKTtcbiAgICAgICAgICAgIGlmICghaXNOdWxsKHJldCkpIHJldHVybiByZXQ7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBidWlsZCBuZXcgdGFnIGh0bWxcbiAgICAgICAgaHRtbCA9IFwiPFwiICsgdGFnO1xuICAgICAgICBpZiAoYXR0cnNIdG1sKSBodG1sICs9IFwiIFwiICsgYXR0cnNIdG1sO1xuICAgICAgICBpZiAoYXR0cnMuY2xvc2luZykgaHRtbCArPSBcIiAvXCI7XG4gICAgICAgIGh0bWwgKz0gXCI+XCI7XG4gICAgICAgIHJldHVybiBodG1sO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gY2FsbCBgb25JZ25vcmVUYWcoKWBcbiAgICAgICAgcmV0ID0gb25JZ25vcmVUYWcodGFnLCBodG1sLCBpbmZvKTtcbiAgICAgICAgaWYgKCFpc051bGwocmV0KSkgcmV0dXJuIHJldDtcbiAgICAgICAgcmV0dXJuIGVzY2FwZUh0bWwoaHRtbCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBlc2NhcGVIdG1sXG4gICk7XG5cbiAgLy8gaWYgZW5hYmxlIHN0cmlwSWdub3JlVGFnQm9keVxuICBpZiAoc3RyaXBJZ25vcmVUYWdCb2R5KSB7XG4gICAgcmV0SHRtbCA9IHN0cmlwSWdub3JlVGFnQm9keS5yZW1vdmUocmV0SHRtbCk7XG4gIH1cblxuICByZXR1cm4gcmV0SHRtbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gRmlsdGVyWFNTO1xuIl19
