!function(){var e,t,n=class{constructor(e){this.key=void 0!==e?"cosmo-"+e:"cosmo-highlight"}storeToJson(){const t=localStorage.getItem(this.key);let n;try{n=JSON.parse(t)||[]}catch(e){n=[]}return n}jsonToStore(e){localStorage.setItem(this.key,JSON.stringify(e))}save(e){const t=this.storeToJson(),n={};t.forEach((e,t)=>n[e.id]=t),Array.isArray(e)||(e=[e]),e.forEach(e=>{void 0!==n[e.id]?t[n[e.id]]=e:t.push(e)}),this.jsonToStore(t)}forceSave(e){const t=this.storeToJson();t.push(e),this.jsonToStore(t)}remove(e){const t=this.storeToJson();let n=null;for(let o=0;o<t.length;o++)if(t[o].id===e){n=o;break}t.splice(n,1),this.jsonToStore(t)}getByID(e){const t=this.storeToJson();let n=null;for(let o=0;o<t.length;o++)if(t[o].id===e){n=o;break}return t.find(t=>t.id===e)}getAll(){return this.storeToJson()}removeAll(){this.jsonToStore([])}},o={exports:{}};e=window,t=function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.eventEmitter=t.INTERNAL_ERROR_EVENT=t.UNKNOWN_IDX=t.ROOT_IDX=t.getStylesheet=t.getDefaultOptions=t.CAMEL_DATASET_SPLIT_TYPE=t.CAMEL_DATASET_IDENTIFIER_EXTRA=t.CAMEL_DATASET_IDENTIFIER=t.DATASET_SPLIT_TYPE=t.DATASET_IDENTIFIER_EXTRA=t.DATASET_IDENTIFIER=t.STYLESHEET_ID=t.LOCAL_STORE_KEY=t.ID_DIVISION=void 0;var a=i(n(10)),s=i(n(2));t.ID_DIVISION=";",t.LOCAL_STORE_KEY="highlight-mengshou",t.STYLESHEET_ID="highlight-mengshou-style",t.DATASET_IDENTIFIER="highlight-id",t.DATASET_IDENTIFIER_EXTRA="highlight-id-extra",t.DATASET_SPLIT_TYPE="highlight-split-type",t.CAMEL_DATASET_IDENTIFIER=a.default(t.DATASET_IDENTIFIER),t.CAMEL_DATASET_IDENTIFIER_EXTRA=a.default(t.DATASET_IDENTIFIER_EXTRA),t.CAMEL_DATASET_SPLIT_TYPE=a.default(t.DATASET_SPLIT_TYPE),t.getDefaultOptions=function(){return{$root:document||document.documentElement,exceptSelectors:null,wrapTag:"span",verbose:!1,style:{className:"highlight-mengshou-wrap"}}},t.getStylesheet=function(){return"\n    ."+t.getDefaultOptions().style.className+" {\n        background: #ff9;\n        cursor: pointer;\n    }\n    ."+t.getDefaultOptions().style.className+".active {\n        background: #ffb;\n    }\n"},t.ROOT_IDX=-2,t.UNKNOWN_IDX=-1,t.INTERNAL_ERROR_EVENT="error";var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(s.default);t.eventEmitter=new l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserInputEvent=t.SelectedNodeType=t.CreateFrom=t.EventType=t.ERROR=t.SplitType=void 0,function(e){e.none="none",e.head="head",e.tail="tail",e.both="both"}(t.SplitType||(t.SplitType={})),function(e){e.DOM_TYPE_ERROR="[DOM] Receive wrong node type.",e.DOM_SELECTION_EMPTY="[DOM] The selection contains no dom node, may be you except them.",e.RANGE_INVALID="[RANGE] Got invalid dom range, can't convert to a valid highlight range.",e.RANGE_NODE_INVALID="[RANGE] Start or end node isn't a text node, it may occur an error.",e.DB_ID_DUPLICATE_ERROR="[STORE] Unique id conflict.",e.CACHE_SET_ERROR="[CACHE] Cache.data can't be set manually, please use .save().",e.SOURCE_TYPE_ERROR="[SOURCE] Object isn't a highlight source instance.",e.HIGHLIGHT_RANGE_FROZEN="[HIGHLIGHT_RANGE] A highlight range must be frozen before render.",e.HIGHLIGHT_SOURCE_RECREATE="[HIGHLIGHT_SOURCE] Recreate highlights from sources error.",e.HIGHLIGHT_SOURCE_NONE_RENDER="[HIGHLIGHT_SOURCE] This highlight source isn't rendered. May be the exception skips it or the dom structure has changed."}(t.ERROR||(t.ERROR={})),function(e){e.CREATE="selection:create",e.REMOVE="selection:remove",e.MODIFY="selection:modify",e.HOVER="selection:hover",e.HOVER_OUT="selection:hover-out",e.CLICK="selection:click"}(t.EventType||(t.EventType={})),function(e){e.STORE="from-store",e.INPUT="from-input"}(t.CreateFrom||(t.CreateFrom={})),function(e){e.text="text",e.span="span"}(t.SelectedNodeType||(t.SelectedNodeType={})),function(e){e.touchend="touchend",e.mouseup="mouseup",e.touchstart="touchstart",e.click="click",e.mouseover="mouseover"}(t.UserInputEvent||(t.UserInputEvent={}))},function(e,t,n){"use strict";var o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},r=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.handlersMap=Object.create(null)}return e.prototype.on=function(e,t){return this.handlersMap[e]||(this.handlersMap[e]=[]),this.handlersMap[e].push(t),this},e.prototype.off=function(e,t){return this.handlersMap[e]&&this.handlersMap[e].splice(this.handlersMap[e].indexOf(t)>>>0,1),this},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.handlersMap[e]&&this.handlersMap[e].slice().forEach((function(e){e.apply(void 0,r(t))})),this},e}();t.default=i},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(5)),i=n(9),a=function(){function e(e,t,n,o,r){this.startMeta=e,this.endMeta=t,this.text=n,this.id=o,this.__isHighlightSource={},r&&(this.extra=r)}return e.prototype.deSerialize=function(e,t){var n=i.queryElementNode(this,e),o=n.start,a=n.end,s=i.getTextChildByOffset(o,this.startMeta.textOffset),l=i.getTextChildByOffset(a,this.endMeta.textOffset);if(!t.Serialize.Restore.isEmpty()){var c=t.Serialize.Restore.call(this,s,l)||[];s=c[0]||s,l=c[1]||l}return new r.default(s,l,this.text,this.id,!0)},e}();t.default=a},function(e,t,n){"use strict";var o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.hasClass=t.removeAllClass=t.removeClass=t.addClass=t.addEventListener=t.removeEventListener=t.forEach=t.getHighlightById=t.getHighlightsByRoot=t.getExtraHighlightId=t.getHighlightId=t.isHighlightWrapNode=void 0;var a=n(0);t.isHighlightWrapNode=function(e){return!!e.dataset&&!!e.dataset[a.CAMEL_DATASET_IDENTIFIER]};var s=function(e,n){for(var o=!1,r=null;e;){if(t.isHighlightWrapNode(e)&&(r=e),e===n){o=!0;break}e=e.parentNode}return o?r:null};t.getHighlightId=function(e,t){return(e=s(e,t))?e.dataset[a.CAMEL_DATASET_IDENTIFIER]:""},t.getExtraHighlightId=function(e,t){return(e=s(e,t))?e.dataset[a.CAMEL_DATASET_IDENTIFIER_EXTRA].split(a.ID_DIVISION).filter((function(e){return e})):[]},t.getHighlightsByRoot=function(e,t){var n,r;Array.isArray(e)||(e=[e]);var i=[];try{for(var s=o(e),l=s.next();!l.done;l=s.next()){var c=l.value.querySelectorAll(t+"[data-"+a.DATASET_IDENTIFIER+"]");i.push.apply(i,c)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return i},t.getHighlightById=function(e,t,n){var r,i,s=[],l=new RegExp("("+t+"\\"+a.ID_DIVISION+"|\\"+a.ID_DIVISION+"?"+t+"$)"),c=e.querySelectorAll(n+"[data-"+a.DATASET_IDENTIFIER+"]");try{for(var u=o(c),d=u.next();!d.done;d=u.next()){var f=d.value;if(f.dataset[a.CAMEL_DATASET_IDENTIFIER]!==t){var p=f.dataset[a.CAMEL_DATASET_IDENTIFIER_EXTRA];l.test(p)&&s.push(f)}else s.push(f)}}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return s},t.forEach=function(e,t){for(var n=0;n<e.length;n++)t(e[n],n,e)},t.removeEventListener=function(e,t,n){e.removeEventListener(t,n)},t.addEventListener=function(e,n,o){return e.addEventListener(n,o),function(){t.removeEventListener(e,n,o)}},t.addClass=function(e,t){var n;Array.isArray(t)||(t=[t]),(n=e.classList).add.apply(n,i(t))},t.removeClass=function(e,t){e.classList.remove(t)},t.removeAllClass=function(e){e.className=""},t.hasClass=function(e,t){return e.classList.contains(t)}},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(3)),i=n(1),a=n(11),s=o(n(6)),l=n(12),c=n(0),u=function(){function e(e,t,n,o,r){void 0===r&&(r=!1),3===e.$node.nodeType&&3===t.$node.nodeType||c.eventEmitter.emit(c.INTERNAL_ERROR_EVENT,{type:i.ERROR.RANGE_NODE_INVALID}),this.start=l.formatDomNode(e),this.end=l.formatDomNode(t),this.text=n,this.frozen=r,this.id=o}return e.fromSelection=function(t){var n=a.getDomRange();if(!n)return null;var o={$node:n.startContainer,offset:n.startOffset},r={$node:n.endContainer,offset:n.endOffset},i=n.toString(),l=t.call(o,r,i);return new e(o,r,i,l=null!=l?l:s.default())},e.prototype.serialize=function(e,t){var n,o=l.getDomMeta(this.start.$node,this.start.offset,e),i=l.getDomMeta(this.end.$node,this.end.offset,e);return t.Serialize.RecordInfo.isEmpty()||(n=t.Serialize.RecordInfo.call(this.start,this.end,e)),this.frozen=!0,new r.default(o,i,this.text,this.id,n)},e.removeDomRange=a.removeSelection,e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)}},function(e,t,n){e.exports=n(8)},function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(n(2)),l=a(n(5)),c=a(n(3)),u=a(n(6)),d=a(n(13)),f=a(n(14)),p=a(n(16)),h=a(n(17)),g=n(0),m=n(1),v=n(4),y=function(e){function t(t){var n=e.call(this)||this;n.event=f.default(),n.run=function(){return v.addEventListener(n.options.$root,n.event.PointerEnd,n._handleSelection)},n.stop=function(){v.removeEventListener(n.options.$root,n.event.PointerEnd,n._handleSelection)},n.addClass=function(e,t){n.getDoms(t).forEach((function(t){v.addClass(t,e)}))},n.removeClass=function(e,t){n.getDoms(t).forEach((function(t){v.removeClass(t,e)}))},n.getIdByDom=function(e){return v.getHighlightId(e,n.options.$root)},n.getExtraIdByDom=function(e){return v.getExtraHighlightId(e,n.options.$root)},n.getDoms=function(e){return e?v.getHighlightById(n.options.$root,e,n.options.wrapTag):v.getHighlightsByRoot(n.options.$root,n.options.wrapTag)},n.dispose=function(){var e=n.options.$root;v.removeEventListener(e,n.event.PointerOver,n._handleHighlightHover),v.removeEventListener(e,n.event.PointerEnd,n._handleSelection),v.removeEventListener(e,n.event.PointerTap,n._handleHighlightClick),n.removeAll()},n.setOption=function(e){n.options=i(i({},n.options),e),n.painter=new h.default({$root:n.options.$root,wrapTag:n.options.wrapTag,className:n.options.style.className,exceptSelectors:n.options.exceptSelectors},n.hooks)},n.fromRange=function(e){var t={$node:e.startContainer,offset:e.startOffset},o={$node:e.endContainer,offset:e.endOffset},r=e.toString(),i=n.hooks.Render.UUID.call(t,o,r);i=null!=i?i:u.default();var a=new l.default(t,o,r,i);return a?n._highlightFromHRange(a):(g.eventEmitter.emit(g.INTERNAL_ERROR_EVENT,{type:m.ERROR.RANGE_INVALID}),null)},n.fromStore=function(e,t,o,r,i){var a=new c.default(e,t,o,r,i);try{return n._highlightFromHSource(a),a}catch(e){return g.eventEmitter.emit(g.INTERNAL_ERROR_EVENT,{type:m.ERROR.HIGHLIGHT_SOURCE_RECREATE,error:e,detail:a}),null}},n._getHooks=function(){return{Render:{UUID:new d.default("Render.UUID"),SelectedNodes:new d.default("Render.SelectedNodes"),WrapNode:new d.default("Render.WrapNode")},Serialize:{Restore:new d.default("Serialize.Restore"),RecordInfo:new d.default("Serialize.RecordInfo")},Remove:{UpdateNodes:new d.default("Remove.UpdateNodes")}}},n._highlightFromHRange=function(e){var t=e.serialize(n.options.$root,n.hooks);return 0===n.painter.highlightRange(e).length?(g.eventEmitter.emit(g.INTERNAL_ERROR_EVENT,{type:m.ERROR.DOM_SELECTION_EMPTY}),null):(n.cache.save(t),n.emit(m.EventType.CREATE,{sources:[t],type:m.CreateFrom.INPUT},n),t)},n._handleSelection=function(){var e=l.default.fromSelection(n.hooks.Render.UUID);e&&(n._highlightFromHRange(e),l.default.removeDomRange())},n._handleHighlightHover=function(e){var t=e.target;if(!v.isHighlightWrapNode(t))return n._hoverId&&n.emit(m.EventType.HOVER_OUT,{id:n._hoverId},n,e),void(n._hoverId=null);var o=v.getHighlightId(t,n.options.$root);n._hoverId!==o&&(n._hoverId&&n.emit(m.EventType.HOVER_OUT,{id:n._hoverId},n,e),n._hoverId=o,n.emit(m.EventType.HOVER,{id:n._hoverId},n,e))},n._handleError=function(e){n.options.verbose&&console.warn(e)},n._handleHighlightClick=function(e){var t=e.target;if(v.isHighlightWrapNode(t)){var o=v.getHighlightId(t,n.options.$root);n.emit(m.EventType.CLICK,{id:o},n,e)}},n.options=g.getDefaultOptions(),n.hooks=n._getHooks(),n.setOption(t),n.cache=new p.default;var o=n.options.$root;return v.addEventListener(o,n.event.PointerOver,n._handleHighlightHover),v.addEventListener(o,n.event.PointerTap,n._handleHighlightClick),g.eventEmitter.on(g.INTERNAL_ERROR_EVENT,n._handleError),n}return r(t,e),t.prototype.remove=function(e){if(e){var t=this.painter.removeHighlight(e);this.cache.remove(e),t&&this.emit(m.EventType.REMOVE,{ids:[e]},this)}},t.prototype.removeAll=function(){this.painter.removeAllHighlight();var e=this.cache.removeAll();this.emit(m.EventType.REMOVE,{ids:e},this)},t.prototype._highlightFromHSource=function(e){void 0===e&&(e=[]);var t=this.painter.highlightSource(e);this.emit(m.EventType.CREATE,{sources:t,type:m.CreateFrom.STORE},this),this.cache.save(e)},t.event=m.EventType,t.isHighlightWrapNode=v.isHighlightWrapNode,t.isHighlightSource=function(e){return!!e.__isHighlightSource},t}(s.default);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryElementNode=t.getTextChildByOffset=void 0;var o=n(0);t.getTextChildByOffset=function(e,t){for(var n=[e],o=null,r=0,i=0;o=n.pop();){for(var a=o.childNodes,s=a.length-1;s>=0;s--)n.push(a[s]);if(3===o.nodeType&&(i=t-r,(r+=o.textContent.length)>=t))break}return o||(o=e),{$node:o,offset:i}},t.queryElementNode=function(e,t){return{start:e.startMeta.parentIndex===o.ROOT_IDX?t:t.getElementsByTagName(e.startMeta.parentTagName)[e.startMeta.parentIndex],end:e.endMeta.parentIndex===o.ROOT_IDX?t:t.getElementsByTagName(e.endMeta.parentTagName)[e.endMeta.parentIndex]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.split("-").reduce((function(e,t,n){return e+(0===n?t:t[0].toUpperCase()+t.slice(1))}),"")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeSelection=t.getDomRange=void 0,t.getDomRange=function(){var e=window.getSelection();return e.isCollapsed?(console.debug("no text selected"),null):e.getRangeAt(0)},t.removeSelection=function(){window.getSelection().removeAllRanges()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatDomNode=t.getDomMeta=void 0;var o=n(0);t.getDomMeta=function(e,t,n){var r=function(e){if(e instanceof HTMLElement&&(!e.dataset||!e.dataset[o.CAMEL_DATASET_IDENTIFIER]))return e;for(var t=e.parentNode;null==t?void 0:t.dataset[o.CAMEL_DATASET_IDENTIFIER];)t=t.parentNode;return t}(e),i=r===n?o.ROOT_IDX:function(e,t){for(var n=e.tagName,r=t.getElementsByTagName(n),i=0;i<r.length;i++)if(e===r[i])return i;return o.UNKNOWN_IDX}(r,n),a=function(e,t){for(var n=[e],o=null,r=0;o=n.pop();){for(var i=o.childNodes,a=i.length-1;a>=0;a--)n.push(i[a]);if(3===o.nodeType&&o!==t)r+=o.textContent.length;else if(3===o.nodeType)break}return r}(r,e);return{parentTagName:r.tagName,parentIndex:i,textOffset:a+t}},t.formatDomNode=function(e){return 3===e.$node.nodeType||4===e.$node.nodeType||8===e.$node.nodeType?e:{$node:e.$node.childNodes[e.offset],offset:0}}},function(e,t,n){"use strict";var o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},r=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.name="",this.ops=[],this.name=e}return e.prototype.tap=function(e){var t=this;return-1===this.ops.indexOf(e)&&this.ops.push(e),function(){t.remove(e)}},e.prototype.remove=function(e){var t=this.ops.indexOf(e);t<0||this.ops.splice(t,1)},e.prototype.isEmpty=function(){return 0===this.ops.length},e.prototype.call=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.ops.forEach((function(n){e=n.apply(void 0,r(t))})),e},e}();t.default=i},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=o(n(15));t.default=function(){var e=i.default(window.navigator.userAgent);return{PointerEnd:e?r.UserInputEvent.touchend:r.UserInputEvent.mouseup,PointerTap:e?r.UserInputEvent.touchstart:r.UserInputEvent.click,PointerOver:e?r.UserInputEvent.touchstart:r.UserInputEvent.mouseover}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=/Android|iPhone|BlackBerry|BB10|Opera Mini|Phone|Mobile|Silk|Windows Phone|Mobile(?:.+)Firefox\b/i;t.default=function(e){return o.test(e)}},function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(n(2)),l=n(1),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._data=new Map,t}return r(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.getAll()},set:function(e){throw l.ERROR.CACHE_SET_ERROR},enumerable:!1,configurable:!0}),t.prototype.save=function(e){var t=this;Array.isArray(e)?e.forEach((function(e){return t._data.set(e.id,e)})):this._data.set(e.id,e)},t.prototype.get=function(e){return this._data.get(e)},t.prototype.remove=function(e){this._data.delete(e)},t.prototype.getAll=function(){var e,t,n=[];try{for(var o=i(this._data),r=o.next();!r.done;r=o.next()){var a=r.value;n.push(a[1])}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return n},t.prototype.removeAll=function(){var e,t,n=[];try{for(var o=i(this._data),r=o.next();!r.done;r=o.next()){var a=r.value;n.push(a[0])}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return this._data=new Map,n},t}(s.default);t.default=c},function(e,t,n){"use strict";var o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(n(3)),l=n(18),c=n(4),u=n(1),d=n(20),f=n(0),p=function(){function e(e,t){this.options={$root:e.$root,wrapTag:e.wrapTag,exceptSelectors:e.exceptSelectors,className:e.className},this.hooks=t,d.initDefaultStylesheet()}return e.prototype.highlightRange=function(e){var t=this;if(!e.frozen)throw u.ERROR.HIGHLIGHT_RANGE_FROZEN;var n=this.options,o=n.$root,r=n.className,i=n.exceptSelectors,a=this.hooks,s=l.getSelectedNodes(o,e.start,e.end,i);return a.Render.SelectedNodes.isEmpty()||(s=a.Render.SelectedNodes.call(e.id,s)||[]),s.map((function(n){var o=l.wrapHighlight(n,e,r,t.options.wrapTag);return a.Render.WrapNode.isEmpty()||(o=a.Render.WrapNode.call(e.id,o)),o}))},e.prototype.highlightSource=function(e){var t=this,n=Array.isArray(e)?e:[e],o=[];return n.forEach((function(e){if(e instanceof s.default){var n=e.deSerialize(t.options.$root,t.hooks);t.highlightRange(n).length>0?o.push(e):f.eventEmitter.emit(f.INTERNAL_ERROR_EVENT,{type:u.ERROR.HIGHLIGHT_SOURCE_NONE_RENDER,detail:e})}else f.eventEmitter.emit(f.INTERNAL_ERROR_EVENT,{type:u.ERROR.SOURCE_TYPE_ERROR})})),o},e.prototype.removeHighlight=function(e){var t,n,r=new RegExp("("+e+"\\"+f.ID_DIVISION+"|\\"+f.ID_DIVISION+"?"+e+"$)"),a=this.hooks,s=this.options.wrapTag,u=document.querySelectorAll(s+"[data-"+f.DATASET_IDENTIFIER+"]"),d=[],p=[],h=[];try{for(var g=o(u),m=g.next();!m.done;m=g.next()){var v=m.value,y=v.dataset[f.CAMEL_DATASET_IDENTIFIER],b=v.dataset[f.CAMEL_DATASET_IDENTIFIER_EXTRA];y!==e||b?y===e?p.push(v):y!==e&&r.test(b)&&h.push(v):d.push(v)}}catch(e){t={error:e}}finally{try{m&&!m.done&&(n=g.return)&&n.call(g)}finally{if(t)throw t.error}}return d.forEach((function(t){var n=t.parentNode,o=document.createDocumentFragment();c.forEach(t.childNodes,(function(e){return o.appendChild(e.cloneNode(!1))}));var r=t.previousSibling,i=t.nextSibling;n.replaceChild(o,t),l.normalizeSiblingText(r,!0),l.normalizeSiblingText(i,!1),a.Remove.UpdateNodes.call(e,t,"remove")})),p.forEach((function(t){var n=t.dataset,o=n[f.CAMEL_DATASET_IDENTIFIER_EXTRA].split(f.ID_DIVISION),r=o.shift(),l=document.querySelector(s+"[data-"+f.DATASET_IDENTIFIER+'="'+r+'"]');l&&(c.removeAllClass(t),c.addClass(t,i(l.classList))),n[f.CAMEL_DATASET_IDENTIFIER]=r,n[f.CAMEL_DATASET_IDENTIFIER_EXTRA]=o.join(f.ID_DIVISION),a.Remove.UpdateNodes.call(e,t,"id-update")})),h.forEach((function(t){var n=t.dataset[f.CAMEL_DATASET_IDENTIFIER_EXTRA];t.dataset[f.CAMEL_DATASET_IDENTIFIER_EXTRA]=n.replace(r,""),a.Remove.UpdateNodes.call(e,t,"extra-update")})),d.length+p.length+h.length!==0},e.prototype.removeAllHighlight=function(){var e=this.options,t=e.wrapTag,n=e.$root;c.getHighlightsByRoot(n,t).forEach((function(e){var t=e.parentNode,n=document.createDocumentFragment();c.forEach(e.childNodes,(function(e){return n.appendChild(e.cloneNode(!1))})),t.replaceChild(n,e)}))},e}();t.default=p},function(e,t,n){"use strict";var o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},r=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeSiblingText=t.wrapHighlight=t.getSelectedNodes=void 0;var i=n(1),a=n(4),s=n(0),l=n(19),c=function(e,t){if(!e)return!1;if(/^\./.test(t)){var n=t.replace(/^\./,"");return e&&a.hasClass(e,n)}if(/^#/.test(t)){var o=t.replace(/^#/,"");return e&&e.id===o}var r=t.toUpperCase();return e&&e.tagName===r};t.getSelectedNodes=function(e,t,n,o){var r=t.$node,a=n.$node,s=t.offset,l=n.offset;if(r===a&&r instanceof Text)return function(e,t,n,o){for(var r=e,a=function(e){return null==o?void 0:o.some((function(t){return c(e,t)}))};r;){if(1===r.nodeType&&a(r))return[];r=r.parentNode}e.splitText(t);var s=e.nextSibling;return s.splitText(n-t),[{$node:s,type:i.SelectedNodeType.text,splitType:i.SplitType.both}]}(r,s,l,o);for(var u=[e],d=[],f=function(e){return null==o?void 0:o.some((function(t){return c(e,t)}))},p=!1,h=null;h=u.pop();)if(1!==h.nodeType||!f(h)){for(var g=h.childNodes,m=g.length-1;m>=0;m--)u.push(g[m]);if(h===r){if(3===h.nodeType){h.splitText(s);var v=h.nextSibling;d.push({$node:v,type:i.SelectedNodeType.text,splitType:i.SplitType.head})}p=!0}else{if(h===a){3===h.nodeType&&((v=h).splitText(l),d.push({$node:v,type:i.SelectedNodeType.text,splitType:i.SplitType.tail}));break}p&&3===h.nodeType&&d.push({$node:h,type:i.SelectedNodeType.text,splitType:i.SplitType.none})}}return d};var u=function(e,t){var n=Array.isArray(t)?t:[t];return(n=0===n.length?[s.getDefaultOptions().style.className]:n).forEach((function(t){a.addClass(e,t)})),e},d=function(e){return!e||!e.textContent};t.wrapHighlight=function(e,t,n,o){var c=e.$node.parentNode,f=e.$node.previousSibling,p=e.$node.nextSibling;return a.isHighlightWrapNode(c)?!a.isHighlightWrapNode(c)||d(f)&&d(p)?function(e,t,n){var o=e.$node.parentNode,r=o;a.removeAllClass(r),u(r,n);var i=o.dataset,l=i[s.CAMEL_DATASET_IDENTIFIER];return i[s.CAMEL_DATASET_IDENTIFIER]=t.id,i[s.CAMEL_DATASET_IDENTIFIER_EXTRA]=i[s.CAMEL_DATASET_IDENTIFIER_EXTRA]?l+s.ID_DIVISION+i[s.CAMEL_DATASET_IDENTIFIER_EXTRA]:l,r}(e,t,n):function(e,t,n,o){var a=document.createElement(o),c=e.$node.parentNode,d=e.$node.previousSibling,f=e.$node.nextSibling,p=document.createDocumentFragment(),h=c.dataset[s.CAMEL_DATASET_IDENTIFIER],g=c.dataset[s.CAMEL_DATASET_IDENTIFIER_EXTRA],m=g?h+s.ID_DIVISION+g:h;a.setAttribute("data-"+s.DATASET_IDENTIFIER,t.id),a.setAttribute("data-"+s.DATASET_IDENTIFIER_EXTRA,m),a.appendChild(e.$node.cloneNode(!1));var v,y=!1,b=!1;d&&((E=c.cloneNode(!1)).textContent=d.textContent,p.appendChild(E),y=!0);var E,_=[];return Array.isArray(n)?_.push.apply(_,r(n)):_.push(n),u(a,l.unique(_)),p.appendChild(a),f&&((E=c.cloneNode(!1)).textContent=f.textContent,p.appendChild(E),b=!0),v=y&&b?i.SplitType.both:y?i.SplitType.head:b?i.SplitType.tail:i.SplitType.none,a.setAttribute("data-"+s.DATASET_SPLIT_TYPE,v),c.parentNode.replaceChild(p,c),a}(e,t,n,o):function(e,t,n,o){var r=document.createElement(o);return u(r,n),r.appendChild(e.$node.cloneNode(!1)),e.$node.parentNode.replaceChild(r,e.$node),r.setAttribute("data-"+s.DATASET_IDENTIFIER,t.id),r.setAttribute("data-"+s.DATASET_SPLIT_TYPE,e.splitType),r.setAttribute("data-"+s.DATASET_IDENTIFIER_EXTRA,""),r}(e,t,n,o)},t.normalizeSiblingText=function(e,t){if(void 0===t&&(t=!0),e&&3===e.nodeType){var n=t?e.nextSibling:e.previousSibling;if(3===n.nodeType){var o=n.nodeValue;e.nodeValue=t?e.nodeValue+o:o+e.nodeValue,n.parentNode.removeChild(n)}}}},function(e,t,n){"use strict";var o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.unique=void 0,t.unique=function(e){var t,n,r=[];try{for(var i=o(e),a=i.next();!a.done;a=i.next()){var s=a.value;-1===r.indexOf(s)&&r.push(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initDefaultStylesheet=void 0;var o=n(0);t.initDefaultStylesheet=function(){var e=o.STYLESHEET_ID,t=document.getElementById(e);if(!t){var n=document.createTextNode(o.getStylesheet());(t=document.createElement("style")).id=e,t.appendChild(n),document.head.appendChild(t)}return t}}]).default},"object"==typeof o.exports?o.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof o.exports?o.exports.Highlighter=t():e.Highlighter=t(),o=o.exports;var r={};function i(){return{"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1}}var a=/javascript\s*\:/gim;r.whiteList={"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1},r.getDefaultWhiteList=i,r.onAttr=function(e,t,n){},r.onIgnoreAttr=function(e,t,n){},r.safeAttrValue=function(e,t){return a.test(t)?"":t};var s=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},l=function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")},c={};function u(e){return null==e}function d(e){(e=function(e){var t={};for(var n in e)t[n]=e[n];return t}(e||{})).whiteList=e.whiteList||r.whiteList,e.onAttr=e.onAttr||r.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||r.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||r.safeAttrValue,this.options=e}d.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,n=t.whiteList,o=t.onAttr,r=t.onIgnoreAttr,i=t.safeAttrValue;return function(e,t){";"!==(e=l(e))[e.length-1]&&(e+=";");var n=e.length,o=!1,r=0,i=0,a="";function c(){if(!o){var n=s(e.slice(r,i)),l=n.indexOf(":");if(-1!==l){var c=s(n.slice(0,l)),u=s(n.slice(l+1));if(c){var d=t(r,a.length,c,u,n);d&&(a+=d+"; ")}}}r=i+1}for(;i<n;i++){var u=e[i];if("/"===u&&"*"===e[i+1]){var d=e.indexOf("*/",i+2);if(-1===d)break;r=(i=d+1)+1,o=!1}else"("===u?o=!0:")"===u?o=!1:";"===u?o||c():"\n"===u&&c()}return s(a)}(e,(function(e,t,a,s,l){var c=n[a],d=!1;if(!0===c?d=c:"function"==typeof c?d=c(s):c instanceof RegExp&&(d=c.test(s)),!0!==d&&(d=!1),s=i(a,s)){var f,p={position:t,sourcePosition:e,source:l,isWhite:d};return d?u(f=o(a,s,p))?a+":"+s:f:u(f=r(a,s,p))?void 0:f}}))},c=d;var f={};for(var p in(f=f=function(e,t){return new c(t).process(e)}).FilterCSS=c,r)f[p]=r[p];"undefined"!=typeof window&&(window.filterCSS=f);var h=function(e,t){var n,o;if(Array.prototype.indexOf)return e.indexOf(t);for(n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1},g=function(e,t,n){var o,r;if(Array.prototype.forEach)return e.forEach(t,n);for(o=0,r=e.length;o<r;o++)t.call(n,e[o],o,e)},m=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},v=function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1},y={},b=f.FilterCSS,E=f.getDefaultWhiteList;var _=new b;function T(e){return e.replace(A,"&lt;").replace(I,"&gt;")}var A=/</g,I=/>/g,S=/"/g,w=/&quot;/g,x=/&#([a-zA-Z0-9]*);?/gim,R=/&colon;?/gim,N=/&newline;?/gim,k=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,D=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,O=/u\s*r\s*l\s*\(.*/gi;function C(e){return e.replace(S,"&quot;")}function L(e){return e.replace(w,'"')}function M(e){return e.replace(x,(function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))}))}function H(e){return e.replace(R,":").replace(N," ")}function P(e){for(var t="",n=0,o=e.length;n<o;n++)t+=e.charCodeAt(n)<32?" ":e.charAt(n);return m(t)}function j(e){return P(e=H(e=M(e=L(e))))}function q(e){return T(e=C(e))}y.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]},y.getDefaultWhiteList=function(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}},y.onTag=function(e,t,n){},y.onIgnoreTag=function(e,t,n){},y.onTagAttr=function(e,t,n){},y.onIgnoreTagAttr=function(e,t,n){},y.safeAttrValue=function(e,t,n,o){if(n=j(n),"href"===t||"src"===t){if("#"===(n=m(n)))return"#";if("http://"!==n.substr(0,7)&&"https://"!==n.substr(0,8)&&"mailto:"!==n.substr(0,7)&&"tel:"!==n.substr(0,4)&&"data:image/"!==n.substr(0,11)&&"ftp://"!==n.substr(0,6)&&"./"!==n.substr(0,2)&&"../"!==n.substr(0,3)&&"#"!==n[0]&&"/"!==n[0])return""}else if("background"===t){if(k.lastIndex=0,k.test(n))return""}else if("style"===t){if(D.lastIndex=0,D.test(n))return"";if(O.lastIndex=0,O.test(n)&&(k.lastIndex=0,k.test(n)))return"";!1!==o&&(n=(o=o||_).process(n))}return q(n)},y.escapeHtml=T,y.escapeQuote=C,y.unescapeQuote=L,y.escapeHtmlEntities=M,y.escapeDangerHtml5Entities=H,y.clearNonPrintableCharacter=P,y.friendlyAttrValue=j,y.escapeAttrValue=q,y.onIgnoreTagStripAll=function(){return""},y.StripTagBody=function(e,t){"function"!=typeof t&&(t=function(){});var n=!Array.isArray(e),o=[],r=!1;return{onIgnoreTag:function(i,a,s){if(function(t){return!!n||-1!==h(e,t)}(i)){if(s.isClosing){var l="[/removed]",c=s.position+l.length;return o.push([!1!==r?r:s.position,c]),r=!1,l}return r||(r=s.position),"[removed]"}return t(i,a,s)},remove:function(e){var t="",n=0;return g(o,(function(o){t+=e.slice(n,o[0]),n=o[1]})),t+=e.slice(n)}}},y.stripCommentTag=function(e){for(var t="",n=0;n<e.length;){var o=e.indexOf("\x3c!--",n);if(-1===o){t+=e.slice(n);break}t+=e.slice(n,o);var r=e.indexOf("--\x3e",o);if(-1===r)break;n=r+3}return t},y.stripBlankChar=function(e){var t=e.split("");return(t=t.filter((function(e){var t=e.charCodeAt(0);return!(127===t||t<=31&&10!==t&&13!==t)}))).join("")},y.cssFilter=_,y.getDefaultCSSWhiteList=E;var F={};function $(e){var t,n=v(e);return t=-1===n?e.slice(1,-1):e.slice(1,n+1),"/"===(t=m(t).toLowerCase()).slice(0,1)&&(t=t.slice(1)),"/"===t.slice(-1)&&(t=t.slice(0,-1)),t}function V(e){return"</"===e.slice(0,2)}var z=/[^a-zA-Z0-9\\_:.-]/gim;function U(e,t){for(;t<e.length;t++){var n=e[t];if(" "!==n)return"="===n?t:-1}}function B(e,t){for(;t<e.length;t++){var n=e[t];if(" "!==n)return"'"===n||'"'===n?t:-1}}function X(e,t){for(;t>0;t--){var n=e[t];if(" "!==n)return"="===n?t:-1}}function W(e){return function(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]}(e)?e.substr(1,e.length-2):e}F.parseTag=function(e,t,n){"use strict";var o="",r=0,i=!1,a=!1,s=0,l=e.length,c="",u="";e:for(s=0;s<l;s++){var d=e.charAt(s);if(!1===i){if("<"===d){i=s;continue}}else if(!1===a){if("<"===d){o+=n(e.slice(r,s)),i=s,r=s;continue}if(">"===d||s===l-1){o+=n(e.slice(r,i)),c=$(u=e.slice(i,s+1)),o+=t(i,o.length,c,u,V(u)),r=s+1,i=!1;continue}if('"'===d||"'"===d)for(var f=1,p=e.charAt(s-f);""===p.trim()||"="===p;){if("="===p){a=d;continue e}p=e.charAt(s-++f)}}else if(d===a){a=!1;continue}}return r<l&&(o+=n(e.substr(r))),o},F.parseAttr=function(e,t){"use strict";var n=0,o=0,r=[],i=!1,a=e.length;function s(e,n){if(!((e=(e=m(e)).replace(z,"").toLowerCase()).length<1)){var o=t(e,n||"");o&&r.push(o)}}for(var l=0;l<a;l++){var c,u=e.charAt(l);if(!1!==i||"="!==u)if(!1===i||l!==o){if(/\s|\n|\t/.test(u)){if(e=e.replace(/\s|\n|\t/g," "),!1===i){if(-1===(c=U(e,l))){s(m(e.slice(n,l))),i=!1,n=l+1;continue}l=c-1;continue}if(-1===(c=X(e,l-1))){s(i,W(m(e.slice(n,l)))),i=!1,n=l+1;continue}}}else{if(-1===(c=e.indexOf(u,l+1)))break;s(i,m(e.slice(o+1,c))),i=!1,n=(l=c)+1}else i=e.slice(n,l),n=l+1,o='"'===e.charAt(n)||"'"===e.charAt(n)?n:B(e,l+1)}return n<e.length&&(!1===i?s(e.slice(n)):s(i,W(m(e.slice(n))))),m(r.join(" "))};var G={},Y=f.FilterCSS,J=F.parseTag,K=F.parseAttr;function Z(e){return null==e}function Q(e){(e=function(e){var t={};for(var n in e)t[n]=e[n];return t}(e||{})).stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=y.onIgnoreTagStripAll),e.whiteList||e.allowList?e.whiteList=function(e){var t={};for(var n in e)Array.isArray(e[n])?t[n.toLowerCase()]=e[n].map((function(e){return e.toLowerCase()})):t[n.toLowerCase()]=e[n];return t}(e.whiteList||e.allowList):e.whiteList=y.whiteList,e.onTag=e.onTag||y.onTag,e.onTagAttr=e.onTagAttr||y.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||y.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||y.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||y.safeAttrValue,e.escapeHtml=e.escapeHtml||y.escapeHtml,this.options=e,!1===e.css?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new Y(e.css))}Q.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,n=t.whiteList,o=t.onTag,r=t.onIgnoreTag,i=t.onTagAttr,a=t.onIgnoreTagAttr,s=t.safeAttrValue,l=t.escapeHtml,c=this.cssFilter;t.stripBlankChar&&(e=y.stripBlankChar(e)),t.allowCommentTag||(e=y.stripCommentTag(e));var u=!1;t.stripIgnoreTagBody&&(u=y.StripTagBody(t.stripIgnoreTagBody,r),r=u.onIgnoreTag);var d=J(e,(function(e,t,u,d,f){var p={sourcePosition:e,position:t,isClosing:f,isWhite:Object.prototype.hasOwnProperty.call(n,u)},g=o(u,d,p);if(!Z(g))return g;if(p.isWhite){if(p.isClosing)return"</"+u+">";var y=function(e){var t=v(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var n="/"===(e=m(e.slice(t+1,-1)))[e.length-1];return n&&(e=m(e.slice(0,-1))),{html:e,closing:n}}(d),b=n[u],E=K(y.html,(function(e,t){var n=-1!==h(b,e),o=i(u,e,t,n);return Z(o)?n?(t=s(u,e,t,c))?e+'="'+t+'"':e:Z(o=a(u,e,t,n))?void 0:o:o}));return d="<"+u,E&&(d+=" "+E),y.closing&&(d+=" /"),d+">"}return Z(g=r(u,d,p))?l(d):g}),l);return u&&(d=u.remove(d)),d},G=Q;var ee={};function te(e,t){return new G(t).process(e)}function ne(e){if("number"==typeof e.selectionStart)e.selectionStart=e.selectionEnd=e.value.length;else if(void 0!==e.createTextRange){e.focus();var t=e.createTextRange();t.collapse(!1),t.select()}}function oe(e,t){const o=new n("user"),r=o.getByID(t);let i={id:"",value:""};return void 0===r||""===r.value?(i.id=""+t,i.value=e,o.save(i)):i=r,i}function re(e,t){const n=document.querySelector("#comment_count"),o=new Number(n.innerHTML);if("increase"===e)n.innerHTML=o+t;else if("decrease"===e){const e=o-t;n.innerHTML=e<0?0:e}}(ee=ee=te).filterXSS=te,ee.FilterXSS=G,function(){for(var e in y)ee[e]=y[e];for(var t in F)ee[t]=F[t]}(),"undefined"!=typeof window&&(window.filterXSS=ee),"undefined"!=typeof self&&"undefined"!=typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope&&(self.filterXSS=ee),new n;var ie={commentReviewList:function e(t){const o=document.querySelector(".comment-data");Array.from(o.childNodes).map(e=>{e.remove()});const r=new n("comment-"+t);let i=r.getAll();i=i.filter(e=>"draft"===e.status),i.map((e,r)=>{const i=function(e,t,o){new n("comment-"+o);const r=document.createElement("div");r.classList.add("comment-list-wrapper"),r.setAttribute("id",e.id);const i=document.createElement("input");i.setAttribute("type","checkbox"),i.setAttribute("id","comment_data[]"),i.setAttribute("name","comment_data[]"),i.classList.add("comment-list-input");const a=document.createElement("label");a.setAttribute("for","comment-list-"+t),a.classList.add("comment-list-label");const s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("id","comment-list-text-"+t),s.setAttribute("text","comment-list-text"),s.setAttribute("value",e.content.text),s.setAttribute("readonly","readonly");const l=e.id,c=document.querySelector(`[data-highlight-id="${l}"]`);null!==c&&c.setAttribute("id",l);const u=document.createElement("a");u.setAttribute("href","#"+l),u.innerHTML="Show",u.classList.add("comment-list-show-highlight"),u.addEventListener("click",e=>{c.style.border="1px solid blue",setTimeout(()=>{c.style.border=""},"3000")});const d=document.createElement("div");return d.classList.add("comment-label-wrapper"),d.append(s),a.append(d),d.append(u),r.append(i),r.append(a),r}(e,r,t);o.append(i)}),i.length&&(document.querySelector(".comment-status").innerHTML="Your unpublished comments:");let a="";i.length>0&&(a=i[0].content.user);const s=oe(a,t),l=document.querySelector(".comment-username-wrapper").querySelector("input");l.value=s.value,l.style.width=l.value.length+1+"ch";const c=new n("user");document.querySelector(".comment-username-edit-btn").addEventListener("click",e=>{const t=e.target;"save"===t.textContent?(s.value=l.value,c.save(s),t.textContent="edit",l.setAttribute("readonly","readonly"),l.style.width=l.value.length+1+"ch",l.style.borderColor="transparent",document.querySelector("body").focus()):"edit"===t.textContent&&(t.textContent="save",ne(l),l.removeAttribute("readonly"),l.style.width="auto",l.style.borderColor="black",l.focus())});const u=document.querySelector(".post_comment"),d=document.querySelector(".comment-edit"),f=document.querySelector(".comment-remove");if(i.length>0){const n=Array.from(document.querySelectorAll(".comment-list-input"));u.classList.remove("hidden"),u.addEventListener("click",e=>{n.map(e=>{if(e.checked){const t=e.parentNode.id,n=i.find(e=>{if(void 0!==e.content.selection_text){if(e.content.selection_text.id===t)return e}else if(e.content.block_id===t)return e});n.status="published",e.value=JSON.stringify(n),r.remove(t)}else e.value=""})}),d.classList.remove("hidden"),d.addEventListener("click",e=>{e.preventDefault();const t=e.target,o=t.textContent;n.find(e=>e.checked)&&("save"===t.textContent?t.textContent="edit":"edit"===t.textContent&&(t.textContent="save")),n.map((e,t)=>{if(e.checked){const t=e.parentNode.id,n=i.find(e=>{if(void 0!==e.content.selection_text){if(e.content.selection_text.id===t)return e}else if(e.content.block_id===t)return e}),a=e.parentNode.querySelector(".comment-label-wrapper > input");"save"===o?(n.content.text=a.value,r.save(n),a.setAttribute("readonly","readonly"),a.style.borderColor="transparent",document.querySelector("body").focus()):"edit"===o&&(ne(a),a.removeAttribute("readonly"),a.style.width="auto",a.style.borderColor="black")}})}),f.classList.remove("hidden"),f.addEventListener("click",o=>{o.preventDefault(),n.map(e=>{if(e.checked){const t=e.parentNode.id;""!==t&&(r.remove(t),function(e){const t=document.querySelector(`[data-highlight-id="${e}"]`);null!==t&&t.remove();const n=document.querySelector(`[data-text-selection-id="${e}"]`);null!==n&&n.remove();const o=document.querySelector(".content-wrapper #"+e);null!==o&&o.classList.remove("block-highlight")}(t))}}),e(t),re("decrease",i.length)})}else u.classList.add("hidden"),d.classList.add("hidden"),f.classList.add("hidden")},setUsername:oe,updateCommentCounter:re};const ae=new n,{commentReviewList:se,setUsername:le,updateCommentCounter:ce}=ie;function ue(e){const t=document.createElement("section"),n=e.content.text;t.append(n);const o=document.createElement("footer");o.classList.add("small_italic");const r=document.createElement("p"),i=document.createElement("time"),a=new Date(e.content.timestamp).toLocaleDateString("nl-NL",{timeZone:"Europe/Berlin",day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"});i.setAttribute("datetime",e.content.timestamp),r.append(i),r.innerHTML="On "+a;const s=document.createElement("p");s.innerHTML="by "+e.content.user,o.append(r),o.append(s);const l=document.createElement("article");return l.setAttribute("tabindex","0"),l.setAttribute("data-text-selection-id",e.id),l.classList.add("comment-draft"),l.append(t),l.append(o),l}function de(e,t,n){let o;e.reset(),e.blur();const r=e.parentNode;if(r.classList.contains("toolbar")){o=function(e){const t=document.createElement("section");t.classList.add("thread");const n=e.cloneNode(!0);return t.appendChild(n),t}(e);const n=e.getAttribute("data-block-id");if(""!==n){const e=document.querySelector(".content-wrapper section#"+n);if(null!==e){const n=e.querySelector("aside"),i=Array.from(o.children)[0];o.insertBefore(t,i),n.appendChild(o),r.classList.add("hidden"),r.style.removeProperty("--top"),r.style.removeProperty("--left")}}}else o=r,o.insertBefore(t,e);if(void 0===n.content.selection_text&&""!==n.id){const e=document.querySelector(".content-wrapper #"+n.id);null!==e&&e.classList.add("block-highlight")}}var fe={respond_comment:function(e){e.preventDefault();const t=e.target;let o=function(e,t){const n=Array.from(e.children),o=n.find(e=>"body"==e.name),r=ee(o.value.trim());if(""===r)return o.value=o.value.trim(),o.focus(),o.placeholder="Please add some text",o.style.border="1px solid red",setTimeout(()=>{o.style.border="",o.placeholder="comment..."},"3000"),!1;const i=e.getAttribute("data-article-slug"),a=e.getAttribute("data-block-id"),s=e.getAttribute("data-block-selection-type"),l=e.getAttribute("data-block-comment-id"),c=t.getByID(l),u=ee(n.find(e=>"author"==e.name).value),d=r,f=(new Date).toISOString();return{slug:f,title:f,template:"comment",status:"draft",content:{user:u,timestamp:f,article_slug:i,block_id:a,text:d,selection_type:s,selection_text:c}}}(t,ae);if(!o)return;void 0!==o.content.selection_text?o.id=o.content.selection_text.id:o.id=o.content.block_id,le(o.content.user,o.content.article_slug);const r=o.content.article_slug;new n("comment-"+r).save(o),se(r);const i=ue(o);de(t,i,o),i.focus()},commentsArticle:function(e,t){const n=ue(e);t.setAttribute("data-block-selection-type",e.content.selection_type),t.setAttribute("data-block-comment-id",e.id),t.querySelector("#selection_type").value=e.content.selection_type,t.querySelector("#block_id").value=e.content.block_id,t.querySelector("#author").setAttribute("value",e.content.user),de(t,n,e)},blockFocus:function(){const e=Array.from(document.querySelectorAll(".block")).filter(e=>!e.classList.contains("columns")),t=document.querySelector(".focus-overlay");e.forEach(e=>{e.addEventListener("focus",e=>{e.target.classList.add("selected"),t.classList.toggle("active")}),e.addEventListener("blur",e=>{e.target.classList.remove("selected"),t.classList.toggle("active")})})}};function pe(e){const t=Array.from(document.querySelectorAll(".content-wrapper .column")),n=Array.from(document.querySelectorAll(".content-wrapper .block")),o=Array.from(document.querySelectorAll(".content-wrapper .block > .contents")),r=Array.from(document.querySelectorAll("aside")),i=Array.from(document.querySelectorAll(".thread"));switch(t.map(e=>{e.setAttribute("data-col-width","1/1")}),n.map(e=>{e.classList.remove("hidden"),e.style.boxShadow="var(--gridshadow)",e.style.padding="0.5rem"}),o.map(e=>{e.classList.remove("font-size-micro"),e.classList.remove("hidden")}),r.map(e=>{e.style.maxWidth="var(--side-width)",e.style.width="var(--side-width)",e.style.setProperty("--n","1")}),i.map(e=>e.classList.remove("hidden")),e){case"1":i.map(e=>e.classList.add("hidden"));break;case"2":break;case"3":t.map(e=>{e.setAttribute("data-col-width","1/4")}),o.map(e=>{e.classList.add("font-size-micro")}),r.map(e=>{e.style.width="67vw",e.style.maxWidth="67vw",e.style.setProperty("--n","4")});break;case"4":t.map(e=>{e.setAttribute("data-col-width","1/4")}),n.map(e=>{e.style.boxShadow="none",e.style.padding="0",console.log("block =>",e)}),o.map(e=>{e.classList.add("font-size-micro"),e.classList.add("hidden")}),r.map(e=>{e.style.width="78vw",e.style.maxWidth="78vw",e.style.setProperty("--n","5")})}}const{respond_comment:he,commentsArticle:ge,blockFocus:me}=fe,{commentReviewList:ve}=ie,ye=window.location.pathname.split("/").pop().split("/").join("+");(async()=>{await async function(e){return fetch("/cosmo-api/"+e).then(e=>e.json()).then(t=>{!function(e,t){const o=new n("comment-"+t),r=[...o.getAll(),...e].filter((e,t,n)=>t===n.findIndex(t=>t.id===e.id));o.save(r)}(t,e)}).catch(e=>[])}(ye)})();const be=document.querySelectorAll(".comment_form"),Ee=new n("user").getByID(ye),_e=new n("comment-"+ye).getAll();for(const Te of be){void 0!==Ee&&(Te.querySelector("#author").value=Ee.value);const e=Te.dataset.blockId,t=_e.filter(t=>{if("draft"===t.status&&t.content.block_id===e)return t});t.length>0&&t.map(e=>{ge(e,Te)}),Te.onsubmit=he}!function(e,t,r){const i=new o({$root:document.querySelector(".content-wrapper"),wrapTag:"span",exceptSelectors:[".block-title",".highlight-tip","aside"]});i.setOption({style:{className:"bgc-accent"}}),new n("comment-"+r).getAll().forEach(e=>{if("object"==typeof e&&"content"in e&&void 0!==e.content.selection_text){const t=e.content.selection_text;i.fromStore(t.startMeta,t.endMeta,t.text,t.id)}});const a=new n;function s(e){e.classList.add("hidden"),e.style.removeProperty("--top"),e.style.removeProperty("--left")}i.on(o.event.CLICK,({id:e})=>{console.log("click -",e)}).on(o.event.HOVER,({id:e})=>{console.log("hover -",e),i.addClass("highlight-wrap-hover",e)}).on(o.event.HOVER_OUT,({id:e})=>{console.log("hover out -",e),i.removeClass("highlight-wrap-hover",e)}).on(o.event.CREATE,({sources:e})=>{s(t),e.forEach(e=>{const o=i.getDoms(e.id)[0],l=function(e){const t=e.closest("section .block");return null!=t&&t.id?t.id:""}(o),c=new n("user").getByID(r);!function(e,t,n,o,r,a){const l=t.querySelector("form");l.setAttribute("data-block-selection-type","text"),l.setAttribute("data-block-comment-id",o),l.setAttribute("data-block-id",r),l.querySelector("#selection_type").value="text",l.querySelector("#block_id").value=r,l.querySelector("#author").value=a.value,t.classList.remove("hidden"),t.style.setProperty("--top",e.top+"px"),t.style.setProperty("--left",e.left+e.width+"px");t.querySelector(".toolbar-btn-hide").addEventListener("click",()=>{s(t),document.querySelector(`[data-id="${o}"]`),function(e,t){e.remove(t)}(i,o)})}(function(e){let t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset,left:t.left+window.pageXOffset,width:t.width,height:t.height}}(o),t,0,e.id,l,c),a.save(e),t.querySelector("form").querySelector("#selection_text").value=JSON.stringify(e)})}).on(o.event.REMOVE,({ids:e})=>{console.log("remove -",e)}),i.run()}(document.querySelector("main"),document.querySelector(".toolbar"),ye),function(){const e=document.querySelector(".view-options");e.querySelector("input:checked"),Array.from(e.querySelectorAll("input")).map(e=>{e.checked&&pe(e.value),e.addEventListener("click",e=>{pe(e.target.value)})})}(),ve(ye),me(),function(){function e(e,n,o){window.innerWidth<=600?(n.classList.add("hidden"),o.length>0&&o.map(e=>{e.style.display="none"}),e.length>0&&e.map((e,t)=>{e.addEventListener("click",t=>{t.preventDefault();const r=e.id.split("-").pop(),i=o.find(e=>e.id.split("-").pop()===r);"table-row"===i.style.display?(i.style.display="none",n.removeAttribute("style")):(o.map(e=>{e.style.display="none"}),i.style.display="table-row",n.style.display="block",n.style.position="fixed",n.style.bottom=0,n.style.left=0,n.style.backgroundColor="white")})})):t()}function t(){if(window.innerWidth>=600){o.classList.remove("hidden"),o.removeAttribute("style"),r.length>0&&r.map(e=>{e.removeAttribute("style")}),document.querySelector(".view-comment-options-wrapper").getBoundingClientRect();let e=document.querySelector(".content-wrapper .row .column").getBoundingClientRect();o.style.left=e.width+"px",n.forEach(e=>{let t=Math.round(e.getBoundingClientRect().top-o.getBoundingClientRect().top);const n=e.id.split("-").pop(),i=r.find(e=>e.id.split("-").pop()===n);i.previousElementSibling&&(t=function(e,t,n){const o=e.previousElementSibling,r=parseInt(o.style.top,10),i=o.getBoundingClientRect().bottom-n;return t===r?t+o.getBoundingClientRect().height:t<i?i:t}(i,t,o.getBoundingClientRect().top)),i.style.position="absolute",i.style.top=t+"px"})}}const n=Array.from(document.querySelectorAll(".ref-ft")),o=document.querySelector(".notes"),r=Array.from(o.querySelectorAll(".notes li"));e(n,o,r),t(),window.addEventListener("resize",()=>{e(n,o,r),t()})}()}();