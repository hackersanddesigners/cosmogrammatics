(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
const LocalStore = require('./local.store')
const store = new LocalStore()

function respond_comment( e ) {
  e.preventDefault()
  const form    = e.target
  const comment = make_comment( form, store )
  post_comment( comment )
  .then( response => {
    if ( response.status === 'ok' ) {

      // form: reset and hide form
      form.reset()
      form.blur()

      // create newly posted comment
      const article = make_comment_el( response.data )

      // append new comment to comment thread
      // before <form> (blue circle)

      let thread

      // first check if the form is the toolbar form
      const form_parent = form.parentNode
      if ( form_parent.classList.contains( 'toolbar' ) ) {
        // make a new comment thread for this block
        thread = make_comment_thread_el( form.cloneNode( true ) )
        const block_id = form.getAttribute( 'data-block-id' )
        const block = document.getElementById( block_id )
        const aside = block.querySelector( 'aside' )
        const thread_form = Array.from( thread.children )[0]
        thread.insertBefore( article, thread_form )
        aside.appendChild( thread )
      } else {
        thread = form_parent
        thread.insertBefore(article, form)
      }

      // update comment count
      const comment_count = document.querySelector('#comment_count')
      comment_count.innerHTML = new Number( comment_count.innerHTML ) + 1

      article.focus()

    }
  })
}

function make_comment( form, store ) {
  const chilren           = Array.from( form.children )
  const csrf              = form.getAttribute( 'data-csrf' )
  const article_slug      = form.getAttribute( 'data-article-slug' )
  const block_id          = form.getAttribute( 'data-block-id' )
  const selection_type    = form.getAttribute( 'data-block-selection-type' )
  const selection_text_id = form.getAttribute( 'data-block-selection-text-id' )
  const selection_text    = store.getByID(selection_text_id)
  const author            = chilren.find( c => c.name == 'author' ).value
  const text              = chilren.find( c => c.name == 'body' ).value
  const ts                = new Date().toISOString()
  return {
    slug: `test-${ ts }`,
    title: '',
    template: 'comment',
    csrf: csrf,
    content: {
      user: author,
      timestamp: ts,
      article_slug: article_slug,
      block_id: block_id,
      text: text,
      selection_type: selection_type,
      selection_text: selection_text,
      // selection_coords: selection_coords
    }
  }
}

function save_comment( comment ) {

}

function make_comment_thread_el( form, position ) {
  const thread = document.createElement( 'section' )
  thread.classList.add( 'thread' )
  thread.classList.add( 'new' )
  thread.appendChild( form )
  thread.style.setProperty( '--top', position.top + 'px' )
  thread.style.setProperty( '--left', position.left + 'px' )
  return thread
}

function make_comment_form_el( template_form, source_id, block_id, position ) {
  const form = template_form.cloneNode( true )
  form.setAttribute('data-block-selection-type', 'text')
  form.setAttribute('data-block-selection-text-id', source_id )
  form.setAttribute('data-block-id', block_id )
  form.onsubmit = respond_comment
  return form
}

function make_comment_el( data ) {

  // -- section
  const text_comment = document.createElement('section')
  const section_text = data.content.text
  text_comment.append(section_text)

  // -- footer
  const footer = document.createElement('footer')
  footer.classList.add( 'small_italic' )
  const date = document.createElement('p')
  const timestamp = document.createElement('time')
  // TODO set correct datetime format for timestamp `yyyy-mm-dd hh:mm:ss`
  timestamp.setAttribute('datetime', data.content.timestamp)
  date.append(timestamp)
  date.innerHTML = `On ${data.content.timestamp}`

  const user = document.createElement('p')
  user.innerHTML = `by ${data.content.user}`

  footer.append(date)
  footer.append(user)

  // -- append everything to <article>
  const article = document.createElement('article')
  article.setAttribute('tabindex', '0')

  article.append(text_comment)
  article.append(footer)

  return article

}

function post_comment( comment ) {
  const csrf = comment.csrf
  const article_slug = comment.content.article_slug
  const url  = `/api/pages/articles+${ article_slug }+comments`

  return fetch( `${ url }/children` , {
    method: "POST",
    headers: { "X-CSRF": csrf },
    body: JSON.stringify( comment )
  })
  .then(response => response.json())
  .then(response => {

    // set comment to be published
    return fetch( `${ url }+${ response.data.slug }/status`, {
      method: "PATCH",
      headers: { "X-CSRF": csrf },
      body: JSON.stringify( { status: 'listed' } )
    })
    .then(response => response.json())
    .then( response => response )
    .catch( error => console.error( error ) )

  })
    .then(response => response)
    .catch(error => console.error(error) )

}


module.exports = {
  respond_comment,
  post_comment,
  make_comment_el,
  make_comment_thread_el,
  make_comment_form_el,

}

},{"./local.store":3}],2:[function(require,module,exports){
const textHighlightMergeUnique = require('./text-highlights-merge-unique')

async function fetchArticleHighlightsFromAPI(article_slug) {
  const csrf = document.querySelector('.toolbar > form').getAttribute('data-csrf')
 
  const url = `/api/cosmo/${ article_slug }`
  return fetch(url, {
    method: "GET",
    headers: {
      "X-CSRF" : csrf
    }
  })
  .then(response => response.json())
  .then(response => {
    const newData = response
    textHighlightMergeUnique(newData)

  })
  .catch(error => {
    return []
  });

}

module.exports = fetchArticleHighlightsFromAPI

},{"./text-highlights-merge-unique":6}],3:[function(require,module,exports){
// <https://github.com/alienzhou/web-highlighter/blob/master/example/local.store.js>

class LocalStore {
    constructor(id) {
        this.key = id !== undefined ? `cosmo-highlight-${id}` : 'cosmo-highlight';
    }

    storeToJson() {
        const store = localStorage.getItem(this.key);
        let sources;
        try {
            sources = JSON.parse(store) || [];
        }
        catch (e) {
            sources = [];
        }
        return sources;
    }

    jsonToStore(stores) {
        localStorage.setItem(this.key, JSON.stringify(stores));
    }

    save(data) {
        const stores = this.storeToJson();
        const map = {};
        stores.forEach((store, idx) => map[store.id] = idx);

        if (!Array.isArray(data)) {
            data = [data];
        }

        data.forEach(store => {
            // update
            if (map[store.id] !== undefined) {
                stores[map[store.id]] = store;
            }
            // append
            else {
                stores.push(store);
            }
        })
        this.jsonToStore(stores);
    }

    forceSave(store) {
        const stores = this.storeToJson();
        stores.push(store);
        this.jsonToStore(stores);
    }

    remove(id) {
        const stores = this.storeToJson();
        let index = null;
        for (let i = 0; i < stores.length; i++) {
            if (stores[i].id === id) {
                index = i;
                break;
            }
        }
        stores.splice(index, 1);
        this.jsonToStore(stores);
    }

    getByID(id) {
        const stores = this.storeToJson();
        let index = null;
        for (let i = 0; i < stores.length; i++) {
          if (stores[i].id === id) {
            index = i;
            break;
          }
        }

        const store = stores.find(s => s.id === id);
        return store;
    }

    getAll() {
        return this.storeToJson();
    }

    removeAll() {
        this.jsonToStore([]);
    }
}

module.exports = LocalStore

},{}],4:[function(require,module,exports){
const fetchArticleHighlightsFromAPI = require('../fetch-article-highlights-from-api')
const textHighlight = require('../text-highlight')
const { respond_comment, post_comment } = require('../comments')

const comment_forms = document.querySelectorAll( '.comment_form' )
for ( const comment_form of comment_forms ) {
  comment_form.onsubmit = respond_comment
}

// synchronize text-highlights backend data with localStorage
const article_slug = window.location.pathname.split('/').pop().split('/').join('+')

;(async() => {
  await fetchArticleHighlightsFromAPI(article_slug)
})()

const article_element    = document.querySelector( 'main' )
const selection_toolbar  = document.querySelector( '.toolbar' )
const textRange = textHighlight(article_element, selection_toolbar)

},{"../comments":1,"../fetch-article-highlights-from-api":2,"../text-highlight":5}],5:[function(require,module,exports){
const Highlighter = require('web-highlighter')
const LocalStore = require('./local.store')
const {
  respond_comment,
  make_comment_el,
  make_comment_thread_el,
  make_comment_form_el,
} = require('./comments.js')

// <https://github.com/alienzhou/web-highlighter/blob/master/example/index.js>
function textHighlight(target, toolbar) {
  const highlighter = new Highlighter({
    wrapTag: 'span',
    exceptSelectors: ['.highlight-tip']
  })

  highlighter.setOption({
    style: {
      className: 'bgc-accent',
    },
  })

  const store = new LocalStore();

  // restore all highlights to Highlighter instance
  store.getAll().forEach(hs => {
    highlighter.fromStore(hs.startMeta, hs.endMeta, hs.text, hs.id)
  });

  // except for the CREATE event
  // any other event is triggered when interacting
  // with an existing selection span
  highlighter
    .on(Highlighter.event.CLICK, ({id}) => {
      console.log('click -', id);
    })
    .on(Highlighter.event.HOVER, ({id}) => {
      console.log('hover -', id);
      highlighter.addClass('highlight-wrap-hover', id);
    })
    .on(Highlighter.event.HOVER_OUT, ({id}) => {
      console.log('hover out -', id);
      highlighter.removeClass('highlight-wrap-hover', id);
    })
    .on(Highlighter.event.CREATE, ({sources}) => {

      // // create span to allow removing the selection
      // sources.forEach(s => {
      //   const position = getPosition(highlighter.getDoms(s.id)[0]);
      //   createTag(position.top, position.left, s.id);
      // });

      // what to do if sources is > 1 and we need to position the comment toolbar?
      // pick last source in the list?
      if ( sources.length ) {
        let source = sources[0]
        const selectionNode = highlighter.getDoms(source.id)[0]
        const block         = selectionNode.closest( 'section .block' )
        const block_id      = getBlockID( block )
        const aside         = block.querySelector( 'aside' )
        const template_form = aside.querySelector( '.thread form' )
        const form          = make_comment_form_el( template_form, source.id, block_id )
        const position      = get_position(selectionNode)
        const thread        = make_comment_thread_el( form, position )
        aside.appendChild( thread )
        form.firstElementChild.focus()
        // toggle_toolbar(position, toolbar, source.id, block_id)
        store.save(sources)
      }

    })
    .on(Highlighter.event.REMOVE, ({ids}) => {
      // TODO implement remove action
      console.log('remove -', ids);
      // ids.forEach(id => store.remove(id));
    });

  highlighter.run();
}

function getBlockID( block ) {
  if (block !== undefined && block !== null) {
    if (block.id) {
      return block.id
    }
  }

  return ''
}

const createTag = (top, left, id) => {
  const $span = document.createElement('span');
  $span.style.left = `${left - 20}px`;
  $span.style.top = `${top - 25}px`;
  $span.style.position = 'absolute';
  $span.dataset['id'] = id;
  $span.textContent = 'delete';
  $span.classList.add('highlight-tip');
  document.body.appendChild($span);
  console.log('create-tag =>', $span)
};

function toggle_toolbar(position, toolbar, sourceID, blockID) {
  const form = toolbar.querySelector('form')
  form.setAttribute('data-block-selection-type', 'text')
  form.setAttribute('data-block-selection-text-id', sourceID)
  form.setAttribute('data-block-id', blockID)

  toolbar.classList.remove( 'hidden' )

  toolbar.style.setProperty( '--top', position.top + 'px' )
  toolbar.style.setProperty( '--left', position.left + 'px' )
}

// <https://github.com/alienzhou/web-highlighter/blob/master/example/index.js#L55-L67>
function getPosition($node) {
  let offset = {
    top: 0,
    left: 0
  };
  while ($node) {
    offset.top += $node.offsetTop;
    offset.left += $node.offsetLeft;
    $node = $node.offsetParent;
  }
  return offset;
}


function get_position(node) {
  let offset = {
    top: 0,
    left: 0
  };

  offset.top += node.parentNode.getBoundingClientRect().top + document.documentElement.scrollTop
  offset.left += node.getBoundingClientRect().left + document.documentElement.scrollLeft

  return offset;
}

function update_form(blockInfo) {
  let form = document.querySelector('.toolbar form')
  form.dataset.blockId = blockInfo.id
  form.dataset.blockSelectionType = blockInfo.type
}

module.exports = textHighlight;

},{"./comments.js":1,"./local.store":3,"web-highlighter":7}],6:[function(require,module,exports){
const LocalStore = require('./local.store')

function textHighlightMergeUnique(newData) {
  // merge this array of text-highlights
  // w/ current localStorage['combo-highlight']
  const store = new LocalStore();
  let localStore = store.getAll();

  // <https://stackoverflow.com/a/54134237>
  const ids = new Set(localStore.map(d => d.id));
  const highlightsMerged = [...localStore, ...newData.filter(d => !ids.has(d.ID))];

  // the save function checksif the item
  // exists already, so we just pass
  // the entire dataset
  store.save(highlightsMerged)

}

module.exports = textHighlightMergeUnique

},{"./local.store":3}],7:[function(require,module,exports){
/*! web-highlighter v0.7.4 https://github.com/alienzhou/web-highlighter */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Highlighter=t():e.Highlighter=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.eventEmitter=t.INTERNAL_ERROR_EVENT=t.UNKNOWN_IDX=t.ROOT_IDX=t.getStylesheet=t.getDefaultOptions=t.CAMEL_DATASET_SPLIT_TYPE=t.CAMEL_DATASET_IDENTIFIER_EXTRA=t.CAMEL_DATASET_IDENTIFIER=t.DATASET_SPLIT_TYPE=t.DATASET_IDENTIFIER_EXTRA=t.DATASET_IDENTIFIER=t.STYLESHEET_ID=t.LOCAL_STORE_KEY=t.ID_DIVISION=void 0;var a=i(n(10)),l=i(n(2));t.ID_DIVISION=";",t.LOCAL_STORE_KEY="highlight-mengshou",t.STYLESHEET_ID="highlight-mengshou-style",t.DATASET_IDENTIFIER="highlight-id",t.DATASET_IDENTIFIER_EXTRA="highlight-id-extra",t.DATASET_SPLIT_TYPE="highlight-split-type",t.CAMEL_DATASET_IDENTIFIER=a.default(t.DATASET_IDENTIFIER),t.CAMEL_DATASET_IDENTIFIER_EXTRA=a.default(t.DATASET_IDENTIFIER_EXTRA),t.CAMEL_DATASET_SPLIT_TYPE=a.default(t.DATASET_SPLIT_TYPE);t.getDefaultOptions=function(){return{$root:document||document.documentElement,exceptSelectors:null,wrapTag:"span",verbose:!1,style:{className:"highlight-mengshou-wrap"}}};t.getStylesheet=function(){return"\n    ."+t.getDefaultOptions().style.className+" {\n        background: #ff9;\n        cursor: pointer;\n    }\n    ."+t.getDefaultOptions().style.className+".active {\n        background: #ffb;\n    }\n"},t.ROOT_IDX=-2,t.UNKNOWN_IDX=-1,t.INTERNAL_ERROR_EVENT="error";var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(l.default);t.eventEmitter=new u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserInputEvent=t.SelectedNodeType=t.CreateFrom=t.EventType=t.ERROR=t.SplitType=void 0,function(e){e.none="none",e.head="head",e.tail="tail",e.both="both"}(t.SplitType||(t.SplitType={})),function(e){e.DOM_TYPE_ERROR="[DOM] Receive wrong node type.",e.DOM_SELECTION_EMPTY="[DOM] The selection contains no dom node, may be you except them.",e.RANGE_INVALID="[RANGE] Got invalid dom range, can't convert to a valid highlight range.",e.RANGE_NODE_INVALID="[RANGE] Start or end node isn't a text node, it may occur an error.",e.DB_ID_DUPLICATE_ERROR="[STORE] Unique id conflict.",e.CACHE_SET_ERROR="[CACHE] Cache.data can't be set manually, please use .save().",e.SOURCE_TYPE_ERROR="[SOURCE] Object isn't a highlight source instance.",e.HIGHLIGHT_RANGE_FROZEN="[HIGHLIGHT_RANGE] A highlight range must be frozen before render.",e.HIGHLIGHT_SOURCE_RECREATE="[HIGHLIGHT_SOURCE] Recreate highlights from sources error.",e.HIGHLIGHT_SOURCE_NONE_RENDER="[HIGHLIGHT_SOURCE] This highlight source isn't rendered. May be the exception skips it or the dom structure has changed."}(t.ERROR||(t.ERROR={})),function(e){e.CREATE="selection:create",e.REMOVE="selection:remove",e.MODIFY="selection:modify",e.HOVER="selection:hover",e.HOVER_OUT="selection:hover-out",e.CLICK="selection:click"}(t.EventType||(t.EventType={})),function(e){e.STORE="from-store",e.INPUT="from-input"}(t.CreateFrom||(t.CreateFrom={})),function(e){e.text="text",e.span="span"}(t.SelectedNodeType||(t.SelectedNodeType={})),function(e){e.touchend="touchend",e.mouseup="mouseup",e.touchstart="touchstart",e.click="click",e.mouseover="mouseover"}(t.UserInputEvent||(t.UserInputEvent={}))},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.handlersMap=Object.create(null)}return e.prototype.on=function(e,t){return this.handlersMap[e]||(this.handlersMap[e]=[]),this.handlersMap[e].push(t),this},e.prototype.off=function(e,t){return this.handlersMap[e]&&this.handlersMap[e].splice(this.handlersMap[e].indexOf(t)>>>0,1),this},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.handlersMap[e]&&this.handlersMap[e].slice().forEach((function(e){e.apply(void 0,o(t))})),this},e}();t.default=i},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(5)),i=n(9),a=function(){function e(e,t,n,r,o){this.startMeta=e,this.endMeta=t,this.text=n,this.id=r,this.__isHighlightSource={},o&&(this.extra=o)}return e.prototype.deSerialize=function(e,t){var n=i.queryElementNode(this,e),r=n.start,a=n.end,l=i.getTextChildByOffset(r,this.startMeta.textOffset),u=i.getTextChildByOffset(a,this.endMeta.textOffset);if(!t.Serialize.Restore.isEmpty()){var s=t.Serialize.Restore.call(this,l,u)||[];l=s[0]||l,u=s[1]||u}return new o.default(l,u,this.text,this.id,!0)},e}();t.default=a},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.hasClass=t.removeAllClass=t.removeClass=t.addClass=t.addEventListener=t.removeEventListener=t.forEach=t.getHighlightById=t.getHighlightsByRoot=t.getExtraHighlightId=t.getHighlightId=t.isHighlightWrapNode=void 0;var a=n(0);t.isHighlightWrapNode=function(e){return!!e.dataset&&!!e.dataset[a.CAMEL_DATASET_IDENTIFIER]};var l=function(e,n){for(var r=!1,o=null;e;){if(t.isHighlightWrapNode(e)&&(o=e),e===n){r=!0;break}e=e.parentNode}return r?o:null};t.getHighlightId=function(e,t){return(e=l(e,t))?e.dataset[a.CAMEL_DATASET_IDENTIFIER]:""};t.getExtraHighlightId=function(e,t){return(e=l(e,t))?e.dataset[a.CAMEL_DATASET_IDENTIFIER_EXTRA].split(a.ID_DIVISION).filter((function(e){return e})):[]};t.getHighlightsByRoot=function(e,t){var n,o;Array.isArray(e)||(e=[e]);var i=[];try{for(var l=r(e),u=l.next();!u.done;u=l.next()){var s=u.value.querySelectorAll(t+"[data-"+a.DATASET_IDENTIFIER+"]");i.push.apply(i,s)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}return i};t.getHighlightById=function(e,t,n){var o,i,l=[],u=new RegExp("("+t+"\\"+a.ID_DIVISION+"|\\"+a.ID_DIVISION+"?"+t+"$)"),s=e.querySelectorAll(n+"[data-"+a.DATASET_IDENTIFIER+"]");try{for(var d=r(s),c=d.next();!c.done;c=d.next()){var f=c.value;if(f.dataset[a.CAMEL_DATASET_IDENTIFIER]!==t){var h=f.dataset[a.CAMEL_DATASET_IDENTIFIER_EXTRA];u.test(h)&&l.push(f)}else l.push(f)}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}return l};t.forEach=function(e,t){for(var n=0;n<e.length;n++)t(e[n],n,e)};t.removeEventListener=function(e,t,n){e.removeEventListener(t,n)};t.addEventListener=function(e,n,r){return e.addEventListener(n,r),function(){t.removeEventListener(e,n,r)}};t.addClass=function(e,t){var n;Array.isArray(t)||(t=[t]),(n=e.classList).add.apply(n,i(t))};t.removeClass=function(e,t){e.classList.remove(t)};t.removeAllClass=function(e){e.className=""};t.hasClass=function(e,t){return e.classList.contains(t)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(3)),i=n(1),a=n(11),l=r(n(6)),u=n(12),s=n(0),d=function(){function e(e,t,n,r,o){void 0===o&&(o=!1),3===e.$node.nodeType&&3===t.$node.nodeType||s.eventEmitter.emit(s.INTERNAL_ERROR_EVENT,{type:i.ERROR.RANGE_NODE_INVALID}),this.start=u.formatDomNode(e),this.end=u.formatDomNode(t),this.text=n,this.frozen=o,this.id=r}return e.fromSelection=function(t){var n=a.getDomRange();if(!n)return null;var r={$node:n.startContainer,offset:n.startOffset},o={$node:n.endContainer,offset:n.endOffset},i=n.toString(),u=t.call(r,o,i);return new e(r,o,i,u=null!=u?u:l.default())},e.prototype.serialize=function(e,t){var n,r=u.getDomMeta(this.start.$node,this.start.offset,e),i=u.getDomMeta(this.end.$node,this.end.offset,e);return t.Serialize.RecordInfo.isEmpty()||(n=t.Serialize.RecordInfo.call(this.start,this.end,e)),this.frozen=!0,new o.default(r,i,this.text,this.id,n)},e.removeDomRange=a.removeSelection,e}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)}},function(e,t,n){e.exports=n(8)},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=a(n(2)),u=a(n(5)),s=a(n(3)),d=a(n(6)),c=a(n(13)),f=a(n(14)),h=a(n(16)),p=a(n(17)),E=n(0),_=n(1),v=n(4),T=function(e){function t(t){var n=e.call(this)||this;n.event=f.default(),n.run=function(){return v.addEventListener(n.options.$root,n.event.PointerEnd,n._handleSelection)},n.stop=function(){v.removeEventListener(n.options.$root,n.event.PointerEnd,n._handleSelection)},n.addClass=function(e,t){n.getDoms(t).forEach((function(t){v.addClass(t,e)}))},n.removeClass=function(e,t){n.getDoms(t).forEach((function(t){v.removeClass(t,e)}))},n.getIdByDom=function(e){return v.getHighlightId(e,n.options.$root)},n.getExtraIdByDom=function(e){return v.getExtraHighlightId(e,n.options.$root)},n.getDoms=function(e){return e?v.getHighlightById(n.options.$root,e,n.options.wrapTag):v.getHighlightsByRoot(n.options.$root,n.options.wrapTag)},n.dispose=function(){var e=n.options.$root;v.removeEventListener(e,n.event.PointerOver,n._handleHighlightHover),v.removeEventListener(e,n.event.PointerEnd,n._handleSelection),v.removeEventListener(e,n.event.PointerTap,n._handleHighlightClick),n.removeAll()},n.setOption=function(e){n.options=i(i({},n.options),e),n.painter=new p.default({$root:n.options.$root,wrapTag:n.options.wrapTag,className:n.options.style.className,exceptSelectors:n.options.exceptSelectors},n.hooks)},n.fromRange=function(e){var t={$node:e.startContainer,offset:e.startOffset},r={$node:e.endContainer,offset:e.endOffset},o=e.toString(),i=n.hooks.Render.UUID.call(t,r,o);i=null!=i?i:d.default();var a=new u.default(t,r,o,i);return a?n._highlightFromHRange(a):(E.eventEmitter.emit(E.INTERNAL_ERROR_EVENT,{type:_.ERROR.RANGE_INVALID}),null)},n.fromStore=function(e,t,r,o,i){var a=new s.default(e,t,r,o,i);try{return n._highlightFromHSource(a),a}catch(e){return E.eventEmitter.emit(E.INTERNAL_ERROR_EVENT,{type:_.ERROR.HIGHLIGHT_SOURCE_RECREATE,error:e,detail:a}),null}},n._getHooks=function(){return{Render:{UUID:new c.default("Render.UUID"),SelectedNodes:new c.default("Render.SelectedNodes"),WrapNode:new c.default("Render.WrapNode")},Serialize:{Restore:new c.default("Serialize.Restore"),RecordInfo:new c.default("Serialize.RecordInfo")},Remove:{UpdateNodes:new c.default("Remove.UpdateNodes")}}},n._highlightFromHRange=function(e){var t=e.serialize(n.options.$root,n.hooks);return 0===n.painter.highlightRange(e).length?(E.eventEmitter.emit(E.INTERNAL_ERROR_EVENT,{type:_.ERROR.DOM_SELECTION_EMPTY}),null):(n.cache.save(t),n.emit(_.EventType.CREATE,{sources:[t],type:_.CreateFrom.INPUT},n),t)},n._handleSelection=function(){var e=u.default.fromSelection(n.hooks.Render.UUID);e&&(n._highlightFromHRange(e),u.default.removeDomRange())},n._handleHighlightHover=function(e){var t=e.target;if(!v.isHighlightWrapNode(t))return n._hoverId&&n.emit(_.EventType.HOVER_OUT,{id:n._hoverId},n,e),void(n._hoverId=null);var r=v.getHighlightId(t,n.options.$root);n._hoverId!==r&&(n._hoverId&&n.emit(_.EventType.HOVER_OUT,{id:n._hoverId},n,e),n._hoverId=r,n.emit(_.EventType.HOVER,{id:n._hoverId},n,e))},n._handleError=function(e){n.options.verbose&&console.warn(e)},n._handleHighlightClick=function(e){var t=e.target;if(v.isHighlightWrapNode(t)){var r=v.getHighlightId(t,n.options.$root);n.emit(_.EventType.CLICK,{id:r},n,e)}},n.options=E.getDefaultOptions(),n.hooks=n._getHooks(),n.setOption(t),n.cache=new h.default;var r=n.options.$root;return v.addEventListener(r,n.event.PointerOver,n._handleHighlightHover),v.addEventListener(r,n.event.PointerTap,n._handleHighlightClick),E.eventEmitter.on(E.INTERNAL_ERROR_EVENT,n._handleError),n}return o(t,e),t.prototype.remove=function(e){if(e){var t=this.painter.removeHighlight(e);this.cache.remove(e),t&&this.emit(_.EventType.REMOVE,{ids:[e]},this)}},t.prototype.removeAll=function(){this.painter.removeAllHighlight();var e=this.cache.removeAll();this.emit(_.EventType.REMOVE,{ids:e},this)},t.prototype._highlightFromHSource=function(e){void 0===e&&(e=[]);var t=this.painter.highlightSource(e);this.emit(_.EventType.CREATE,{sources:t,type:_.CreateFrom.STORE},this),this.cache.save(e)},t.event=_.EventType,t.isHighlightWrapNode=v.isHighlightWrapNode,t.isHighlightSource=function(e){return!!e.__isHighlightSource},t}(l.default);t.default=T},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryElementNode=t.getTextChildByOffset=void 0;var r=n(0);t.getTextChildByOffset=function(e,t){for(var n=[e],r=null,o=0,i=0;r=n.pop();){for(var a=r.childNodes,l=a.length-1;l>=0;l--)n.push(a[l]);if(3===r.nodeType&&(i=t-o,(o+=r.textContent.length)>=t))break}return r||(r=e),{$node:r,offset:i}};t.queryElementNode=function(e,t){return{start:e.startMeta.parentIndex===r.ROOT_IDX?t:t.getElementsByTagName(e.startMeta.parentTagName)[e.startMeta.parentIndex],end:e.endMeta.parentIndex===r.ROOT_IDX?t:t.getElementsByTagName(e.endMeta.parentTagName)[e.endMeta.parentIndex]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.split("-").reduce((function(e,t,n){return e+(0===n?t:t[0].toUpperCase()+t.slice(1))}),"")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeSelection=t.getDomRange=void 0;t.getDomRange=function(){var e=window.getSelection();return e.isCollapsed?(console.debug("no text selected"),null):e.getRangeAt(0)};t.removeSelection=function(){window.getSelection().removeAllRanges()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatDomNode=t.getDomMeta=void 0;var r=n(0);t.getDomMeta=function(e,t,n){var o=function(e){if(e instanceof HTMLElement&&(!e.dataset||!e.dataset[r.CAMEL_DATASET_IDENTIFIER]))return e;for(var t=e.parentNode;null==t?void 0:t.dataset[r.CAMEL_DATASET_IDENTIFIER];)t=t.parentNode;return t}(e),i=o===n?r.ROOT_IDX:function(e,t){for(var n=e.tagName,o=t.getElementsByTagName(n),i=0;i<o.length;i++)if(e===o[i])return i;return r.UNKNOWN_IDX}(o,n),a=function(e,t){for(var n=[e],r=null,o=0;r=n.pop();){for(var i=r.childNodes,a=i.length-1;a>=0;a--)n.push(i[a]);if(3===r.nodeType&&r!==t)o+=r.textContent.length;else if(3===r.nodeType)break}return o}(o,e);return{parentTagName:o.tagName,parentIndex:i,textOffset:a+t}};t.formatDomNode=function(e){return 3===e.$node.nodeType||4===e.$node.nodeType||8===e.$node.nodeType?e:{$node:e.$node.childNodes[e.offset],offset:0}}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.name="",this.ops=[],this.name=e}return e.prototype.tap=function(e){var t=this;return-1===this.ops.indexOf(e)&&this.ops.push(e),function(){t.remove(e)}},e.prototype.remove=function(e){var t=this.ops.indexOf(e);t<0||this.ops.splice(t,1)},e.prototype.isEmpty=function(){return 0===this.ops.length},e.prototype.call=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.ops.forEach((function(n){e=n.apply(void 0,o(t))})),e},e}();t.default=i},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=r(n(15));t.default=function(){var e=i.default(window.navigator.userAgent);return{PointerEnd:e?o.UserInputEvent.touchend:o.UserInputEvent.mouseup,PointerTap:e?o.UserInputEvent.touchstart:o.UserInputEvent.click,PointerOver:e?o.UserInputEvent.touchstart:o.UserInputEvent.mouseover}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/Android|iPhone|BlackBerry|BB10|Opera Mini|Phone|Mobile|Silk|Windows Phone|Mobile(?:.+)Firefox\b/i;t.default=function(e){return r.test(e)}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=a(n(2)),u=n(1),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._data=new Map,t}return o(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.getAll()},set:function(e){throw u.ERROR.CACHE_SET_ERROR},enumerable:!1,configurable:!0}),t.prototype.save=function(e){var t=this;Array.isArray(e)?e.forEach((function(e){return t._data.set(e.id,e)})):this._data.set(e.id,e)},t.prototype.get=function(e){return this._data.get(e)},t.prototype.remove=function(e){this._data.delete(e)},t.prototype.getAll=function(){var e,t,n=[];try{for(var r=i(this._data),o=r.next();!o.done;o=r.next()){var a=o.value;n.push(a[1])}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},t.prototype.removeAll=function(){var e,t,n=[];try{for(var r=i(this._data),o=r.next();!o.done;o=r.next()){var a=o.value;n.push(a[0])}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return this._data=new Map,n},t}(l.default);t.default=s},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=a(n(3)),u=n(18),s=n(4),d=n(1),c=n(20),f=n(0),h=function(){function e(e,t){this.options={$root:e.$root,wrapTag:e.wrapTag,exceptSelectors:e.exceptSelectors,className:e.className},this.hooks=t,c.initDefaultStylesheet()}return e.prototype.highlightRange=function(e){var t=this;if(!e.frozen)throw d.ERROR.HIGHLIGHT_RANGE_FROZEN;var n=this.options,r=n.$root,o=n.className,i=n.exceptSelectors,a=this.hooks,l=u.getSelectedNodes(r,e.start,e.end,i);return a.Render.SelectedNodes.isEmpty()||(l=a.Render.SelectedNodes.call(e.id,l)||[]),l.map((function(n){var r=u.wrapHighlight(n,e,o,t.options.wrapTag);return a.Render.WrapNode.isEmpty()||(r=a.Render.WrapNode.call(e.id,r)),r}))},e.prototype.highlightSource=function(e){var t=this,n=Array.isArray(e)?e:[e],r=[];return n.forEach((function(e){if(e instanceof l.default){var n=e.deSerialize(t.options.$root,t.hooks);t.highlightRange(n).length>0?r.push(e):f.eventEmitter.emit(f.INTERNAL_ERROR_EVENT,{type:d.ERROR.HIGHLIGHT_SOURCE_NONE_RENDER,detail:e})}else f.eventEmitter.emit(f.INTERNAL_ERROR_EVENT,{type:d.ERROR.SOURCE_TYPE_ERROR})})),r},e.prototype.removeHighlight=function(e){var t,n,o=new RegExp("("+e+"\\"+f.ID_DIVISION+"|\\"+f.ID_DIVISION+"?"+e+"$)"),a=this.hooks,l=this.options.wrapTag,d=document.querySelectorAll(l+"[data-"+f.DATASET_IDENTIFIER+"]"),c=[],h=[],p=[];try{for(var E=r(d),_=E.next();!_.done;_=E.next()){var v=_.value,T=v.dataset[f.CAMEL_DATASET_IDENTIFIER],y=v.dataset[f.CAMEL_DATASET_IDENTIFIER_EXTRA];T!==e||y?T===e?h.push(v):T!==e&&o.test(y)&&p.push(v):c.push(v)}}catch(e){t={error:e}}finally{try{_&&!_.done&&(n=E.return)&&n.call(E)}finally{if(t)throw t.error}}return c.forEach((function(t){var n=t.parentNode,r=document.createDocumentFragment();s.forEach(t.childNodes,(function(e){return r.appendChild(e.cloneNode(!1))}));var o=t.previousSibling,i=t.nextSibling;n.replaceChild(r,t),u.normalizeSiblingText(o,!0),u.normalizeSiblingText(i,!1),a.Remove.UpdateNodes.call(e,t,"remove")})),h.forEach((function(t){var n=t.dataset,r=n[f.CAMEL_DATASET_IDENTIFIER_EXTRA].split(f.ID_DIVISION),o=r.shift(),u=document.querySelector(l+"[data-"+f.DATASET_IDENTIFIER+'="'+o+'"]');u&&(s.removeAllClass(t),s.addClass(t,i(u.classList))),n[f.CAMEL_DATASET_IDENTIFIER]=o,n[f.CAMEL_DATASET_IDENTIFIER_EXTRA]=r.join(f.ID_DIVISION),a.Remove.UpdateNodes.call(e,t,"id-update")})),p.forEach((function(t){var n=t.dataset[f.CAMEL_DATASET_IDENTIFIER_EXTRA];t.dataset[f.CAMEL_DATASET_IDENTIFIER_EXTRA]=n.replace(o,""),a.Remove.UpdateNodes.call(e,t,"extra-update")})),c.length+h.length+p.length!==0},e.prototype.removeAllHighlight=function(){var e=this.options,t=e.wrapTag,n=e.$root;s.getHighlightsByRoot(n,t).forEach((function(e){var t=e.parentNode,n=document.createDocumentFragment();s.forEach(e.childNodes,(function(e){return n.appendChild(e.cloneNode(!1))})),t.replaceChild(n,e)}))},e}();t.default=h},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeSiblingText=t.wrapHighlight=t.getSelectedNodes=void 0;var i=n(1),a=n(4),l=n(0),u=n(19),s=function(e,t){if(!e)return!1;if(/^\./.test(t)){var n=t.replace(/^\./,"");return e&&a.hasClass(e,n)}if(/^#/.test(t)){var r=t.replace(/^#/,"");return e&&e.id===r}var o=t.toUpperCase();return e&&e.tagName===o};t.getSelectedNodes=function(e,t,n,r){var o=t.$node,a=n.$node,l=t.offset,u=n.offset;if(o===a&&o instanceof Text)return function(e,t,n,r){for(var o=e,a=function(e){return null==r?void 0:r.some((function(t){return s(e,t)}))};o;){if(1===o.nodeType&&a(o))return[];o=o.parentNode}e.splitText(t);var l=e.nextSibling;return l.splitText(n-t),[{$node:l,type:i.SelectedNodeType.text,splitType:i.SplitType.both}]}(o,l,u,r);for(var d=[e],c=[],f=function(e){return null==r?void 0:r.some((function(t){return s(e,t)}))},h=!1,p=null;p=d.pop();)if(1!==p.nodeType||!f(p)){for(var E=p.childNodes,_=E.length-1;_>=0;_--)d.push(E[_]);if(p===o){if(3===p.nodeType){p.splitText(l);var v=p.nextSibling;c.push({$node:v,type:i.SelectedNodeType.text,splitType:i.SplitType.head})}h=!0}else{if(p===a){if(3===p.nodeType)(v=p).splitText(u),c.push({$node:v,type:i.SelectedNodeType.text,splitType:i.SplitType.tail});break}h&&3===p.nodeType&&c.push({$node:p,type:i.SelectedNodeType.text,splitType:i.SplitType.none})}}return c};var d=function(e,t){var n=Array.isArray(t)?t:[t];return(n=0===n.length?[l.getDefaultOptions().style.className]:n).forEach((function(t){a.addClass(e,t)})),e},c=function(e){return!e||!e.textContent};t.wrapHighlight=function(e,t,n,r){var s=e.$node.parentNode,f=e.$node.previousSibling,h=e.$node.nextSibling;return a.isHighlightWrapNode(s)?!a.isHighlightWrapNode(s)||c(f)&&c(h)?function(e,t,n){var r=e.$node.parentNode,o=r;a.removeAllClass(o),d(o,n);var i=r.dataset,u=i[l.CAMEL_DATASET_IDENTIFIER];return i[l.CAMEL_DATASET_IDENTIFIER]=t.id,i[l.CAMEL_DATASET_IDENTIFIER_EXTRA]=i[l.CAMEL_DATASET_IDENTIFIER_EXTRA]?u+l.ID_DIVISION+i[l.CAMEL_DATASET_IDENTIFIER_EXTRA]:u,o}(e,t,n):function(e,t,n,r){var a=document.createElement(r),s=e.$node.parentNode,c=e.$node.previousSibling,f=e.$node.nextSibling,h=document.createDocumentFragment(),p=s.dataset[l.CAMEL_DATASET_IDENTIFIER],E=s.dataset[l.CAMEL_DATASET_IDENTIFIER_EXTRA],_=E?p+l.ID_DIVISION+E:p;a.setAttribute("data-"+l.DATASET_IDENTIFIER,t.id),a.setAttribute("data-"+l.DATASET_IDENTIFIER_EXTRA,_),a.appendChild(e.$node.cloneNode(!1));var v,T=!1,y=!1;c&&((g=s.cloneNode(!1)).textContent=c.textContent,h.appendChild(g),T=!0);var g,I=[];(Array.isArray(n)?I.push.apply(I,o(n)):I.push(n),d(a,u.unique(I)),h.appendChild(a),f)&&((g=s.cloneNode(!1)).textContent=f.textContent,h.appendChild(g),y=!0);return v=T&&y?i.SplitType.both:T?i.SplitType.head:y?i.SplitType.tail:i.SplitType.none,a.setAttribute("data-"+l.DATASET_SPLIT_TYPE,v),s.parentNode.replaceChild(h,s),a}(e,t,n,r):function(e,t,n,r){var o=document.createElement(r);return d(o,n),o.appendChild(e.$node.cloneNode(!1)),e.$node.parentNode.replaceChild(o,e.$node),o.setAttribute("data-"+l.DATASET_IDENTIFIER,t.id),o.setAttribute("data-"+l.DATASET_SPLIT_TYPE,e.splitType),o.setAttribute("data-"+l.DATASET_IDENTIFIER_EXTRA,""),o}(e,t,n,r)};t.normalizeSiblingText=function(e,t){if(void 0===t&&(t=!0),e&&3===e.nodeType){var n=t?e.nextSibling:e.previousSibling;if(3===n.nodeType){var r=n.nodeValue;e.nodeValue=t?e.nodeValue+r:r+e.nodeValue,n.parentNode.removeChild(n)}}}},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.unique=void 0;t.unique=function(e){var t,n,o=[];try{for(var i=r(e),a=i.next();!a.done;a=i.next()){var l=a.value;-1===o.indexOf(l)&&o.push(l)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initDefaultStylesheet=void 0;var r=n(0);t.initDefaultStylesheet=function(){var e=r.STYLESHEET_ID,t=document.getElementById(e);if(!t){var n=document.createTextNode(r.getStylesheet());(t=document.createElement("style")).id=e,t.appendChild(n),document.head.appendChild(t)}return t}}]).default}));

},{}]},{},[4])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhc3NldHMvanMvY29tbWVudHMuanMiLCJhc3NldHMvanMvZmV0Y2gtYXJ0aWNsZS1oaWdobGlnaHRzLWZyb20tYXBpLmpzIiwiYXNzZXRzL2pzL2xvY2FsLnN0b3JlLmpzIiwiYXNzZXRzL2pzL3RlbXBsYXRlcy9hcnRpY2xlLmpzIiwiYXNzZXRzL2pzL3RleHQtaGlnaGxpZ2h0LmpzIiwiYXNzZXRzL2pzL3RleHQtaGlnaGxpZ2h0cy1tZXJnZS11bmlxdWUuanMiLCJub2RlX21vZHVsZXMvd2ViLWhpZ2hsaWdodGVyL2Rpc3Qvd2ViLWhpZ2hsaWdodGVyLm1pbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BCQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJjb25zdCBMb2NhbFN0b3JlID0gcmVxdWlyZSgnLi9sb2NhbC5zdG9yZScpXG5jb25zdCBzdG9yZSA9IG5ldyBMb2NhbFN0b3JlKClcblxuZnVuY3Rpb24gcmVzcG9uZF9jb21tZW50KCBlICkge1xuICBlLnByZXZlbnREZWZhdWx0KClcbiAgY29uc3QgZm9ybSAgICA9IGUudGFyZ2V0XG4gIGNvbnN0IGNvbW1lbnQgPSBtYWtlX2NvbW1lbnQoIGZvcm0sIHN0b3JlIClcbiAgcG9zdF9jb21tZW50KCBjb21tZW50IClcbiAgLnRoZW4oIHJlc3BvbnNlID0+IHtcbiAgICBpZiAoIHJlc3BvbnNlLnN0YXR1cyA9PT0gJ29rJyApIHtcblxuICAgICAgLy8gZm9ybTogcmVzZXQgYW5kIGhpZGUgZm9ybVxuICAgICAgZm9ybS5yZXNldCgpXG4gICAgICBmb3JtLmJsdXIoKVxuXG4gICAgICAvLyBjcmVhdGUgbmV3bHkgcG9zdGVkIGNvbW1lbnRcbiAgICAgIGNvbnN0IGFydGljbGUgPSBtYWtlX2NvbW1lbnRfZWwoIHJlc3BvbnNlLmRhdGEgKVxuXG4gICAgICAvLyBhcHBlbmQgbmV3IGNvbW1lbnQgdG8gY29tbWVudCB0aHJlYWRcbiAgICAgIC8vIGJlZm9yZSA8Zm9ybT4gKGJsdWUgY2lyY2xlKVxuXG4gICAgICBsZXQgdGhyZWFkXG5cbiAgICAgIC8vIGZpcnN0IGNoZWNrIGlmIHRoZSBmb3JtIGlzIHRoZSB0b29sYmFyIGZvcm1cbiAgICAgIGNvbnN0IGZvcm1fcGFyZW50ID0gZm9ybS5wYXJlbnROb2RlXG4gICAgICBpZiAoIGZvcm1fcGFyZW50LmNsYXNzTGlzdC5jb250YWlucyggJ3Rvb2xiYXInICkgKSB7XG4gICAgICAgIC8vIG1ha2UgYSBuZXcgY29tbWVudCB0aHJlYWQgZm9yIHRoaXMgYmxvY2tcbiAgICAgICAgdGhyZWFkID0gbWFrZV9jb21tZW50X3RocmVhZF9lbCggZm9ybS5jbG9uZU5vZGUoIHRydWUgKSApXG4gICAgICAgIGNvbnN0IGJsb2NrX2lkID0gZm9ybS5nZXRBdHRyaWJ1dGUoICdkYXRhLWJsb2NrLWlkJyApXG4gICAgICAgIGNvbnN0IGJsb2NrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIGJsb2NrX2lkIClcbiAgICAgICAgY29uc3QgYXNpZGUgPSBibG9jay5xdWVyeVNlbGVjdG9yKCAnYXNpZGUnIClcbiAgICAgICAgY29uc3QgdGhyZWFkX2Zvcm0gPSBBcnJheS5mcm9tKCB0aHJlYWQuY2hpbGRyZW4gKVswXVxuICAgICAgICB0aHJlYWQuaW5zZXJ0QmVmb3JlKCBhcnRpY2xlLCB0aHJlYWRfZm9ybSApXG4gICAgICAgIGFzaWRlLmFwcGVuZENoaWxkKCB0aHJlYWQgKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyZWFkID0gZm9ybV9wYXJlbnRcbiAgICAgICAgdGhyZWFkLmluc2VydEJlZm9yZShhcnRpY2xlLCBmb3JtKVxuICAgICAgfVxuXG4gICAgICAvLyB1cGRhdGUgY29tbWVudCBjb3VudFxuICAgICAgY29uc3QgY29tbWVudF9jb3VudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjb21tZW50X2NvdW50JylcbiAgICAgIGNvbW1lbnRfY291bnQuaW5uZXJIVE1MID0gbmV3IE51bWJlciggY29tbWVudF9jb3VudC5pbm5lckhUTUwgKSArIDFcblxuICAgICAgYXJ0aWNsZS5mb2N1cygpXG5cbiAgICB9XG4gIH0pXG59XG5cbmZ1bmN0aW9uIG1ha2VfY29tbWVudCggZm9ybSwgc3RvcmUgKSB7XG4gIGNvbnN0IGNoaWxyZW4gICAgICAgICAgID0gQXJyYXkuZnJvbSggZm9ybS5jaGlsZHJlbiApXG4gIGNvbnN0IGNzcmYgICAgICAgICAgICAgID0gZm9ybS5nZXRBdHRyaWJ1dGUoICdkYXRhLWNzcmYnIClcbiAgY29uc3QgYXJ0aWNsZV9zbHVnICAgICAgPSBmb3JtLmdldEF0dHJpYnV0ZSggJ2RhdGEtYXJ0aWNsZS1zbHVnJyApXG4gIGNvbnN0IGJsb2NrX2lkICAgICAgICAgID0gZm9ybS5nZXRBdHRyaWJ1dGUoICdkYXRhLWJsb2NrLWlkJyApXG4gIGNvbnN0IHNlbGVjdGlvbl90eXBlICAgID0gZm9ybS5nZXRBdHRyaWJ1dGUoICdkYXRhLWJsb2NrLXNlbGVjdGlvbi10eXBlJyApXG4gIGNvbnN0IHNlbGVjdGlvbl90ZXh0X2lkID0gZm9ybS5nZXRBdHRyaWJ1dGUoICdkYXRhLWJsb2NrLXNlbGVjdGlvbi10ZXh0LWlkJyApXG4gIGNvbnN0IHNlbGVjdGlvbl90ZXh0ICAgID0gc3RvcmUuZ2V0QnlJRChzZWxlY3Rpb25fdGV4dF9pZClcbiAgY29uc3QgYXV0aG9yICAgICAgICAgICAgPSBjaGlscmVuLmZpbmQoIGMgPT4gYy5uYW1lID09ICdhdXRob3InICkudmFsdWVcbiAgY29uc3QgdGV4dCAgICAgICAgICAgICAgPSBjaGlscmVuLmZpbmQoIGMgPT4gYy5uYW1lID09ICdib2R5JyApLnZhbHVlXG4gIGNvbnN0IHRzICAgICAgICAgICAgICAgID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gIHJldHVybiB7XG4gICAgc2x1ZzogYHRlc3QtJHsgdHMgfWAsXG4gICAgdGl0bGU6ICcnLFxuICAgIHRlbXBsYXRlOiAnY29tbWVudCcsXG4gICAgY3NyZjogY3NyZixcbiAgICBjb250ZW50OiB7XG4gICAgICB1c2VyOiBhdXRob3IsXG4gICAgICB0aW1lc3RhbXA6IHRzLFxuICAgICAgYXJ0aWNsZV9zbHVnOiBhcnRpY2xlX3NsdWcsXG4gICAgICBibG9ja19pZDogYmxvY2tfaWQsXG4gICAgICB0ZXh0OiB0ZXh0LFxuICAgICAgc2VsZWN0aW9uX3R5cGU6IHNlbGVjdGlvbl90eXBlLFxuICAgICAgc2VsZWN0aW9uX3RleHQ6IHNlbGVjdGlvbl90ZXh0LFxuICAgICAgLy8gc2VsZWN0aW9uX2Nvb3Jkczogc2VsZWN0aW9uX2Nvb3Jkc1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBzYXZlX2NvbW1lbnQoIGNvbW1lbnQgKSB7XG5cbn1cblxuZnVuY3Rpb24gbWFrZV9jb21tZW50X3RocmVhZF9lbCggZm9ybSwgcG9zaXRpb24gKSB7XG4gIGNvbnN0IHRocmVhZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdzZWN0aW9uJyApXG4gIHRocmVhZC5jbGFzc0xpc3QuYWRkKCAndGhyZWFkJyApXG4gIHRocmVhZC5jbGFzc0xpc3QuYWRkKCAnbmV3JyApXG4gIHRocmVhZC5hcHBlbmRDaGlsZCggZm9ybSApXG4gIHRocmVhZC5zdHlsZS5zZXRQcm9wZXJ0eSggJy0tdG9wJywgcG9zaXRpb24udG9wICsgJ3B4JyApXG4gIHRocmVhZC5zdHlsZS5zZXRQcm9wZXJ0eSggJy0tbGVmdCcsIHBvc2l0aW9uLmxlZnQgKyAncHgnIClcbiAgcmV0dXJuIHRocmVhZFxufVxuXG5mdW5jdGlvbiBtYWtlX2NvbW1lbnRfZm9ybV9lbCggdGVtcGxhdGVfZm9ybSwgc291cmNlX2lkLCBibG9ja19pZCwgcG9zaXRpb24gKSB7XG4gIGNvbnN0IGZvcm0gPSB0ZW1wbGF0ZV9mb3JtLmNsb25lTm9kZSggdHJ1ZSApXG4gIGZvcm0uc2V0QXR0cmlidXRlKCdkYXRhLWJsb2NrLXNlbGVjdGlvbi10eXBlJywgJ3RleHQnKVxuICBmb3JtLnNldEF0dHJpYnV0ZSgnZGF0YS1ibG9jay1zZWxlY3Rpb24tdGV4dC1pZCcsIHNvdXJjZV9pZCApXG4gIGZvcm0uc2V0QXR0cmlidXRlKCdkYXRhLWJsb2NrLWlkJywgYmxvY2tfaWQgKVxuICBmb3JtLm9uc3VibWl0ID0gcmVzcG9uZF9jb21tZW50XG4gIHJldHVybiBmb3JtXG59XG5cbmZ1bmN0aW9uIG1ha2VfY29tbWVudF9lbCggZGF0YSApIHtcblxuICAvLyAtLSBzZWN0aW9uXG4gIGNvbnN0IHRleHRfY29tbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlY3Rpb24nKVxuICBjb25zdCBzZWN0aW9uX3RleHQgPSBkYXRhLmNvbnRlbnQudGV4dFxuICB0ZXh0X2NvbW1lbnQuYXBwZW5kKHNlY3Rpb25fdGV4dClcblxuICAvLyAtLSBmb290ZXJcbiAgY29uc3QgZm9vdGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9vdGVyJylcbiAgZm9vdGVyLmNsYXNzTGlzdC5hZGQoICdzbWFsbF9pdGFsaWMnIClcbiAgY29uc3QgZGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICBjb25zdCB0aW1lc3RhbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aW1lJylcbiAgLy8gVE9ETyBzZXQgY29ycmVjdCBkYXRldGltZSBmb3JtYXQgZm9yIHRpbWVzdGFtcCBgeXl5eS1tbS1kZCBoaDptbTpzc2BcbiAgdGltZXN0YW1wLnNldEF0dHJpYnV0ZSgnZGF0ZXRpbWUnLCBkYXRhLmNvbnRlbnQudGltZXN0YW1wKVxuICBkYXRlLmFwcGVuZCh0aW1lc3RhbXApXG4gIGRhdGUuaW5uZXJIVE1MID0gYE9uICR7ZGF0YS5jb250ZW50LnRpbWVzdGFtcH1gXG5cbiAgY29uc3QgdXNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICB1c2VyLmlubmVySFRNTCA9IGBieSAke2RhdGEuY29udGVudC51c2VyfWBcblxuICBmb290ZXIuYXBwZW5kKGRhdGUpXG4gIGZvb3Rlci5hcHBlbmQodXNlcilcblxuICAvLyAtLSBhcHBlbmQgZXZlcnl0aGluZyB0byA8YXJ0aWNsZT5cbiAgY29uc3QgYXJ0aWNsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2FydGljbGUnKVxuICBhcnRpY2xlLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnMCcpXG5cbiAgYXJ0aWNsZS5hcHBlbmQodGV4dF9jb21tZW50KVxuICBhcnRpY2xlLmFwcGVuZChmb290ZXIpXG5cbiAgcmV0dXJuIGFydGljbGVcblxufVxuXG5mdW5jdGlvbiBwb3N0X2NvbW1lbnQoIGNvbW1lbnQgKSB7XG4gIGNvbnN0IGNzcmYgPSBjb21tZW50LmNzcmZcbiAgY29uc3QgYXJ0aWNsZV9zbHVnID0gY29tbWVudC5jb250ZW50LmFydGljbGVfc2x1Z1xuICBjb25zdCB1cmwgID0gYC9hcGkvcGFnZXMvYXJ0aWNsZXMrJHsgYXJ0aWNsZV9zbHVnIH0rY29tbWVudHNgXG5cbiAgcmV0dXJuIGZldGNoKCBgJHsgdXJsIH0vY2hpbGRyZW5gICwge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgaGVhZGVyczogeyBcIlgtQ1NSRlwiOiBjc3JmIH0sXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoIGNvbW1lbnQgKVxuICB9KVxuICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXG4gIC50aGVuKHJlc3BvbnNlID0+IHtcblxuICAgIC8vIHNldCBjb21tZW50IHRvIGJlIHB1Ymxpc2hlZFxuICAgIHJldHVybiBmZXRjaCggYCR7IHVybCB9KyR7IHJlc3BvbnNlLmRhdGEuc2x1ZyB9L3N0YXR1c2AsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogeyBcIlgtQ1NSRlwiOiBjc3JmIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSggeyBzdGF0dXM6ICdsaXN0ZWQnIH0gKVxuICAgIH0pXG4gICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxuICAgIC50aGVuKCByZXNwb25zZSA9PiByZXNwb25zZSApXG4gICAgLmNhdGNoKCBlcnJvciA9PiBjb25zb2xlLmVycm9yKCBlcnJvciApIClcblxuICB9KVxuICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlKVxuICAgIC5jYXRjaChlcnJvciA9PiBjb25zb2xlLmVycm9yKGVycm9yKSApXG5cbn1cblxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgcmVzcG9uZF9jb21tZW50LFxuICBwb3N0X2NvbW1lbnQsXG4gIG1ha2VfY29tbWVudF9lbCxcbiAgbWFrZV9jb21tZW50X3RocmVhZF9lbCxcbiAgbWFrZV9jb21tZW50X2Zvcm1fZWwsXG5cbn1cbiIsImNvbnN0IHRleHRIaWdobGlnaHRNZXJnZVVuaXF1ZSA9IHJlcXVpcmUoJy4vdGV4dC1oaWdobGlnaHRzLW1lcmdlLXVuaXF1ZScpXG5cbmFzeW5jIGZ1bmN0aW9uIGZldGNoQXJ0aWNsZUhpZ2hsaWdodHNGcm9tQVBJKGFydGljbGVfc2x1Zykge1xuICBjb25zdCBjc3JmID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvb2xiYXIgPiBmb3JtJykuZ2V0QXR0cmlidXRlKCdkYXRhLWNzcmYnKVxuIFxuICBjb25zdCB1cmwgPSBgL2FwaS9jb3Ntby8keyBhcnRpY2xlX3NsdWcgfWBcbiAgcmV0dXJuIGZldGNoKHVybCwge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBoZWFkZXJzOiB7XG4gICAgICBcIlgtQ1NSRlwiIDogY3NyZlxuICAgIH1cbiAgfSlcbiAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxuICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgY29uc3QgbmV3RGF0YSA9IHJlc3BvbnNlXG4gICAgdGV4dEhpZ2hsaWdodE1lcmdlVW5pcXVlKG5ld0RhdGEpXG5cbiAgfSlcbiAgLmNhdGNoKGVycm9yID0+IHtcbiAgICByZXR1cm4gW11cbiAgfSk7XG5cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmZXRjaEFydGljbGVIaWdobGlnaHRzRnJvbUFQSVxuIiwiLy8gPGh0dHBzOi8vZ2l0aHViLmNvbS9hbGllbnpob3Uvd2ViLWhpZ2hsaWdodGVyL2Jsb2IvbWFzdGVyL2V4YW1wbGUvbG9jYWwuc3RvcmUuanM+XG5cbmNsYXNzIExvY2FsU3RvcmUge1xuICAgIGNvbnN0cnVjdG9yKGlkKSB7XG4gICAgICAgIHRoaXMua2V5ID0gaWQgIT09IHVuZGVmaW5lZCA/IGBjb3Ntby1oaWdobGlnaHQtJHtpZH1gIDogJ2Nvc21vLWhpZ2hsaWdodCc7XG4gICAgfVxuXG4gICAgc3RvcmVUb0pzb24oKSB7XG4gICAgICAgIGNvbnN0IHN0b3JlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5rZXkpO1xuICAgICAgICBsZXQgc291cmNlcztcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHNvdXJjZXMgPSBKU09OLnBhcnNlKHN0b3JlKSB8fCBbXTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgc291cmNlcyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb3VyY2VzO1xuICAgIH1cblxuICAgIGpzb25Ub1N0b3JlKHN0b3Jlcykge1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLmtleSwgSlNPTi5zdHJpbmdpZnkoc3RvcmVzKSk7XG4gICAgfVxuXG4gICAgc2F2ZShkYXRhKSB7XG4gICAgICAgIGNvbnN0IHN0b3JlcyA9IHRoaXMuc3RvcmVUb0pzb24oKTtcbiAgICAgICAgY29uc3QgbWFwID0ge307XG4gICAgICAgIHN0b3Jlcy5mb3JFYWNoKChzdG9yZSwgaWR4KSA9PiBtYXBbc3RvcmUuaWRdID0gaWR4KTtcblxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZGF0YSkpIHtcbiAgICAgICAgICAgIGRhdGEgPSBbZGF0YV07XG4gICAgICAgIH1cblxuICAgICAgICBkYXRhLmZvckVhY2goc3RvcmUgPT4ge1xuICAgICAgICAgICAgLy8gdXBkYXRlXG4gICAgICAgICAgICBpZiAobWFwW3N0b3JlLmlkXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc3RvcmVzW21hcFtzdG9yZS5pZF1dID0gc3RvcmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBhcHBlbmRcbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHN0b3Jlcy5wdXNoKHN0b3JlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgdGhpcy5qc29uVG9TdG9yZShzdG9yZXMpO1xuICAgIH1cblxuICAgIGZvcmNlU2F2ZShzdG9yZSkge1xuICAgICAgICBjb25zdCBzdG9yZXMgPSB0aGlzLnN0b3JlVG9Kc29uKCk7XG4gICAgICAgIHN0b3Jlcy5wdXNoKHN0b3JlKTtcbiAgICAgICAgdGhpcy5qc29uVG9TdG9yZShzdG9yZXMpO1xuICAgIH1cblxuICAgIHJlbW92ZShpZCkge1xuICAgICAgICBjb25zdCBzdG9yZXMgPSB0aGlzLnN0b3JlVG9Kc29uKCk7XG4gICAgICAgIGxldCBpbmRleCA9IG51bGw7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RvcmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoc3RvcmVzW2ldLmlkID09PSBpZCkge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzdG9yZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgdGhpcy5qc29uVG9TdG9yZShzdG9yZXMpO1xuICAgIH1cblxuICAgIGdldEJ5SUQoaWQpIHtcbiAgICAgICAgY29uc3Qgc3RvcmVzID0gdGhpcy5zdG9yZVRvSnNvbigpO1xuICAgICAgICBsZXQgaW5kZXggPSBudWxsO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0b3Jlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmIChzdG9yZXNbaV0uaWQgPT09IGlkKSB7XG4gICAgICAgICAgICBpbmRleCA9IGk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzdG9yZSA9IHN0b3Jlcy5maW5kKHMgPT4gcy5pZCA9PT0gaWQpO1xuICAgICAgICByZXR1cm4gc3RvcmU7XG4gICAgfVxuXG4gICAgZ2V0QWxsKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yZVRvSnNvbigpO1xuICAgIH1cblxuICAgIHJlbW92ZUFsbCgpIHtcbiAgICAgICAgdGhpcy5qc29uVG9TdG9yZShbXSk7XG4gICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IExvY2FsU3RvcmVcbiIsImNvbnN0IGZldGNoQXJ0aWNsZUhpZ2hsaWdodHNGcm9tQVBJID0gcmVxdWlyZSgnLi4vZmV0Y2gtYXJ0aWNsZS1oaWdobGlnaHRzLWZyb20tYXBpJylcbmNvbnN0IHRleHRIaWdobGlnaHQgPSByZXF1aXJlKCcuLi90ZXh0LWhpZ2hsaWdodCcpXG5jb25zdCB7IHJlc3BvbmRfY29tbWVudCwgcG9zdF9jb21tZW50IH0gPSByZXF1aXJlKCcuLi9jb21tZW50cycpXG5cbmNvbnN0IGNvbW1lbnRfZm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCAnLmNvbW1lbnRfZm9ybScgKVxuZm9yICggY29uc3QgY29tbWVudF9mb3JtIG9mIGNvbW1lbnRfZm9ybXMgKSB7XG4gIGNvbW1lbnRfZm9ybS5vbnN1Ym1pdCA9IHJlc3BvbmRfY29tbWVudFxufVxuXG4vLyBzeW5jaHJvbml6ZSB0ZXh0LWhpZ2hsaWdodHMgYmFja2VuZCBkYXRhIHdpdGggbG9jYWxTdG9yYWdlXG5jb25zdCBhcnRpY2xlX3NsdWcgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKS5wb3AoKS5zcGxpdCgnLycpLmpvaW4oJysnKVxuXG47KGFzeW5jKCkgPT4ge1xuICBhd2FpdCBmZXRjaEFydGljbGVIaWdobGlnaHRzRnJvbUFQSShhcnRpY2xlX3NsdWcpXG59KSgpXG5cbmNvbnN0IGFydGljbGVfZWxlbWVudCAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoICdtYWluJyApXG5jb25zdCBzZWxlY3Rpb25fdG9vbGJhciAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCAnLnRvb2xiYXInIClcbmNvbnN0IHRleHRSYW5nZSA9IHRleHRIaWdobGlnaHQoYXJ0aWNsZV9lbGVtZW50LCBzZWxlY3Rpb25fdG9vbGJhcilcbiIsImNvbnN0IEhpZ2hsaWdodGVyID0gcmVxdWlyZSgnd2ViLWhpZ2hsaWdodGVyJylcbmNvbnN0IExvY2FsU3RvcmUgPSByZXF1aXJlKCcuL2xvY2FsLnN0b3JlJylcbmNvbnN0IHtcbiAgcmVzcG9uZF9jb21tZW50LFxuICBtYWtlX2NvbW1lbnRfZWwsXG4gIG1ha2VfY29tbWVudF90aHJlYWRfZWwsXG4gIG1ha2VfY29tbWVudF9mb3JtX2VsLFxufSA9IHJlcXVpcmUoJy4vY29tbWVudHMuanMnKVxuXG4vLyA8aHR0cHM6Ly9naXRodWIuY29tL2FsaWVuemhvdS93ZWItaGlnaGxpZ2h0ZXIvYmxvYi9tYXN0ZXIvZXhhbXBsZS9pbmRleC5qcz5cbmZ1bmN0aW9uIHRleHRIaWdobGlnaHQodGFyZ2V0LCB0b29sYmFyKSB7XG4gIGNvbnN0IGhpZ2hsaWdodGVyID0gbmV3IEhpZ2hsaWdodGVyKHtcbiAgICB3cmFwVGFnOiAnc3BhbicsXG4gICAgZXhjZXB0U2VsZWN0b3JzOiBbJy5oaWdobGlnaHQtdGlwJ11cbiAgfSlcblxuICBoaWdobGlnaHRlci5zZXRPcHRpb24oe1xuICAgIHN0eWxlOiB7XG4gICAgICBjbGFzc05hbWU6ICdiZ2MtYWNjZW50JyxcbiAgICB9LFxuICB9KVxuXG4gIGNvbnN0IHN0b3JlID0gbmV3IExvY2FsU3RvcmUoKTtcblxuICAvLyByZXN0b3JlIGFsbCBoaWdobGlnaHRzIHRvIEhpZ2hsaWdodGVyIGluc3RhbmNlXG4gIHN0b3JlLmdldEFsbCgpLmZvckVhY2goaHMgPT4ge1xuICAgIGhpZ2hsaWdodGVyLmZyb21TdG9yZShocy5zdGFydE1ldGEsIGhzLmVuZE1ldGEsIGhzLnRleHQsIGhzLmlkKVxuICB9KTtcblxuICAvLyBleGNlcHQgZm9yIHRoZSBDUkVBVEUgZXZlbnRcbiAgLy8gYW55IG90aGVyIGV2ZW50IGlzIHRyaWdnZXJlZCB3aGVuIGludGVyYWN0aW5nXG4gIC8vIHdpdGggYW4gZXhpc3Rpbmcgc2VsZWN0aW9uIHNwYW5cbiAgaGlnaGxpZ2h0ZXJcbiAgICAub24oSGlnaGxpZ2h0ZXIuZXZlbnQuQ0xJQ0ssICh7aWR9KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnY2xpY2sgLScsIGlkKTtcbiAgICB9KVxuICAgIC5vbihIaWdobGlnaHRlci5ldmVudC5IT1ZFUiwgKHtpZH0pID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCdob3ZlciAtJywgaWQpO1xuICAgICAgaGlnaGxpZ2h0ZXIuYWRkQ2xhc3MoJ2hpZ2hsaWdodC13cmFwLWhvdmVyJywgaWQpO1xuICAgIH0pXG4gICAgLm9uKEhpZ2hsaWdodGVyLmV2ZW50LkhPVkVSX09VVCwgKHtpZH0pID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCdob3ZlciBvdXQgLScsIGlkKTtcbiAgICAgIGhpZ2hsaWdodGVyLnJlbW92ZUNsYXNzKCdoaWdobGlnaHQtd3JhcC1ob3ZlcicsIGlkKTtcbiAgICB9KVxuICAgIC5vbihIaWdobGlnaHRlci5ldmVudC5DUkVBVEUsICh7c291cmNlc30pID0+IHtcblxuICAgICAgLy8gLy8gY3JlYXRlIHNwYW4gdG8gYWxsb3cgcmVtb3ZpbmcgdGhlIHNlbGVjdGlvblxuICAgICAgLy8gc291cmNlcy5mb3JFYWNoKHMgPT4ge1xuICAgICAgLy8gICBjb25zdCBwb3NpdGlvbiA9IGdldFBvc2l0aW9uKGhpZ2hsaWdodGVyLmdldERvbXMocy5pZClbMF0pO1xuICAgICAgLy8gICBjcmVhdGVUYWcocG9zaXRpb24udG9wLCBwb3NpdGlvbi5sZWZ0LCBzLmlkKTtcbiAgICAgIC8vIH0pO1xuXG4gICAgICAvLyB3aGF0IHRvIGRvIGlmIHNvdXJjZXMgaXMgPiAxIGFuZCB3ZSBuZWVkIHRvIHBvc2l0aW9uIHRoZSBjb21tZW50IHRvb2xiYXI/XG4gICAgICAvLyBwaWNrIGxhc3Qgc291cmNlIGluIHRoZSBsaXN0P1xuICAgICAgaWYgKCBzb3VyY2VzLmxlbmd0aCApIHtcbiAgICAgICAgbGV0IHNvdXJjZSA9IHNvdXJjZXNbMF1cbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uTm9kZSA9IGhpZ2hsaWdodGVyLmdldERvbXMoc291cmNlLmlkKVswXVxuICAgICAgICBjb25zdCBibG9jayAgICAgICAgID0gc2VsZWN0aW9uTm9kZS5jbG9zZXN0KCAnc2VjdGlvbiAuYmxvY2snIClcbiAgICAgICAgY29uc3QgYmxvY2tfaWQgICAgICA9IGdldEJsb2NrSUQoIGJsb2NrIClcbiAgICAgICAgY29uc3QgYXNpZGUgICAgICAgICA9IGJsb2NrLnF1ZXJ5U2VsZWN0b3IoICdhc2lkZScgKVxuICAgICAgICBjb25zdCB0ZW1wbGF0ZV9mb3JtID0gYXNpZGUucXVlcnlTZWxlY3RvciggJy50aHJlYWQgZm9ybScgKVxuICAgICAgICBjb25zdCBmb3JtICAgICAgICAgID0gbWFrZV9jb21tZW50X2Zvcm1fZWwoIHRlbXBsYXRlX2Zvcm0sIHNvdXJjZS5pZCwgYmxvY2tfaWQgKVxuICAgICAgICBjb25zdCBwb3NpdGlvbiAgICAgID0gZ2V0X3Bvc2l0aW9uKHNlbGVjdGlvbk5vZGUpXG4gICAgICAgIGNvbnN0IHRocmVhZCAgICAgICAgPSBtYWtlX2NvbW1lbnRfdGhyZWFkX2VsKCBmb3JtLCBwb3NpdGlvbiApXG4gICAgICAgIGFzaWRlLmFwcGVuZENoaWxkKCB0aHJlYWQgKVxuICAgICAgICBmb3JtLmZpcnN0RWxlbWVudENoaWxkLmZvY3VzKClcbiAgICAgICAgLy8gdG9nZ2xlX3Rvb2xiYXIocG9zaXRpb24sIHRvb2xiYXIsIHNvdXJjZS5pZCwgYmxvY2tfaWQpXG4gICAgICAgIHN0b3JlLnNhdmUoc291cmNlcylcbiAgICAgIH1cblxuICAgIH0pXG4gICAgLm9uKEhpZ2hsaWdodGVyLmV2ZW50LlJFTU9WRSwgKHtpZHN9KSA9PiB7XG4gICAgICAvLyBUT0RPIGltcGxlbWVudCByZW1vdmUgYWN0aW9uXG4gICAgICBjb25zb2xlLmxvZygncmVtb3ZlIC0nLCBpZHMpO1xuICAgICAgLy8gaWRzLmZvckVhY2goaWQgPT4gc3RvcmUucmVtb3ZlKGlkKSk7XG4gICAgfSk7XG5cbiAgaGlnaGxpZ2h0ZXIucnVuKCk7XG59XG5cbmZ1bmN0aW9uIGdldEJsb2NrSUQoIGJsb2NrICkge1xuICBpZiAoYmxvY2sgIT09IHVuZGVmaW5lZCAmJiBibG9jayAhPT0gbnVsbCkge1xuICAgIGlmIChibG9jay5pZCkge1xuICAgICAgcmV0dXJuIGJsb2NrLmlkXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuICcnXG59XG5cbmNvbnN0IGNyZWF0ZVRhZyA9ICh0b3AsIGxlZnQsIGlkKSA9PiB7XG4gIGNvbnN0ICRzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAkc3Bhbi5zdHlsZS5sZWZ0ID0gYCR7bGVmdCAtIDIwfXB4YDtcbiAgJHNwYW4uc3R5bGUudG9wID0gYCR7dG9wIC0gMjV9cHhgO1xuICAkc3Bhbi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICRzcGFuLmRhdGFzZXRbJ2lkJ10gPSBpZDtcbiAgJHNwYW4udGV4dENvbnRlbnQgPSAnZGVsZXRlJztcbiAgJHNwYW4uY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0LXRpcCcpO1xuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKCRzcGFuKTtcbiAgY29uc29sZS5sb2coJ2NyZWF0ZS10YWcgPT4nLCAkc3Bhbilcbn07XG5cbmZ1bmN0aW9uIHRvZ2dsZV90b29sYmFyKHBvc2l0aW9uLCB0b29sYmFyLCBzb3VyY2VJRCwgYmxvY2tJRCkge1xuICBjb25zdCBmb3JtID0gdG9vbGJhci5xdWVyeVNlbGVjdG9yKCdmb3JtJylcbiAgZm9ybS5zZXRBdHRyaWJ1dGUoJ2RhdGEtYmxvY2stc2VsZWN0aW9uLXR5cGUnLCAndGV4dCcpXG4gIGZvcm0uc2V0QXR0cmlidXRlKCdkYXRhLWJsb2NrLXNlbGVjdGlvbi10ZXh0LWlkJywgc291cmNlSUQpXG4gIGZvcm0uc2V0QXR0cmlidXRlKCdkYXRhLWJsb2NrLWlkJywgYmxvY2tJRClcblxuICB0b29sYmFyLmNsYXNzTGlzdC5yZW1vdmUoICdoaWRkZW4nIClcblxuICB0b29sYmFyLnN0eWxlLnNldFByb3BlcnR5KCAnLS10b3AnLCBwb3NpdGlvbi50b3AgKyAncHgnIClcbiAgdG9vbGJhci5zdHlsZS5zZXRQcm9wZXJ0eSggJy0tbGVmdCcsIHBvc2l0aW9uLmxlZnQgKyAncHgnIClcbn1cblxuLy8gPGh0dHBzOi8vZ2l0aHViLmNvbS9hbGllbnpob3Uvd2ViLWhpZ2hsaWdodGVyL2Jsb2IvbWFzdGVyL2V4YW1wbGUvaW5kZXguanMjTDU1LUw2Nz5cbmZ1bmN0aW9uIGdldFBvc2l0aW9uKCRub2RlKSB7XG4gIGxldCBvZmZzZXQgPSB7XG4gICAgdG9wOiAwLFxuICAgIGxlZnQ6IDBcbiAgfTtcbiAgd2hpbGUgKCRub2RlKSB7XG4gICAgb2Zmc2V0LnRvcCArPSAkbm9kZS5vZmZzZXRUb3A7XG4gICAgb2Zmc2V0LmxlZnQgKz0gJG5vZGUub2Zmc2V0TGVmdDtcbiAgICAkbm9kZSA9ICRub2RlLm9mZnNldFBhcmVudDtcbiAgfVxuICByZXR1cm4gb2Zmc2V0O1xufVxuXG5cbmZ1bmN0aW9uIGdldF9wb3NpdGlvbihub2RlKSB7XG4gIGxldCBvZmZzZXQgPSB7XG4gICAgdG9wOiAwLFxuICAgIGxlZnQ6IDBcbiAgfTtcblxuICBvZmZzZXQudG9wICs9IG5vZGUucGFyZW50Tm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wXG4gIG9mZnNldC5sZWZ0ICs9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCArIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0XG5cbiAgcmV0dXJuIG9mZnNldDtcbn1cblxuZnVuY3Rpb24gdXBkYXRlX2Zvcm0oYmxvY2tJbmZvKSB7XG4gIGxldCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvb2xiYXIgZm9ybScpXG4gIGZvcm0uZGF0YXNldC5ibG9ja0lkID0gYmxvY2tJbmZvLmlkXG4gIGZvcm0uZGF0YXNldC5ibG9ja1NlbGVjdGlvblR5cGUgPSBibG9ja0luZm8udHlwZVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHRleHRIaWdobGlnaHQ7XG4iLCJjb25zdCBMb2NhbFN0b3JlID0gcmVxdWlyZSgnLi9sb2NhbC5zdG9yZScpXG5cbmZ1bmN0aW9uIHRleHRIaWdobGlnaHRNZXJnZVVuaXF1ZShuZXdEYXRhKSB7XG4gIC8vIG1lcmdlIHRoaXMgYXJyYXkgb2YgdGV4dC1oaWdobGlnaHRzXG4gIC8vIHcvIGN1cnJlbnQgbG9jYWxTdG9yYWdlWydjb21iby1oaWdobGlnaHQnXVxuICBjb25zdCBzdG9yZSA9IG5ldyBMb2NhbFN0b3JlKCk7XG4gIGxldCBsb2NhbFN0b3JlID0gc3RvcmUuZ2V0QWxsKCk7XG5cbiAgLy8gPGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS81NDEzNDIzNz5cbiAgY29uc3QgaWRzID0gbmV3IFNldChsb2NhbFN0b3JlLm1hcChkID0+IGQuaWQpKTtcbiAgY29uc3QgaGlnaGxpZ2h0c01lcmdlZCA9IFsuLi5sb2NhbFN0b3JlLCAuLi5uZXdEYXRhLmZpbHRlcihkID0+ICFpZHMuaGFzKGQuSUQpKV07XG5cbiAgLy8gdGhlIHNhdmUgZnVuY3Rpb24gY2hlY2tzaWYgdGhlIGl0ZW1cbiAgLy8gZXhpc3RzIGFscmVhZHksIHNvIHdlIGp1c3QgcGFzc1xuICAvLyB0aGUgZW50aXJlIGRhdGFzZXRcbiAgc3RvcmUuc2F2ZShoaWdobGlnaHRzTWVyZ2VkKVxuXG59XG5cbm1vZHVsZS5leHBvcnRzID0gdGV4dEhpZ2hsaWdodE1lcmdlVW5pcXVlXG4iLCIvKiEgd2ViLWhpZ2hsaWdodGVyIHYwLjcuNCBodHRwczovL2dpdGh1Yi5jb20vYWxpZW56aG91L3dlYi1oaWdobGlnaHRlciAqL1xuIWZ1bmN0aW9uKGUsdCl7XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHMmJlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGU/bW9kdWxlLmV4cG9ydHM9dCgpOlwiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoW10sdCk6XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHM/ZXhwb3J0cy5IaWdobGlnaHRlcj10KCk6ZS5IaWdobGlnaHRlcj10KCl9KHdpbmRvdywoZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oZSl7dmFyIHQ9e307ZnVuY3Rpb24gbihyKXtpZih0W3JdKXJldHVybiB0W3JdLmV4cG9ydHM7dmFyIG89dFtyXT17aTpyLGw6ITEsZXhwb3J0czp7fX07cmV0dXJuIGVbcl0uY2FsbChvLmV4cG9ydHMsbyxvLmV4cG9ydHMsbiksby5sPSEwLG8uZXhwb3J0c31yZXR1cm4gbi5tPWUsbi5jPXQsbi5kPWZ1bmN0aW9uKGUsdCxyKXtuLm8oZSx0KXx8T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7ZW51bWVyYWJsZTohMCxnZXQ6cn0pfSxuLnI9ZnVuY3Rpb24oZSl7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIFN5bWJvbCYmU3ltYm9sLnRvU3RyaW5nVGFnJiZPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxTeW1ib2wudG9TdHJpbmdUYWcse3ZhbHVlOlwiTW9kdWxlXCJ9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KX0sbi50PWZ1bmN0aW9uKGUsdCl7aWYoMSZ0JiYoZT1uKGUpKSw4JnQpcmV0dXJuIGU7aWYoNCZ0JiZcIm9iamVjdFwiPT10eXBlb2YgZSYmZSYmZS5fX2VzTW9kdWxlKXJldHVybiBlO3ZhciByPU9iamVjdC5jcmVhdGUobnVsbCk7aWYobi5yKHIpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLFwiZGVmYXVsdFwiLHtlbnVtZXJhYmxlOiEwLHZhbHVlOmV9KSwyJnQmJlwic3RyaW5nXCIhPXR5cGVvZiBlKWZvcih2YXIgbyBpbiBlKW4uZChyLG8sZnVuY3Rpb24odCl7cmV0dXJuIGVbdF19LmJpbmQobnVsbCxvKSk7cmV0dXJuIHJ9LG4ubj1mdW5jdGlvbihlKXt2YXIgdD1lJiZlLl9fZXNNb2R1bGU/ZnVuY3Rpb24oKXtyZXR1cm4gZS5kZWZhdWx0fTpmdW5jdGlvbigpe3JldHVybiBlfTtyZXR1cm4gbi5kKHQsXCJhXCIsdCksdH0sbi5vPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHQpfSxuLnA9XCJcIixuKG4ucz03KX0oW2Z1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjt2YXIgcixvPXRoaXMmJnRoaXMuX19leHRlbmRzfHwocj1mdW5jdGlvbihlLHQpe3JldHVybihyPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihlLHQpe2UuX19wcm90b19fPXR9fHxmdW5jdGlvbihlLHQpe2Zvcih2YXIgbiBpbiB0KU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LG4pJiYoZVtuXT10W25dKX0pKGUsdCl9LGZ1bmN0aW9uKGUsdCl7ZnVuY3Rpb24gbigpe3RoaXMuY29uc3RydWN0b3I9ZX1yKGUsdCksZS5wcm90b3R5cGU9bnVsbD09PXQ/T2JqZWN0LmNyZWF0ZSh0KToobi5wcm90b3R5cGU9dC5wcm90b3R5cGUsbmV3IG4pfSksaT10aGlzJiZ0aGlzLl9faW1wb3J0RGVmYXVsdHx8ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fTtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LmV2ZW50RW1pdHRlcj10LklOVEVSTkFMX0VSUk9SX0VWRU5UPXQuVU5LTk9XTl9JRFg9dC5ST09UX0lEWD10LmdldFN0eWxlc2hlZXQ9dC5nZXREZWZhdWx0T3B0aW9ucz10LkNBTUVMX0RBVEFTRVRfU1BMSVRfVFlQRT10LkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUl9FWFRSQT10LkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUj10LkRBVEFTRVRfU1BMSVRfVFlQRT10LkRBVEFTRVRfSURFTlRJRklFUl9FWFRSQT10LkRBVEFTRVRfSURFTlRJRklFUj10LlNUWUxFU0hFRVRfSUQ9dC5MT0NBTF9TVE9SRV9LRVk9dC5JRF9ESVZJU0lPTj12b2lkIDA7dmFyIGE9aShuKDEwKSksbD1pKG4oMikpO3QuSURfRElWSVNJT049XCI7XCIsdC5MT0NBTF9TVE9SRV9LRVk9XCJoaWdobGlnaHQtbWVuZ3Nob3VcIix0LlNUWUxFU0hFRVRfSUQ9XCJoaWdobGlnaHQtbWVuZ3Nob3Utc3R5bGVcIix0LkRBVEFTRVRfSURFTlRJRklFUj1cImhpZ2hsaWdodC1pZFwiLHQuREFUQVNFVF9JREVOVElGSUVSX0VYVFJBPVwiaGlnaGxpZ2h0LWlkLWV4dHJhXCIsdC5EQVRBU0VUX1NQTElUX1RZUEU9XCJoaWdobGlnaHQtc3BsaXQtdHlwZVwiLHQuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSPWEuZGVmYXVsdCh0LkRBVEFTRVRfSURFTlRJRklFUiksdC5DQU1FTF9EQVRBU0VUX0lERU5USUZJRVJfRVhUUkE9YS5kZWZhdWx0KHQuREFUQVNFVF9JREVOVElGSUVSX0VYVFJBKSx0LkNBTUVMX0RBVEFTRVRfU1BMSVRfVFlQRT1hLmRlZmF1bHQodC5EQVRBU0VUX1NQTElUX1RZUEUpO3QuZ2V0RGVmYXVsdE9wdGlvbnM9ZnVuY3Rpb24oKXtyZXR1cm57JHJvb3Q6ZG9jdW1lbnR8fGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCxleGNlcHRTZWxlY3RvcnM6bnVsbCx3cmFwVGFnOlwic3BhblwiLHZlcmJvc2U6ITEsc3R5bGU6e2NsYXNzTmFtZTpcImhpZ2hsaWdodC1tZW5nc2hvdS13cmFwXCJ9fX07dC5nZXRTdHlsZXNoZWV0PWZ1bmN0aW9uKCl7cmV0dXJuXCJcXG4gICAgLlwiK3QuZ2V0RGVmYXVsdE9wdGlvbnMoKS5zdHlsZS5jbGFzc05hbWUrXCIge1xcbiAgICAgICAgYmFja2dyb3VuZDogI2ZmOTtcXG4gICAgICAgIGN1cnNvcjogcG9pbnRlcjtcXG4gICAgfVxcbiAgICAuXCIrdC5nZXREZWZhdWx0T3B0aW9ucygpLnN0eWxlLmNsYXNzTmFtZStcIi5hY3RpdmUge1xcbiAgICAgICAgYmFja2dyb3VuZDogI2ZmYjtcXG4gICAgfVxcblwifSx0LlJPT1RfSURYPS0yLHQuVU5LTk9XTl9JRFg9LTEsdC5JTlRFUk5BTF9FUlJPUl9FVkVOVD1cImVycm9yXCI7dmFyIHU9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe3JldHVybiBudWxsIT09ZSYmZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fHRoaXN9cmV0dXJuIG8odCxlKSx0fShsLmRlZmF1bHQpO3QuZXZlbnRFbWl0dGVyPW5ldyB1fSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksdC5Vc2VySW5wdXRFdmVudD10LlNlbGVjdGVkTm9kZVR5cGU9dC5DcmVhdGVGcm9tPXQuRXZlbnRUeXBlPXQuRVJST1I9dC5TcGxpdFR5cGU9dm9pZCAwLGZ1bmN0aW9uKGUpe2Uubm9uZT1cIm5vbmVcIixlLmhlYWQ9XCJoZWFkXCIsZS50YWlsPVwidGFpbFwiLGUuYm90aD1cImJvdGhcIn0odC5TcGxpdFR5cGV8fCh0LlNwbGl0VHlwZT17fSkpLGZ1bmN0aW9uKGUpe2UuRE9NX1RZUEVfRVJST1I9XCJbRE9NXSBSZWNlaXZlIHdyb25nIG5vZGUgdHlwZS5cIixlLkRPTV9TRUxFQ1RJT05fRU1QVFk9XCJbRE9NXSBUaGUgc2VsZWN0aW9uIGNvbnRhaW5zIG5vIGRvbSBub2RlLCBtYXkgYmUgeW91IGV4Y2VwdCB0aGVtLlwiLGUuUkFOR0VfSU5WQUxJRD1cIltSQU5HRV0gR290IGludmFsaWQgZG9tIHJhbmdlLCBjYW4ndCBjb252ZXJ0IHRvIGEgdmFsaWQgaGlnaGxpZ2h0IHJhbmdlLlwiLGUuUkFOR0VfTk9ERV9JTlZBTElEPVwiW1JBTkdFXSBTdGFydCBvciBlbmQgbm9kZSBpc24ndCBhIHRleHQgbm9kZSwgaXQgbWF5IG9jY3VyIGFuIGVycm9yLlwiLGUuREJfSURfRFVQTElDQVRFX0VSUk9SPVwiW1NUT1JFXSBVbmlxdWUgaWQgY29uZmxpY3QuXCIsZS5DQUNIRV9TRVRfRVJST1I9XCJbQ0FDSEVdIENhY2hlLmRhdGEgY2FuJ3QgYmUgc2V0IG1hbnVhbGx5LCBwbGVhc2UgdXNlIC5zYXZlKCkuXCIsZS5TT1VSQ0VfVFlQRV9FUlJPUj1cIltTT1VSQ0VdIE9iamVjdCBpc24ndCBhIGhpZ2hsaWdodCBzb3VyY2UgaW5zdGFuY2UuXCIsZS5ISUdITElHSFRfUkFOR0VfRlJPWkVOPVwiW0hJR0hMSUdIVF9SQU5HRV0gQSBoaWdobGlnaHQgcmFuZ2UgbXVzdCBiZSBmcm96ZW4gYmVmb3JlIHJlbmRlci5cIixlLkhJR0hMSUdIVF9TT1VSQ0VfUkVDUkVBVEU9XCJbSElHSExJR0hUX1NPVVJDRV0gUmVjcmVhdGUgaGlnaGxpZ2h0cyBmcm9tIHNvdXJjZXMgZXJyb3IuXCIsZS5ISUdITElHSFRfU09VUkNFX05PTkVfUkVOREVSPVwiW0hJR0hMSUdIVF9TT1VSQ0VdIFRoaXMgaGlnaGxpZ2h0IHNvdXJjZSBpc24ndCByZW5kZXJlZC4gTWF5IGJlIHRoZSBleGNlcHRpb24gc2tpcHMgaXQgb3IgdGhlIGRvbSBzdHJ1Y3R1cmUgaGFzIGNoYW5nZWQuXCJ9KHQuRVJST1J8fCh0LkVSUk9SPXt9KSksZnVuY3Rpb24oZSl7ZS5DUkVBVEU9XCJzZWxlY3Rpb246Y3JlYXRlXCIsZS5SRU1PVkU9XCJzZWxlY3Rpb246cmVtb3ZlXCIsZS5NT0RJRlk9XCJzZWxlY3Rpb246bW9kaWZ5XCIsZS5IT1ZFUj1cInNlbGVjdGlvbjpob3ZlclwiLGUuSE9WRVJfT1VUPVwic2VsZWN0aW9uOmhvdmVyLW91dFwiLGUuQ0xJQ0s9XCJzZWxlY3Rpb246Y2xpY2tcIn0odC5FdmVudFR5cGV8fCh0LkV2ZW50VHlwZT17fSkpLGZ1bmN0aW9uKGUpe2UuU1RPUkU9XCJmcm9tLXN0b3JlXCIsZS5JTlBVVD1cImZyb20taW5wdXRcIn0odC5DcmVhdGVGcm9tfHwodC5DcmVhdGVGcm9tPXt9KSksZnVuY3Rpb24oZSl7ZS50ZXh0PVwidGV4dFwiLGUuc3Bhbj1cInNwYW5cIn0odC5TZWxlY3RlZE5vZGVUeXBlfHwodC5TZWxlY3RlZE5vZGVUeXBlPXt9KSksZnVuY3Rpb24oZSl7ZS50b3VjaGVuZD1cInRvdWNoZW5kXCIsZS5tb3VzZXVwPVwibW91c2V1cFwiLGUudG91Y2hzdGFydD1cInRvdWNoc3RhcnRcIixlLmNsaWNrPVwiY2xpY2tcIixlLm1vdXNlb3Zlcj1cIm1vdXNlb3ZlclwifSh0LlVzZXJJbnB1dEV2ZW50fHwodC5Vc2VySW5wdXRFdmVudD17fSkpfSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7dmFyIHI9dGhpcyYmdGhpcy5fX3JlYWR8fGZ1bmN0aW9uKGUsdCl7dmFyIG49XCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sJiZlW1N5bWJvbC5pdGVyYXRvcl07aWYoIW4pcmV0dXJuIGU7dmFyIHIsbyxpPW4uY2FsbChlKSxhPVtdO3RyeXtmb3IoOyh2b2lkIDA9PT10fHx0LS0gPjApJiYhKHI9aS5uZXh0KCkpLmRvbmU7KWEucHVzaChyLnZhbHVlKX1jYXRjaChlKXtvPXtlcnJvcjplfX1maW5hbGx5e3RyeXtyJiYhci5kb25lJiYobj1pLnJldHVybikmJm4uY2FsbChpKX1maW5hbGx5e2lmKG8pdGhyb3cgby5lcnJvcn19cmV0dXJuIGF9LG89dGhpcyYmdGhpcy5fX3NwcmVhZHx8ZnVuY3Rpb24oKXtmb3IodmFyIGU9W10sdD0wO3Q8YXJndW1lbnRzLmxlbmd0aDt0KyspZT1lLmNvbmNhdChyKGFyZ3VtZW50c1t0XSkpO3JldHVybiBlfTtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXt0aGlzLmhhbmRsZXJzTWFwPU9iamVjdC5jcmVhdGUobnVsbCl9cmV0dXJuIGUucHJvdG90eXBlLm9uPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuaGFuZGxlcnNNYXBbZV18fCh0aGlzLmhhbmRsZXJzTWFwW2VdPVtdKSx0aGlzLmhhbmRsZXJzTWFwW2VdLnB1c2godCksdGhpc30sZS5wcm90b3R5cGUub2ZmPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuaGFuZGxlcnNNYXBbZV0mJnRoaXMuaGFuZGxlcnNNYXBbZV0uc3BsaWNlKHRoaXMuaGFuZGxlcnNNYXBbZV0uaW5kZXhPZih0KT4+PjAsMSksdGhpc30sZS5wcm90b3R5cGUuZW1pdD1mdW5jdGlvbihlKXtmb3IodmFyIHQ9W10sbj0xO248YXJndW1lbnRzLmxlbmd0aDtuKyspdFtuLTFdPWFyZ3VtZW50c1tuXTtyZXR1cm4gdGhpcy5oYW5kbGVyc01hcFtlXSYmdGhpcy5oYW5kbGVyc01hcFtlXS5zbGljZSgpLmZvckVhY2goKGZ1bmN0aW9uKGUpe2UuYXBwbHkodm9pZCAwLG8odCkpfSkpLHRoaXN9LGV9KCk7dC5kZWZhdWx0PWl9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjt2YXIgcj10aGlzJiZ0aGlzLl9faW1wb3J0RGVmYXVsdHx8ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fTtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgbz1yKG4oNSkpLGk9big5KSxhPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQsbixyLG8pe3RoaXMuc3RhcnRNZXRhPWUsdGhpcy5lbmRNZXRhPXQsdGhpcy50ZXh0PW4sdGhpcy5pZD1yLHRoaXMuX19pc0hpZ2hsaWdodFNvdXJjZT17fSxvJiYodGhpcy5leHRyYT1vKX1yZXR1cm4gZS5wcm90b3R5cGUuZGVTZXJpYWxpemU9ZnVuY3Rpb24oZSx0KXt2YXIgbj1pLnF1ZXJ5RWxlbWVudE5vZGUodGhpcyxlKSxyPW4uc3RhcnQsYT1uLmVuZCxsPWkuZ2V0VGV4dENoaWxkQnlPZmZzZXQocix0aGlzLnN0YXJ0TWV0YS50ZXh0T2Zmc2V0KSx1PWkuZ2V0VGV4dENoaWxkQnlPZmZzZXQoYSx0aGlzLmVuZE1ldGEudGV4dE9mZnNldCk7aWYoIXQuU2VyaWFsaXplLlJlc3RvcmUuaXNFbXB0eSgpKXt2YXIgcz10LlNlcmlhbGl6ZS5SZXN0b3JlLmNhbGwodGhpcyxsLHUpfHxbXTtsPXNbMF18fGwsdT1zWzFdfHx1fXJldHVybiBuZXcgby5kZWZhdWx0KGwsdSx0aGlzLnRleHQsdGhpcy5pZCwhMCl9LGV9KCk7dC5kZWZhdWx0PWF9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjt2YXIgcj10aGlzJiZ0aGlzLl9fdmFsdWVzfHxmdW5jdGlvbihlKXt2YXIgdD1cImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJlN5bWJvbC5pdGVyYXRvcixuPXQmJmVbdF0scj0wO2lmKG4pcmV0dXJuIG4uY2FsbChlKTtpZihlJiZcIm51bWJlclwiPT10eXBlb2YgZS5sZW5ndGgpcmV0dXJue25leHQ6ZnVuY3Rpb24oKXtyZXR1cm4gZSYmcj49ZS5sZW5ndGgmJihlPXZvaWQgMCkse3ZhbHVlOmUmJmVbcisrXSxkb25lOiFlfX19O3Rocm93IG5ldyBUeXBlRXJyb3IodD9cIk9iamVjdCBpcyBub3QgaXRlcmFibGUuXCI6XCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpfSxvPXRoaXMmJnRoaXMuX19yZWFkfHxmdW5jdGlvbihlLHQpe3ZhciBuPVwiZnVuY3Rpb25cIj09dHlwZW9mIFN5bWJvbCYmZVtTeW1ib2wuaXRlcmF0b3JdO2lmKCFuKXJldHVybiBlO3ZhciByLG8saT1uLmNhbGwoZSksYT1bXTt0cnl7Zm9yKDsodm9pZCAwPT09dHx8dC0tID4wKSYmIShyPWkubmV4dCgpKS5kb25lOylhLnB1c2goci52YWx1ZSl9Y2F0Y2goZSl7bz17ZXJyb3I6ZX19ZmluYWxseXt0cnl7ciYmIXIuZG9uZSYmKG49aS5yZXR1cm4pJiZuLmNhbGwoaSl9ZmluYWxseXtpZihvKXRocm93IG8uZXJyb3J9fXJldHVybiBhfSxpPXRoaXMmJnRoaXMuX19zcHJlYWR8fGZ1bmN0aW9uKCl7Zm9yKHZhciBlPVtdLHQ9MDt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKWU9ZS5jb25jYXQobyhhcmd1bWVudHNbdF0pKTtyZXR1cm4gZX07T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksdC5oYXNDbGFzcz10LnJlbW92ZUFsbENsYXNzPXQucmVtb3ZlQ2xhc3M9dC5hZGRDbGFzcz10LmFkZEV2ZW50TGlzdGVuZXI9dC5yZW1vdmVFdmVudExpc3RlbmVyPXQuZm9yRWFjaD10LmdldEhpZ2hsaWdodEJ5SWQ9dC5nZXRIaWdobGlnaHRzQnlSb290PXQuZ2V0RXh0cmFIaWdobGlnaHRJZD10LmdldEhpZ2hsaWdodElkPXQuaXNIaWdobGlnaHRXcmFwTm9kZT12b2lkIDA7dmFyIGE9bigwKTt0LmlzSGlnaGxpZ2h0V3JhcE5vZGU9ZnVuY3Rpb24oZSl7cmV0dXJuISFlLmRhdGFzZXQmJiEhZS5kYXRhc2V0W2EuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSXX07dmFyIGw9ZnVuY3Rpb24oZSxuKXtmb3IodmFyIHI9ITEsbz1udWxsO2U7KXtpZih0LmlzSGlnaGxpZ2h0V3JhcE5vZGUoZSkmJihvPWUpLGU9PT1uKXtyPSEwO2JyZWFrfWU9ZS5wYXJlbnROb2RlfXJldHVybiByP286bnVsbH07dC5nZXRIaWdobGlnaHRJZD1mdW5jdGlvbihlLHQpe3JldHVybihlPWwoZSx0KSk/ZS5kYXRhc2V0W2EuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSXTpcIlwifTt0LmdldEV4dHJhSGlnaGxpZ2h0SWQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4oZT1sKGUsdCkpP2UuZGF0YXNldFthLkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUl9FWFRSQV0uc3BsaXQoYS5JRF9ESVZJU0lPTikuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4gZX0pKTpbXX07dC5nZXRIaWdobGlnaHRzQnlSb290PWZ1bmN0aW9uKGUsdCl7dmFyIG4sbztBcnJheS5pc0FycmF5KGUpfHwoZT1bZV0pO3ZhciBpPVtdO3RyeXtmb3IodmFyIGw9cihlKSx1PWwubmV4dCgpOyF1LmRvbmU7dT1sLm5leHQoKSl7dmFyIHM9dS52YWx1ZS5xdWVyeVNlbGVjdG9yQWxsKHQrXCJbZGF0YS1cIithLkRBVEFTRVRfSURFTlRJRklFUitcIl1cIik7aS5wdXNoLmFwcGx5KGkscyl9fWNhdGNoKGUpe249e2Vycm9yOmV9fWZpbmFsbHl7dHJ5e3UmJiF1LmRvbmUmJihvPWwucmV0dXJuKSYmby5jYWxsKGwpfWZpbmFsbHl7aWYobil0aHJvdyBuLmVycm9yfX1yZXR1cm4gaX07dC5nZXRIaWdobGlnaHRCeUlkPWZ1bmN0aW9uKGUsdCxuKXt2YXIgbyxpLGw9W10sdT1uZXcgUmVnRXhwKFwiKFwiK3QrXCJcXFxcXCIrYS5JRF9ESVZJU0lPTitcInxcXFxcXCIrYS5JRF9ESVZJU0lPTitcIj9cIit0K1wiJClcIikscz1lLnF1ZXJ5U2VsZWN0b3JBbGwobitcIltkYXRhLVwiK2EuREFUQVNFVF9JREVOVElGSUVSK1wiXVwiKTt0cnl7Zm9yKHZhciBkPXIocyksYz1kLm5leHQoKTshYy5kb25lO2M9ZC5uZXh0KCkpe3ZhciBmPWMudmFsdWU7aWYoZi5kYXRhc2V0W2EuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSXSE9PXQpe3ZhciBoPWYuZGF0YXNldFthLkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUl9FWFRSQV07dS50ZXN0KGgpJiZsLnB1c2goZil9ZWxzZSBsLnB1c2goZil9fWNhdGNoKGUpe289e2Vycm9yOmV9fWZpbmFsbHl7dHJ5e2MmJiFjLmRvbmUmJihpPWQucmV0dXJuKSYmaS5jYWxsKGQpfWZpbmFsbHl7aWYobyl0aHJvdyBvLmVycm9yfX1yZXR1cm4gbH07dC5mb3JFYWNoPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPTA7bjxlLmxlbmd0aDtuKyspdChlW25dLG4sZSl9O3QucmVtb3ZlRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihlLHQsbil7ZS5yZW1vdmVFdmVudExpc3RlbmVyKHQsbil9O3QuYWRkRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihlLG4scil7cmV0dXJuIGUuYWRkRXZlbnRMaXN0ZW5lcihuLHIpLGZ1bmN0aW9uKCl7dC5yZW1vdmVFdmVudExpc3RlbmVyKGUsbixyKX19O3QuYWRkQ2xhc3M9ZnVuY3Rpb24oZSx0KXt2YXIgbjtBcnJheS5pc0FycmF5KHQpfHwodD1bdF0pLChuPWUuY2xhc3NMaXN0KS5hZGQuYXBwbHkobixpKHQpKX07dC5yZW1vdmVDbGFzcz1mdW5jdGlvbihlLHQpe2UuY2xhc3NMaXN0LnJlbW92ZSh0KX07dC5yZW1vdmVBbGxDbGFzcz1mdW5jdGlvbihlKXtlLmNsYXNzTmFtZT1cIlwifTt0Lmhhc0NsYXNzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUuY2xhc3NMaXN0LmNvbnRhaW5zKHQpfX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO3ZhciByPXRoaXMmJnRoaXMuX19pbXBvcnREZWZhdWx0fHxmdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19O09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBvPXIobigzKSksaT1uKDEpLGE9bigxMSksbD1yKG4oNikpLHU9bigxMikscz1uKDApLGQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCxuLHIsbyl7dm9pZCAwPT09byYmKG89ITEpLDM9PT1lLiRub2RlLm5vZGVUeXBlJiYzPT09dC4kbm9kZS5ub2RlVHlwZXx8cy5ldmVudEVtaXR0ZXIuZW1pdChzLklOVEVSTkFMX0VSUk9SX0VWRU5ULHt0eXBlOmkuRVJST1IuUkFOR0VfTk9ERV9JTlZBTElEfSksdGhpcy5zdGFydD11LmZvcm1hdERvbU5vZGUoZSksdGhpcy5lbmQ9dS5mb3JtYXREb21Ob2RlKHQpLHRoaXMudGV4dD1uLHRoaXMuZnJvemVuPW8sdGhpcy5pZD1yfXJldHVybiBlLmZyb21TZWxlY3Rpb249ZnVuY3Rpb24odCl7dmFyIG49YS5nZXREb21SYW5nZSgpO2lmKCFuKXJldHVybiBudWxsO3ZhciByPXskbm9kZTpuLnN0YXJ0Q29udGFpbmVyLG9mZnNldDpuLnN0YXJ0T2Zmc2V0fSxvPXskbm9kZTpuLmVuZENvbnRhaW5lcixvZmZzZXQ6bi5lbmRPZmZzZXR9LGk9bi50b1N0cmluZygpLHU9dC5jYWxsKHIsbyxpKTtyZXR1cm4gbmV3IGUocixvLGksdT1udWxsIT11P3U6bC5kZWZhdWx0KCkpfSxlLnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oZSx0KXt2YXIgbixyPXUuZ2V0RG9tTWV0YSh0aGlzLnN0YXJ0LiRub2RlLHRoaXMuc3RhcnQub2Zmc2V0LGUpLGk9dS5nZXREb21NZXRhKHRoaXMuZW5kLiRub2RlLHRoaXMuZW5kLm9mZnNldCxlKTtyZXR1cm4gdC5TZXJpYWxpemUuUmVjb3JkSW5mby5pc0VtcHR5KCl8fChuPXQuU2VyaWFsaXplLlJlY29yZEluZm8uY2FsbCh0aGlzLnN0YXJ0LHRoaXMuZW5kLGUpKSx0aGlzLmZyb3plbj0hMCxuZXcgby5kZWZhdWx0KHIsaSx0aGlzLnRleHQsdGhpcy5pZCxuKX0sZS5yZW1vdmVEb21SYW5nZT1hLnJlbW92ZVNlbGVjdGlvbixlfSgpO3QuZGVmYXVsdD1kfSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksdC5kZWZhdWx0PWZ1bmN0aW9uIGUodCl7cmV0dXJuIHQ/KHReMTYqTWF0aC5yYW5kb20oKT4+dC80KS50b1N0cmluZygxNik6KFsxZTddKy0xZTMrLTRlMystOGUzKy0xZTExKS5yZXBsYWNlKC9bMDE4XS9nLGUpfX0sZnVuY3Rpb24oZSx0LG4pe2UuZXhwb3J0cz1uKDgpfSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7dmFyIHIsbz10aGlzJiZ0aGlzLl9fZXh0ZW5kc3x8KHI9ZnVuY3Rpb24oZSx0KXtyZXR1cm4ocj1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24oZSx0KXtlLl9fcHJvdG9fXz10fXx8ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG4gaW4gdClPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxuKSYmKGVbbl09dFtuXSl9KShlLHQpfSxmdW5jdGlvbihlLHQpe2Z1bmN0aW9uIG4oKXt0aGlzLmNvbnN0cnVjdG9yPWV9cihlLHQpLGUucHJvdG90eXBlPW51bGw9PT10P09iamVjdC5jcmVhdGUodCk6KG4ucHJvdG90eXBlPXQucHJvdG90eXBlLG5ldyBuKX0pLGk9dGhpcyYmdGhpcy5fX2Fzc2lnbnx8ZnVuY3Rpb24oKXtyZXR1cm4oaT1PYmplY3QuYXNzaWdufHxmdW5jdGlvbihlKXtmb3IodmFyIHQsbj0xLHI9YXJndW1lbnRzLmxlbmd0aDtuPHI7bisrKWZvcih2YXIgbyBpbiB0PWFyZ3VtZW50c1tuXSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxvKSYmKGVbb109dFtvXSk7cmV0dXJuIGV9KS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGE9dGhpcyYmdGhpcy5fX2ltcG9ydERlZmF1bHR8fGZ1bmN0aW9uKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX07T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIGw9YShuKDIpKSx1PWEobig1KSkscz1hKG4oMykpLGQ9YShuKDYpKSxjPWEobigxMykpLGY9YShuKDE0KSksaD1hKG4oMTYpKSxwPWEobigxNykpLEU9bigwKSxfPW4oMSksdj1uKDQpLFQ9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCh0KXt2YXIgbj1lLmNhbGwodGhpcyl8fHRoaXM7bi5ldmVudD1mLmRlZmF1bHQoKSxuLnJ1bj1mdW5jdGlvbigpe3JldHVybiB2LmFkZEV2ZW50TGlzdGVuZXIobi5vcHRpb25zLiRyb290LG4uZXZlbnQuUG9pbnRlckVuZCxuLl9oYW5kbGVTZWxlY3Rpb24pfSxuLnN0b3A9ZnVuY3Rpb24oKXt2LnJlbW92ZUV2ZW50TGlzdGVuZXIobi5vcHRpb25zLiRyb290LG4uZXZlbnQuUG9pbnRlckVuZCxuLl9oYW5kbGVTZWxlY3Rpb24pfSxuLmFkZENsYXNzPWZ1bmN0aW9uKGUsdCl7bi5nZXREb21zKHQpLmZvckVhY2goKGZ1bmN0aW9uKHQpe3YuYWRkQ2xhc3ModCxlKX0pKX0sbi5yZW1vdmVDbGFzcz1mdW5jdGlvbihlLHQpe24uZ2V0RG9tcyh0KS5mb3JFYWNoKChmdW5jdGlvbih0KXt2LnJlbW92ZUNsYXNzKHQsZSl9KSl9LG4uZ2V0SWRCeURvbT1mdW5jdGlvbihlKXtyZXR1cm4gdi5nZXRIaWdobGlnaHRJZChlLG4ub3B0aW9ucy4kcm9vdCl9LG4uZ2V0RXh0cmFJZEJ5RG9tPWZ1bmN0aW9uKGUpe3JldHVybiB2LmdldEV4dHJhSGlnaGxpZ2h0SWQoZSxuLm9wdGlvbnMuJHJvb3QpfSxuLmdldERvbXM9ZnVuY3Rpb24oZSl7cmV0dXJuIGU/di5nZXRIaWdobGlnaHRCeUlkKG4ub3B0aW9ucy4kcm9vdCxlLG4ub3B0aW9ucy53cmFwVGFnKTp2LmdldEhpZ2hsaWdodHNCeVJvb3Qobi5vcHRpb25zLiRyb290LG4ub3B0aW9ucy53cmFwVGFnKX0sbi5kaXNwb3NlPWZ1bmN0aW9uKCl7dmFyIGU9bi5vcHRpb25zLiRyb290O3YucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLG4uZXZlbnQuUG9pbnRlck92ZXIsbi5faGFuZGxlSGlnaGxpZ2h0SG92ZXIpLHYucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLG4uZXZlbnQuUG9pbnRlckVuZCxuLl9oYW5kbGVTZWxlY3Rpb24pLHYucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLG4uZXZlbnQuUG9pbnRlclRhcCxuLl9oYW5kbGVIaWdobGlnaHRDbGljayksbi5yZW1vdmVBbGwoKX0sbi5zZXRPcHRpb249ZnVuY3Rpb24oZSl7bi5vcHRpb25zPWkoaSh7fSxuLm9wdGlvbnMpLGUpLG4ucGFpbnRlcj1uZXcgcC5kZWZhdWx0KHskcm9vdDpuLm9wdGlvbnMuJHJvb3Qsd3JhcFRhZzpuLm9wdGlvbnMud3JhcFRhZyxjbGFzc05hbWU6bi5vcHRpb25zLnN0eWxlLmNsYXNzTmFtZSxleGNlcHRTZWxlY3RvcnM6bi5vcHRpb25zLmV4Y2VwdFNlbGVjdG9yc30sbi5ob29rcyl9LG4uZnJvbVJhbmdlPWZ1bmN0aW9uKGUpe3ZhciB0PXskbm9kZTplLnN0YXJ0Q29udGFpbmVyLG9mZnNldDplLnN0YXJ0T2Zmc2V0fSxyPXskbm9kZTplLmVuZENvbnRhaW5lcixvZmZzZXQ6ZS5lbmRPZmZzZXR9LG89ZS50b1N0cmluZygpLGk9bi5ob29rcy5SZW5kZXIuVVVJRC5jYWxsKHQscixvKTtpPW51bGwhPWk/aTpkLmRlZmF1bHQoKTt2YXIgYT1uZXcgdS5kZWZhdWx0KHQscixvLGkpO3JldHVybiBhP24uX2hpZ2hsaWdodEZyb21IUmFuZ2UoYSk6KEUuZXZlbnRFbWl0dGVyLmVtaXQoRS5JTlRFUk5BTF9FUlJPUl9FVkVOVCx7dHlwZTpfLkVSUk9SLlJBTkdFX0lOVkFMSUR9KSxudWxsKX0sbi5mcm9tU3RvcmU9ZnVuY3Rpb24oZSx0LHIsbyxpKXt2YXIgYT1uZXcgcy5kZWZhdWx0KGUsdCxyLG8saSk7dHJ5e3JldHVybiBuLl9oaWdobGlnaHRGcm9tSFNvdXJjZShhKSxhfWNhdGNoKGUpe3JldHVybiBFLmV2ZW50RW1pdHRlci5lbWl0KEUuSU5URVJOQUxfRVJST1JfRVZFTlQse3R5cGU6Xy5FUlJPUi5ISUdITElHSFRfU09VUkNFX1JFQ1JFQVRFLGVycm9yOmUsZGV0YWlsOmF9KSxudWxsfX0sbi5fZ2V0SG9va3M9ZnVuY3Rpb24oKXtyZXR1cm57UmVuZGVyOntVVUlEOm5ldyBjLmRlZmF1bHQoXCJSZW5kZXIuVVVJRFwiKSxTZWxlY3RlZE5vZGVzOm5ldyBjLmRlZmF1bHQoXCJSZW5kZXIuU2VsZWN0ZWROb2Rlc1wiKSxXcmFwTm9kZTpuZXcgYy5kZWZhdWx0KFwiUmVuZGVyLldyYXBOb2RlXCIpfSxTZXJpYWxpemU6e1Jlc3RvcmU6bmV3IGMuZGVmYXVsdChcIlNlcmlhbGl6ZS5SZXN0b3JlXCIpLFJlY29yZEluZm86bmV3IGMuZGVmYXVsdChcIlNlcmlhbGl6ZS5SZWNvcmRJbmZvXCIpfSxSZW1vdmU6e1VwZGF0ZU5vZGVzOm5ldyBjLmRlZmF1bHQoXCJSZW1vdmUuVXBkYXRlTm9kZXNcIil9fX0sbi5faGlnaGxpZ2h0RnJvbUhSYW5nZT1mdW5jdGlvbihlKXt2YXIgdD1lLnNlcmlhbGl6ZShuLm9wdGlvbnMuJHJvb3Qsbi5ob29rcyk7cmV0dXJuIDA9PT1uLnBhaW50ZXIuaGlnaGxpZ2h0UmFuZ2UoZSkubGVuZ3RoPyhFLmV2ZW50RW1pdHRlci5lbWl0KEUuSU5URVJOQUxfRVJST1JfRVZFTlQse3R5cGU6Xy5FUlJPUi5ET01fU0VMRUNUSU9OX0VNUFRZfSksbnVsbCk6KG4uY2FjaGUuc2F2ZSh0KSxuLmVtaXQoXy5FdmVudFR5cGUuQ1JFQVRFLHtzb3VyY2VzOlt0XSx0eXBlOl8uQ3JlYXRlRnJvbS5JTlBVVH0sbiksdCl9LG4uX2hhbmRsZVNlbGVjdGlvbj1mdW5jdGlvbigpe3ZhciBlPXUuZGVmYXVsdC5mcm9tU2VsZWN0aW9uKG4uaG9va3MuUmVuZGVyLlVVSUQpO2UmJihuLl9oaWdobGlnaHRGcm9tSFJhbmdlKGUpLHUuZGVmYXVsdC5yZW1vdmVEb21SYW5nZSgpKX0sbi5faGFuZGxlSGlnaGxpZ2h0SG92ZXI9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS50YXJnZXQ7aWYoIXYuaXNIaWdobGlnaHRXcmFwTm9kZSh0KSlyZXR1cm4gbi5faG92ZXJJZCYmbi5lbWl0KF8uRXZlbnRUeXBlLkhPVkVSX09VVCx7aWQ6bi5faG92ZXJJZH0sbixlKSx2b2lkKG4uX2hvdmVySWQ9bnVsbCk7dmFyIHI9di5nZXRIaWdobGlnaHRJZCh0LG4ub3B0aW9ucy4kcm9vdCk7bi5faG92ZXJJZCE9PXImJihuLl9ob3ZlcklkJiZuLmVtaXQoXy5FdmVudFR5cGUuSE9WRVJfT1VULHtpZDpuLl9ob3ZlcklkfSxuLGUpLG4uX2hvdmVySWQ9cixuLmVtaXQoXy5FdmVudFR5cGUuSE9WRVIse2lkOm4uX2hvdmVySWR9LG4sZSkpfSxuLl9oYW5kbGVFcnJvcj1mdW5jdGlvbihlKXtuLm9wdGlvbnMudmVyYm9zZSYmY29uc29sZS53YXJuKGUpfSxuLl9oYW5kbGVIaWdobGlnaHRDbGljaz1mdW5jdGlvbihlKXt2YXIgdD1lLnRhcmdldDtpZih2LmlzSGlnaGxpZ2h0V3JhcE5vZGUodCkpe3ZhciByPXYuZ2V0SGlnaGxpZ2h0SWQodCxuLm9wdGlvbnMuJHJvb3QpO24uZW1pdChfLkV2ZW50VHlwZS5DTElDSyx7aWQ6cn0sbixlKX19LG4ub3B0aW9ucz1FLmdldERlZmF1bHRPcHRpb25zKCksbi5ob29rcz1uLl9nZXRIb29rcygpLG4uc2V0T3B0aW9uKHQpLG4uY2FjaGU9bmV3IGguZGVmYXVsdDt2YXIgcj1uLm9wdGlvbnMuJHJvb3Q7cmV0dXJuIHYuYWRkRXZlbnRMaXN0ZW5lcihyLG4uZXZlbnQuUG9pbnRlck92ZXIsbi5faGFuZGxlSGlnaGxpZ2h0SG92ZXIpLHYuYWRkRXZlbnRMaXN0ZW5lcihyLG4uZXZlbnQuUG9pbnRlclRhcCxuLl9oYW5kbGVIaWdobGlnaHRDbGljayksRS5ldmVudEVtaXR0ZXIub24oRS5JTlRFUk5BTF9FUlJPUl9FVkVOVCxuLl9oYW5kbGVFcnJvciksbn1yZXR1cm4gbyh0LGUpLHQucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihlKXtpZihlKXt2YXIgdD10aGlzLnBhaW50ZXIucmVtb3ZlSGlnaGxpZ2h0KGUpO3RoaXMuY2FjaGUucmVtb3ZlKGUpLHQmJnRoaXMuZW1pdChfLkV2ZW50VHlwZS5SRU1PVkUse2lkczpbZV19LHRoaXMpfX0sdC5wcm90b3R5cGUucmVtb3ZlQWxsPWZ1bmN0aW9uKCl7dGhpcy5wYWludGVyLnJlbW92ZUFsbEhpZ2hsaWdodCgpO3ZhciBlPXRoaXMuY2FjaGUucmVtb3ZlQWxsKCk7dGhpcy5lbWl0KF8uRXZlbnRUeXBlLlJFTU9WRSx7aWRzOmV9LHRoaXMpfSx0LnByb3RvdHlwZS5faGlnaGxpZ2h0RnJvbUhTb3VyY2U9ZnVuY3Rpb24oZSl7dm9pZCAwPT09ZSYmKGU9W10pO3ZhciB0PXRoaXMucGFpbnRlci5oaWdobGlnaHRTb3VyY2UoZSk7dGhpcy5lbWl0KF8uRXZlbnRUeXBlLkNSRUFURSx7c291cmNlczp0LHR5cGU6Xy5DcmVhdGVGcm9tLlNUT1JFfSx0aGlzKSx0aGlzLmNhY2hlLnNhdmUoZSl9LHQuZXZlbnQ9Xy5FdmVudFR5cGUsdC5pc0hpZ2hsaWdodFdyYXBOb2RlPXYuaXNIaWdobGlnaHRXcmFwTm9kZSx0LmlzSGlnaGxpZ2h0U291cmNlPWZ1bmN0aW9uKGUpe3JldHVybiEhZS5fX2lzSGlnaGxpZ2h0U291cmNlfSx0fShsLmRlZmF1bHQpO3QuZGVmYXVsdD1UfSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksdC5xdWVyeUVsZW1lbnROb2RlPXQuZ2V0VGV4dENoaWxkQnlPZmZzZXQ9dm9pZCAwO3ZhciByPW4oMCk7dC5nZXRUZXh0Q2hpbGRCeU9mZnNldD1mdW5jdGlvbihlLHQpe2Zvcih2YXIgbj1bZV0scj1udWxsLG89MCxpPTA7cj1uLnBvcCgpOyl7Zm9yKHZhciBhPXIuY2hpbGROb2RlcyxsPWEubGVuZ3RoLTE7bD49MDtsLS0pbi5wdXNoKGFbbF0pO2lmKDM9PT1yLm5vZGVUeXBlJiYoaT10LW8sKG8rPXIudGV4dENvbnRlbnQubGVuZ3RoKT49dCkpYnJlYWt9cmV0dXJuIHJ8fChyPWUpLHskbm9kZTpyLG9mZnNldDppfX07dC5xdWVyeUVsZW1lbnROb2RlPWZ1bmN0aW9uKGUsdCl7cmV0dXJue3N0YXJ0OmUuc3RhcnRNZXRhLnBhcmVudEluZGV4PT09ci5ST09UX0lEWD90OnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoZS5zdGFydE1ldGEucGFyZW50VGFnTmFtZSlbZS5zdGFydE1ldGEucGFyZW50SW5kZXhdLGVuZDplLmVuZE1ldGEucGFyZW50SW5kZXg9PT1yLlJPT1RfSURYP3Q6dC5nZXRFbGVtZW50c0J5VGFnTmFtZShlLmVuZE1ldGEucGFyZW50VGFnTmFtZSlbZS5lbmRNZXRhLnBhcmVudEluZGV4XX19fSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksdC5kZWZhdWx0PWZ1bmN0aW9uKGUpe3JldHVybiBlLnNwbGl0KFwiLVwiKS5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gZSsoMD09PW4/dDp0WzBdLnRvVXBwZXJDYXNlKCkrdC5zbGljZSgxKSl9KSxcIlwiKX19LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LnJlbW92ZVNlbGVjdGlvbj10LmdldERvbVJhbmdlPXZvaWQgMDt0LmdldERvbVJhbmdlPWZ1bmN0aW9uKCl7dmFyIGU9d2luZG93LmdldFNlbGVjdGlvbigpO3JldHVybiBlLmlzQ29sbGFwc2VkPyhjb25zb2xlLmRlYnVnKFwibm8gdGV4dCBzZWxlY3RlZFwiKSxudWxsKTplLmdldFJhbmdlQXQoMCl9O3QucmVtb3ZlU2VsZWN0aW9uPWZ1bmN0aW9uKCl7d2luZG93LmdldFNlbGVjdGlvbigpLnJlbW92ZUFsbFJhbmdlcygpfX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuZm9ybWF0RG9tTm9kZT10LmdldERvbU1ldGE9dm9pZCAwO3ZhciByPW4oMCk7dC5nZXREb21NZXRhPWZ1bmN0aW9uKGUsdCxuKXt2YXIgbz1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQmJighZS5kYXRhc2V0fHwhZS5kYXRhc2V0W3IuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSXSkpcmV0dXJuIGU7Zm9yKHZhciB0PWUucGFyZW50Tm9kZTtudWxsPT10P3ZvaWQgMDp0LmRhdGFzZXRbci5DQU1FTF9EQVRBU0VUX0lERU5USUZJRVJdOyl0PXQucGFyZW50Tm9kZTtyZXR1cm4gdH0oZSksaT1vPT09bj9yLlJPT1RfSURYOmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPWUudGFnTmFtZSxvPXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUobiksaT0wO2k8by5sZW5ndGg7aSsrKWlmKGU9PT1vW2ldKXJldHVybiBpO3JldHVybiByLlVOS05PV05fSURYfShvLG4pLGE9ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49W2VdLHI9bnVsbCxvPTA7cj1uLnBvcCgpOyl7Zm9yKHZhciBpPXIuY2hpbGROb2RlcyxhPWkubGVuZ3RoLTE7YT49MDthLS0pbi5wdXNoKGlbYV0pO2lmKDM9PT1yLm5vZGVUeXBlJiZyIT09dClvKz1yLnRleHRDb250ZW50Lmxlbmd0aDtlbHNlIGlmKDM9PT1yLm5vZGVUeXBlKWJyZWFrfXJldHVybiBvfShvLGUpO3JldHVybntwYXJlbnRUYWdOYW1lOm8udGFnTmFtZSxwYXJlbnRJbmRleDppLHRleHRPZmZzZXQ6YSt0fX07dC5mb3JtYXREb21Ob2RlPWZ1bmN0aW9uKGUpe3JldHVybiAzPT09ZS4kbm9kZS5ub2RlVHlwZXx8ND09PWUuJG5vZGUubm9kZVR5cGV8fDg9PT1lLiRub2RlLm5vZGVUeXBlP2U6eyRub2RlOmUuJG5vZGUuY2hpbGROb2Rlc1tlLm9mZnNldF0sb2Zmc2V0OjB9fX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO3ZhciByPXRoaXMmJnRoaXMuX19yZWFkfHxmdW5jdGlvbihlLHQpe3ZhciBuPVwiZnVuY3Rpb25cIj09dHlwZW9mIFN5bWJvbCYmZVtTeW1ib2wuaXRlcmF0b3JdO2lmKCFuKXJldHVybiBlO3ZhciByLG8saT1uLmNhbGwoZSksYT1bXTt0cnl7Zm9yKDsodm9pZCAwPT09dHx8dC0tID4wKSYmIShyPWkubmV4dCgpKS5kb25lOylhLnB1c2goci52YWx1ZSl9Y2F0Y2goZSl7bz17ZXJyb3I6ZX19ZmluYWxseXt0cnl7ciYmIXIuZG9uZSYmKG49aS5yZXR1cm4pJiZuLmNhbGwoaSl9ZmluYWxseXtpZihvKXRocm93IG8uZXJyb3J9fXJldHVybiBhfSxvPXRoaXMmJnRoaXMuX19zcHJlYWR8fGZ1bmN0aW9uKCl7Zm9yKHZhciBlPVtdLHQ9MDt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKWU9ZS5jb25jYXQocihhcmd1bWVudHNbdF0pKTtyZXR1cm4gZX07T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe3RoaXMubmFtZT1cIlwiLHRoaXMub3BzPVtdLHRoaXMubmFtZT1lfXJldHVybiBlLnByb3RvdHlwZS50YXA9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztyZXR1cm4tMT09PXRoaXMub3BzLmluZGV4T2YoZSkmJnRoaXMub3BzLnB1c2goZSksZnVuY3Rpb24oKXt0LnJlbW92ZShlKX19LGUucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihlKXt2YXIgdD10aGlzLm9wcy5pbmRleE9mKGUpO3Q8MHx8dGhpcy5vcHMuc3BsaWNlKHQsMSl9LGUucHJvdG90eXBlLmlzRW1wdHk9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMub3BzLmxlbmd0aH0sZS5wcm90b3R5cGUuY2FsbD1mdW5jdGlvbigpe2Zvcih2YXIgZSx0PVtdLG49MDtuPGFyZ3VtZW50cy5sZW5ndGg7bisrKXRbbl09YXJndW1lbnRzW25dO3JldHVybiB0aGlzLm9wcy5mb3JFYWNoKChmdW5jdGlvbihuKXtlPW4uYXBwbHkodm9pZCAwLG8odCkpfSkpLGV9LGV9KCk7dC5kZWZhdWx0PWl9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjt2YXIgcj10aGlzJiZ0aGlzLl9faW1wb3J0RGVmYXVsdHx8ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fTtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgbz1uKDEpLGk9cihuKDE1KSk7dC5kZWZhdWx0PWZ1bmN0aW9uKCl7dmFyIGU9aS5kZWZhdWx0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KTtyZXR1cm57UG9pbnRlckVuZDplP28uVXNlcklucHV0RXZlbnQudG91Y2hlbmQ6by5Vc2VySW5wdXRFdmVudC5tb3VzZXVwLFBvaW50ZXJUYXA6ZT9vLlVzZXJJbnB1dEV2ZW50LnRvdWNoc3RhcnQ6by5Vc2VySW5wdXRFdmVudC5jbGljayxQb2ludGVyT3ZlcjplP28uVXNlcklucHV0RXZlbnQudG91Y2hzdGFydDpvLlVzZXJJbnB1dEV2ZW50Lm1vdXNlb3Zlcn19fSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIHI9L0FuZHJvaWR8aVBob25lfEJsYWNrQmVycnl8QkIxMHxPcGVyYSBNaW5pfFBob25lfE1vYmlsZXxTaWxrfFdpbmRvd3MgUGhvbmV8TW9iaWxlKD86LispRmlyZWZveFxcYi9pO3QuZGVmYXVsdD1mdW5jdGlvbihlKXtyZXR1cm4gci50ZXN0KGUpfX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO3ZhciByLG89dGhpcyYmdGhpcy5fX2V4dGVuZHN8fChyPWZ1bmN0aW9uKGUsdCl7cmV0dXJuKHI9T2JqZWN0LnNldFByb3RvdHlwZU9mfHx7X19wcm90b19fOltdfWluc3RhbmNlb2YgQXJyYXkmJmZ1bmN0aW9uKGUsdCl7ZS5fX3Byb3RvX189dH18fGZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuIGluIHQpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsbikmJihlW25dPXRbbl0pfSkoZSx0KX0sZnVuY3Rpb24oZSx0KXtmdW5jdGlvbiBuKCl7dGhpcy5jb25zdHJ1Y3Rvcj1lfXIoZSx0KSxlLnByb3RvdHlwZT1udWxsPT09dD9PYmplY3QuY3JlYXRlKHQpOihuLnByb3RvdHlwZT10LnByb3RvdHlwZSxuZXcgbil9KSxpPXRoaXMmJnRoaXMuX192YWx1ZXN8fGZ1bmN0aW9uKGUpe3ZhciB0PVwiZnVuY3Rpb25cIj09dHlwZW9mIFN5bWJvbCYmU3ltYm9sLml0ZXJhdG9yLG49dCYmZVt0XSxyPTA7aWYobilyZXR1cm4gbi5jYWxsKGUpO2lmKGUmJlwibnVtYmVyXCI9PXR5cGVvZiBlLmxlbmd0aClyZXR1cm57bmV4dDpmdW5jdGlvbigpe3JldHVybiBlJiZyPj1lLmxlbmd0aCYmKGU9dm9pZCAwKSx7dmFsdWU6ZSYmZVtyKytdLGRvbmU6IWV9fX07dGhyb3cgbmV3IFR5cGVFcnJvcih0P1wiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS5cIjpcIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIil9LGE9dGhpcyYmdGhpcy5fX2ltcG9ydERlZmF1bHR8fGZ1bmN0aW9uKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX07T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIGw9YShuKDIpKSx1PW4oMSkscz1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7dmFyIHQ9bnVsbCE9PWUmJmUuYXBwbHkodGhpcyxhcmd1bWVudHMpfHx0aGlzO3JldHVybiB0Ll9kYXRhPW5ldyBNYXAsdH1yZXR1cm4gbyh0LGUpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImRhdGFcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0QWxsKCl9LHNldDpmdW5jdGlvbihlKXt0aHJvdyB1LkVSUk9SLkNBQ0hFX1NFVF9FUlJPUn0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5zYXZlPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7QXJyYXkuaXNBcnJheShlKT9lLmZvckVhY2goKGZ1bmN0aW9uKGUpe3JldHVybiB0Ll9kYXRhLnNldChlLmlkLGUpfSkpOnRoaXMuX2RhdGEuc2V0KGUuaWQsZSl9LHQucHJvdG90eXBlLmdldD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZGF0YS5nZXQoZSl9LHQucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihlKXt0aGlzLl9kYXRhLmRlbGV0ZShlKX0sdC5wcm90b3R5cGUuZ2V0QWxsPWZ1bmN0aW9uKCl7dmFyIGUsdCxuPVtdO3RyeXtmb3IodmFyIHI9aSh0aGlzLl9kYXRhKSxvPXIubmV4dCgpOyFvLmRvbmU7bz1yLm5leHQoKSl7dmFyIGE9by52YWx1ZTtuLnB1c2goYVsxXSl9fWNhdGNoKHQpe2U9e2Vycm9yOnR9fWZpbmFsbHl7dHJ5e28mJiFvLmRvbmUmJih0PXIucmV0dXJuKSYmdC5jYWxsKHIpfWZpbmFsbHl7aWYoZSl0aHJvdyBlLmVycm9yfX1yZXR1cm4gbn0sdC5wcm90b3R5cGUucmVtb3ZlQWxsPWZ1bmN0aW9uKCl7dmFyIGUsdCxuPVtdO3RyeXtmb3IodmFyIHI9aSh0aGlzLl9kYXRhKSxvPXIubmV4dCgpOyFvLmRvbmU7bz1yLm5leHQoKSl7dmFyIGE9by52YWx1ZTtuLnB1c2goYVswXSl9fWNhdGNoKHQpe2U9e2Vycm9yOnR9fWZpbmFsbHl7dHJ5e28mJiFvLmRvbmUmJih0PXIucmV0dXJuKSYmdC5jYWxsKHIpfWZpbmFsbHl7aWYoZSl0aHJvdyBlLmVycm9yfX1yZXR1cm4gdGhpcy5fZGF0YT1uZXcgTWFwLG59LHR9KGwuZGVmYXVsdCk7dC5kZWZhdWx0PXN9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjt2YXIgcj10aGlzJiZ0aGlzLl9fdmFsdWVzfHxmdW5jdGlvbihlKXt2YXIgdD1cImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJlN5bWJvbC5pdGVyYXRvcixuPXQmJmVbdF0scj0wO2lmKG4pcmV0dXJuIG4uY2FsbChlKTtpZihlJiZcIm51bWJlclwiPT10eXBlb2YgZS5sZW5ndGgpcmV0dXJue25leHQ6ZnVuY3Rpb24oKXtyZXR1cm4gZSYmcj49ZS5sZW5ndGgmJihlPXZvaWQgMCkse3ZhbHVlOmUmJmVbcisrXSxkb25lOiFlfX19O3Rocm93IG5ldyBUeXBlRXJyb3IodD9cIk9iamVjdCBpcyBub3QgaXRlcmFibGUuXCI6XCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpfSxvPXRoaXMmJnRoaXMuX19yZWFkfHxmdW5jdGlvbihlLHQpe3ZhciBuPVwiZnVuY3Rpb25cIj09dHlwZW9mIFN5bWJvbCYmZVtTeW1ib2wuaXRlcmF0b3JdO2lmKCFuKXJldHVybiBlO3ZhciByLG8saT1uLmNhbGwoZSksYT1bXTt0cnl7Zm9yKDsodm9pZCAwPT09dHx8dC0tID4wKSYmIShyPWkubmV4dCgpKS5kb25lOylhLnB1c2goci52YWx1ZSl9Y2F0Y2goZSl7bz17ZXJyb3I6ZX19ZmluYWxseXt0cnl7ciYmIXIuZG9uZSYmKG49aS5yZXR1cm4pJiZuLmNhbGwoaSl9ZmluYWxseXtpZihvKXRocm93IG8uZXJyb3J9fXJldHVybiBhfSxpPXRoaXMmJnRoaXMuX19zcHJlYWR8fGZ1bmN0aW9uKCl7Zm9yKHZhciBlPVtdLHQ9MDt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKWU9ZS5jb25jYXQobyhhcmd1bWVudHNbdF0pKTtyZXR1cm4gZX0sYT10aGlzJiZ0aGlzLl9faW1wb3J0RGVmYXVsdHx8ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fTtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgbD1hKG4oMykpLHU9bigxOCkscz1uKDQpLGQ9bigxKSxjPW4oMjApLGY9bigwKSxoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe3RoaXMub3B0aW9ucz17JHJvb3Q6ZS4kcm9vdCx3cmFwVGFnOmUud3JhcFRhZyxleGNlcHRTZWxlY3RvcnM6ZS5leGNlcHRTZWxlY3RvcnMsY2xhc3NOYW1lOmUuY2xhc3NOYW1lfSx0aGlzLmhvb2tzPXQsYy5pbml0RGVmYXVsdFN0eWxlc2hlZXQoKX1yZXR1cm4gZS5wcm90b3R5cGUuaGlnaGxpZ2h0UmFuZ2U9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztpZighZS5mcm96ZW4pdGhyb3cgZC5FUlJPUi5ISUdITElHSFRfUkFOR0VfRlJPWkVOO3ZhciBuPXRoaXMub3B0aW9ucyxyPW4uJHJvb3Qsbz1uLmNsYXNzTmFtZSxpPW4uZXhjZXB0U2VsZWN0b3JzLGE9dGhpcy5ob29rcyxsPXUuZ2V0U2VsZWN0ZWROb2RlcyhyLGUuc3RhcnQsZS5lbmQsaSk7cmV0dXJuIGEuUmVuZGVyLlNlbGVjdGVkTm9kZXMuaXNFbXB0eSgpfHwobD1hLlJlbmRlci5TZWxlY3RlZE5vZGVzLmNhbGwoZS5pZCxsKXx8W10pLGwubWFwKChmdW5jdGlvbihuKXt2YXIgcj11LndyYXBIaWdobGlnaHQobixlLG8sdC5vcHRpb25zLndyYXBUYWcpO3JldHVybiBhLlJlbmRlci5XcmFwTm9kZS5pc0VtcHR5KCl8fChyPWEuUmVuZGVyLldyYXBOb2RlLmNhbGwoZS5pZCxyKSkscn0pKX0sZS5wcm90b3R5cGUuaGlnaGxpZ2h0U291cmNlPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1BcnJheS5pc0FycmF5KGUpP2U6W2VdLHI9W107cmV0dXJuIG4uZm9yRWFjaCgoZnVuY3Rpb24oZSl7aWYoZSBpbnN0YW5jZW9mIGwuZGVmYXVsdCl7dmFyIG49ZS5kZVNlcmlhbGl6ZSh0Lm9wdGlvbnMuJHJvb3QsdC5ob29rcyk7dC5oaWdobGlnaHRSYW5nZShuKS5sZW5ndGg+MD9yLnB1c2goZSk6Zi5ldmVudEVtaXR0ZXIuZW1pdChmLklOVEVSTkFMX0VSUk9SX0VWRU5ULHt0eXBlOmQuRVJST1IuSElHSExJR0hUX1NPVVJDRV9OT05FX1JFTkRFUixkZXRhaWw6ZX0pfWVsc2UgZi5ldmVudEVtaXR0ZXIuZW1pdChmLklOVEVSTkFMX0VSUk9SX0VWRU5ULHt0eXBlOmQuRVJST1IuU09VUkNFX1RZUEVfRVJST1J9KX0pKSxyfSxlLnByb3RvdHlwZS5yZW1vdmVIaWdobGlnaHQ9ZnVuY3Rpb24oZSl7dmFyIHQsbixvPW5ldyBSZWdFeHAoXCIoXCIrZStcIlxcXFxcIitmLklEX0RJVklTSU9OK1wifFxcXFxcIitmLklEX0RJVklTSU9OK1wiP1wiK2UrXCIkKVwiKSxhPXRoaXMuaG9va3MsbD10aGlzLm9wdGlvbnMud3JhcFRhZyxkPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwobCtcIltkYXRhLVwiK2YuREFUQVNFVF9JREVOVElGSUVSK1wiXVwiKSxjPVtdLGg9W10scD1bXTt0cnl7Zm9yKHZhciBFPXIoZCksXz1FLm5leHQoKTshXy5kb25lO189RS5uZXh0KCkpe3ZhciB2PV8udmFsdWUsVD12LmRhdGFzZXRbZi5DQU1FTF9EQVRBU0VUX0lERU5USUZJRVJdLHk9di5kYXRhc2V0W2YuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSX0VYVFJBXTtUIT09ZXx8eT9UPT09ZT9oLnB1c2godik6VCE9PWUmJm8udGVzdCh5KSYmcC5wdXNoKHYpOmMucHVzaCh2KX19Y2F0Y2goZSl7dD17ZXJyb3I6ZX19ZmluYWxseXt0cnl7XyYmIV8uZG9uZSYmKG49RS5yZXR1cm4pJiZuLmNhbGwoRSl9ZmluYWxseXtpZih0KXRocm93IHQuZXJyb3J9fXJldHVybiBjLmZvckVhY2goKGZ1bmN0aW9uKHQpe3ZhciBuPXQucGFyZW50Tm9kZSxyPWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtzLmZvckVhY2godC5jaGlsZE5vZGVzLChmdW5jdGlvbihlKXtyZXR1cm4gci5hcHBlbmRDaGlsZChlLmNsb25lTm9kZSghMSkpfSkpO3ZhciBvPXQucHJldmlvdXNTaWJsaW5nLGk9dC5uZXh0U2libGluZztuLnJlcGxhY2VDaGlsZChyLHQpLHUubm9ybWFsaXplU2libGluZ1RleHQobywhMCksdS5ub3JtYWxpemVTaWJsaW5nVGV4dChpLCExKSxhLlJlbW92ZS5VcGRhdGVOb2Rlcy5jYWxsKGUsdCxcInJlbW92ZVwiKX0pKSxoLmZvckVhY2goKGZ1bmN0aW9uKHQpe3ZhciBuPXQuZGF0YXNldCxyPW5bZi5DQU1FTF9EQVRBU0VUX0lERU5USUZJRVJfRVhUUkFdLnNwbGl0KGYuSURfRElWSVNJT04pLG89ci5zaGlmdCgpLHU9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihsK1wiW2RhdGEtXCIrZi5EQVRBU0VUX0lERU5USUZJRVIrJz1cIicrbysnXCJdJyk7dSYmKHMucmVtb3ZlQWxsQ2xhc3ModCkscy5hZGRDbGFzcyh0LGkodS5jbGFzc0xpc3QpKSksbltmLkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUl09byxuW2YuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSX0VYVFJBXT1yLmpvaW4oZi5JRF9ESVZJU0lPTiksYS5SZW1vdmUuVXBkYXRlTm9kZXMuY2FsbChlLHQsXCJpZC11cGRhdGVcIil9KSkscC5mb3JFYWNoKChmdW5jdGlvbih0KXt2YXIgbj10LmRhdGFzZXRbZi5DQU1FTF9EQVRBU0VUX0lERU5USUZJRVJfRVhUUkFdO3QuZGF0YXNldFtmLkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUl9FWFRSQV09bi5yZXBsYWNlKG8sXCJcIiksYS5SZW1vdmUuVXBkYXRlTm9kZXMuY2FsbChlLHQsXCJleHRyYS11cGRhdGVcIil9KSksYy5sZW5ndGgraC5sZW5ndGgrcC5sZW5ndGghPT0wfSxlLnByb3RvdHlwZS5yZW1vdmVBbGxIaWdobGlnaHQ9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9wdGlvbnMsdD1lLndyYXBUYWcsbj1lLiRyb290O3MuZ2V0SGlnaGxpZ2h0c0J5Um9vdChuLHQpLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWUucGFyZW50Tm9kZSxuPWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtzLmZvckVhY2goZS5jaGlsZE5vZGVzLChmdW5jdGlvbihlKXtyZXR1cm4gbi5hcHBlbmRDaGlsZChlLmNsb25lTm9kZSghMSkpfSkpLHQucmVwbGFjZUNoaWxkKG4sZSl9KSl9LGV9KCk7dC5kZWZhdWx0PWh9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjt2YXIgcj10aGlzJiZ0aGlzLl9fcmVhZHx8ZnVuY3Rpb24oZSx0KXt2YXIgbj1cImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJmVbU3ltYm9sLml0ZXJhdG9yXTtpZighbilyZXR1cm4gZTt2YXIgcixvLGk9bi5jYWxsKGUpLGE9W107dHJ5e2Zvcig7KHZvaWQgMD09PXR8fHQtLSA+MCkmJiEocj1pLm5leHQoKSkuZG9uZTspYS5wdXNoKHIudmFsdWUpfWNhdGNoKGUpe289e2Vycm9yOmV9fWZpbmFsbHl7dHJ5e3ImJiFyLmRvbmUmJihuPWkucmV0dXJuKSYmbi5jYWxsKGkpfWZpbmFsbHl7aWYobyl0aHJvdyBvLmVycm9yfX1yZXR1cm4gYX0sbz10aGlzJiZ0aGlzLl9fc3ByZWFkfHxmdW5jdGlvbigpe2Zvcih2YXIgZT1bXSx0PTA7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyllPWUuY29uY2F0KHIoYXJndW1lbnRzW3RdKSk7cmV0dXJuIGV9O09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQubm9ybWFsaXplU2libGluZ1RleHQ9dC53cmFwSGlnaGxpZ2h0PXQuZ2V0U2VsZWN0ZWROb2Rlcz12b2lkIDA7dmFyIGk9bigxKSxhPW4oNCksbD1uKDApLHU9bigxOSkscz1mdW5jdGlvbihlLHQpe2lmKCFlKXJldHVybiExO2lmKC9eXFwuLy50ZXN0KHQpKXt2YXIgbj10LnJlcGxhY2UoL15cXC4vLFwiXCIpO3JldHVybiBlJiZhLmhhc0NsYXNzKGUsbil9aWYoL14jLy50ZXN0KHQpKXt2YXIgcj10LnJlcGxhY2UoL14jLyxcIlwiKTtyZXR1cm4gZSYmZS5pZD09PXJ9dmFyIG89dC50b1VwcGVyQ2FzZSgpO3JldHVybiBlJiZlLnRhZ05hbWU9PT1vfTt0LmdldFNlbGVjdGVkTm9kZXM9ZnVuY3Rpb24oZSx0LG4scil7dmFyIG89dC4kbm9kZSxhPW4uJG5vZGUsbD10Lm9mZnNldCx1PW4ub2Zmc2V0O2lmKG89PT1hJiZvIGluc3RhbmNlb2YgVGV4dClyZXR1cm4gZnVuY3Rpb24oZSx0LG4scil7Zm9yKHZhciBvPWUsYT1mdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09cj92b2lkIDA6ci5zb21lKChmdW5jdGlvbih0KXtyZXR1cm4gcyhlLHQpfSkpfTtvOyl7aWYoMT09PW8ubm9kZVR5cGUmJmEobykpcmV0dXJuW107bz1vLnBhcmVudE5vZGV9ZS5zcGxpdFRleHQodCk7dmFyIGw9ZS5uZXh0U2libGluZztyZXR1cm4gbC5zcGxpdFRleHQobi10KSxbeyRub2RlOmwsdHlwZTppLlNlbGVjdGVkTm9kZVR5cGUudGV4dCxzcGxpdFR5cGU6aS5TcGxpdFR5cGUuYm90aH1dfShvLGwsdSxyKTtmb3IodmFyIGQ9W2VdLGM9W10sZj1mdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09cj92b2lkIDA6ci5zb21lKChmdW5jdGlvbih0KXtyZXR1cm4gcyhlLHQpfSkpfSxoPSExLHA9bnVsbDtwPWQucG9wKCk7KWlmKDEhPT1wLm5vZGVUeXBlfHwhZihwKSl7Zm9yKHZhciBFPXAuY2hpbGROb2RlcyxfPUUubGVuZ3RoLTE7Xz49MDtfLS0pZC5wdXNoKEVbX10pO2lmKHA9PT1vKXtpZigzPT09cC5ub2RlVHlwZSl7cC5zcGxpdFRleHQobCk7dmFyIHY9cC5uZXh0U2libGluZztjLnB1c2goeyRub2RlOnYsdHlwZTppLlNlbGVjdGVkTm9kZVR5cGUudGV4dCxzcGxpdFR5cGU6aS5TcGxpdFR5cGUuaGVhZH0pfWg9ITB9ZWxzZXtpZihwPT09YSl7aWYoMz09PXAubm9kZVR5cGUpKHY9cCkuc3BsaXRUZXh0KHUpLGMucHVzaCh7JG5vZGU6dix0eXBlOmkuU2VsZWN0ZWROb2RlVHlwZS50ZXh0LHNwbGl0VHlwZTppLlNwbGl0VHlwZS50YWlsfSk7YnJlYWt9aCYmMz09PXAubm9kZVR5cGUmJmMucHVzaCh7JG5vZGU6cCx0eXBlOmkuU2VsZWN0ZWROb2RlVHlwZS50ZXh0LHNwbGl0VHlwZTppLlNwbGl0VHlwZS5ub25lfSl9fXJldHVybiBjfTt2YXIgZD1mdW5jdGlvbihlLHQpe3ZhciBuPUFycmF5LmlzQXJyYXkodCk/dDpbdF07cmV0dXJuKG49MD09PW4ubGVuZ3RoP1tsLmdldERlZmF1bHRPcHRpb25zKCkuc3R5bGUuY2xhc3NOYW1lXTpuKS5mb3JFYWNoKChmdW5jdGlvbih0KXthLmFkZENsYXNzKGUsdCl9KSksZX0sYz1mdW5jdGlvbihlKXtyZXR1cm4hZXx8IWUudGV4dENvbnRlbnR9O3Qud3JhcEhpZ2hsaWdodD1mdW5jdGlvbihlLHQsbixyKXt2YXIgcz1lLiRub2RlLnBhcmVudE5vZGUsZj1lLiRub2RlLnByZXZpb3VzU2libGluZyxoPWUuJG5vZGUubmV4dFNpYmxpbmc7cmV0dXJuIGEuaXNIaWdobGlnaHRXcmFwTm9kZShzKT8hYS5pc0hpZ2hsaWdodFdyYXBOb2RlKHMpfHxjKGYpJiZjKGgpP2Z1bmN0aW9uKGUsdCxuKXt2YXIgcj1lLiRub2RlLnBhcmVudE5vZGUsbz1yO2EucmVtb3ZlQWxsQ2xhc3MobyksZChvLG4pO3ZhciBpPXIuZGF0YXNldCx1PWlbbC5DQU1FTF9EQVRBU0VUX0lERU5USUZJRVJdO3JldHVybiBpW2wuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSXT10LmlkLGlbbC5DQU1FTF9EQVRBU0VUX0lERU5USUZJRVJfRVhUUkFdPWlbbC5DQU1FTF9EQVRBU0VUX0lERU5USUZJRVJfRVhUUkFdP3UrbC5JRF9ESVZJU0lPTitpW2wuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSX0VYVFJBXTp1LG99KGUsdCxuKTpmdW5jdGlvbihlLHQsbixyKXt2YXIgYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KHIpLHM9ZS4kbm9kZS5wYXJlbnROb2RlLGM9ZS4kbm9kZS5wcmV2aW91c1NpYmxpbmcsZj1lLiRub2RlLm5leHRTaWJsaW5nLGg9ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLHA9cy5kYXRhc2V0W2wuQ0FNRUxfREFUQVNFVF9JREVOVElGSUVSXSxFPXMuZGF0YXNldFtsLkNBTUVMX0RBVEFTRVRfSURFTlRJRklFUl9FWFRSQV0sXz1FP3ArbC5JRF9ESVZJU0lPTitFOnA7YS5zZXRBdHRyaWJ1dGUoXCJkYXRhLVwiK2wuREFUQVNFVF9JREVOVElGSUVSLHQuaWQpLGEuc2V0QXR0cmlidXRlKFwiZGF0YS1cIitsLkRBVEFTRVRfSURFTlRJRklFUl9FWFRSQSxfKSxhLmFwcGVuZENoaWxkKGUuJG5vZGUuY2xvbmVOb2RlKCExKSk7dmFyIHYsVD0hMSx5PSExO2MmJigoZz1zLmNsb25lTm9kZSghMSkpLnRleHRDb250ZW50PWMudGV4dENvbnRlbnQsaC5hcHBlbmRDaGlsZChnKSxUPSEwKTt2YXIgZyxJPVtdOyhBcnJheS5pc0FycmF5KG4pP0kucHVzaC5hcHBseShJLG8obikpOkkucHVzaChuKSxkKGEsdS51bmlxdWUoSSkpLGguYXBwZW5kQ2hpbGQoYSksZikmJigoZz1zLmNsb25lTm9kZSghMSkpLnRleHRDb250ZW50PWYudGV4dENvbnRlbnQsaC5hcHBlbmRDaGlsZChnKSx5PSEwKTtyZXR1cm4gdj1UJiZ5P2kuU3BsaXRUeXBlLmJvdGg6VD9pLlNwbGl0VHlwZS5oZWFkOnk/aS5TcGxpdFR5cGUudGFpbDppLlNwbGl0VHlwZS5ub25lLGEuc2V0QXR0cmlidXRlKFwiZGF0YS1cIitsLkRBVEFTRVRfU1BMSVRfVFlQRSx2KSxzLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKGgscyksYX0oZSx0LG4scik6ZnVuY3Rpb24oZSx0LG4scil7dmFyIG89ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChyKTtyZXR1cm4gZChvLG4pLG8uYXBwZW5kQ2hpbGQoZS4kbm9kZS5jbG9uZU5vZGUoITEpKSxlLiRub2RlLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKG8sZS4kbm9kZSksby5zZXRBdHRyaWJ1dGUoXCJkYXRhLVwiK2wuREFUQVNFVF9JREVOVElGSUVSLHQuaWQpLG8uc2V0QXR0cmlidXRlKFwiZGF0YS1cIitsLkRBVEFTRVRfU1BMSVRfVFlQRSxlLnNwbGl0VHlwZSksby5zZXRBdHRyaWJ1dGUoXCJkYXRhLVwiK2wuREFUQVNFVF9JREVOVElGSUVSX0VYVFJBLFwiXCIpLG99KGUsdCxuLHIpfTt0Lm5vcm1hbGl6ZVNpYmxpbmdUZXh0PWZ1bmN0aW9uKGUsdCl7aWYodm9pZCAwPT09dCYmKHQ9ITApLGUmJjM9PT1lLm5vZGVUeXBlKXt2YXIgbj10P2UubmV4dFNpYmxpbmc6ZS5wcmV2aW91c1NpYmxpbmc7aWYoMz09PW4ubm9kZVR5cGUpe3ZhciByPW4ubm9kZVZhbHVlO2Uubm9kZVZhbHVlPXQ/ZS5ub2RlVmFsdWUrcjpyK2Uubm9kZVZhbHVlLG4ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChuKX19fX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO3ZhciByPXRoaXMmJnRoaXMuX192YWx1ZXN8fGZ1bmN0aW9uKGUpe3ZhciB0PVwiZnVuY3Rpb25cIj09dHlwZW9mIFN5bWJvbCYmU3ltYm9sLml0ZXJhdG9yLG49dCYmZVt0XSxyPTA7aWYobilyZXR1cm4gbi5jYWxsKGUpO2lmKGUmJlwibnVtYmVyXCI9PXR5cGVvZiBlLmxlbmd0aClyZXR1cm57bmV4dDpmdW5jdGlvbigpe3JldHVybiBlJiZyPj1lLmxlbmd0aCYmKGU9dm9pZCAwKSx7dmFsdWU6ZSYmZVtyKytdLGRvbmU6IWV9fX07dGhyb3cgbmV3IFR5cGVFcnJvcih0P1wiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS5cIjpcIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIil9O09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQudW5pcXVlPXZvaWQgMDt0LnVuaXF1ZT1mdW5jdGlvbihlKXt2YXIgdCxuLG89W107dHJ5e2Zvcih2YXIgaT1yKGUpLGE9aS5uZXh0KCk7IWEuZG9uZTthPWkubmV4dCgpKXt2YXIgbD1hLnZhbHVlOy0xPT09by5pbmRleE9mKGwpJiZvLnB1c2gobCl9fWNhdGNoKGUpe3Q9e2Vycm9yOmV9fWZpbmFsbHl7dHJ5e2EmJiFhLmRvbmUmJihuPWkucmV0dXJuKSYmbi5jYWxsKGkpfWZpbmFsbHl7aWYodCl0aHJvdyB0LmVycm9yfX1yZXR1cm4gb319LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LmluaXREZWZhdWx0U3R5bGVzaGVldD12b2lkIDA7dmFyIHI9bigwKTt0LmluaXREZWZhdWx0U3R5bGVzaGVldD1mdW5jdGlvbigpe3ZhciBlPXIuU1RZTEVTSEVFVF9JRCx0PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGUpO2lmKCF0KXt2YXIgbj1kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShyLmdldFN0eWxlc2hlZXQoKSk7KHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpKS5pZD1lLHQuYXBwZW5kQ2hpbGQobiksZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZCh0KX1yZXR1cm4gdH19XSkuZGVmYXVsdH0pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXdlYi1oaWdobGlnaHRlci5taW4uanMubWFwIl19
